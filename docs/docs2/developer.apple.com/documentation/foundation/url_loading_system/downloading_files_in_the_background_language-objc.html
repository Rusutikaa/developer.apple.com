<!DOCTYPE html><html lang="en" data-reactroot=""><head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8"><title>Downloading Files in the Background | Apple Developer Documentation</title><!-- link href="https://www.apple.com/wss/fonts?families=SF+Pro,v1|SF+Mono,v1|SF+Pro+Icons,v1" media="all" rel="stylesheet" type="text/css"/ --><meta content="width=device-width, initial-scale=1 viewport-fit=cover" name="viewport"/><meta data-pid="492525"/><link href="../../../documentation/assets/application-e5bb1544.css" media="all" rel="stylesheet" type="text/css"/><noscript><link href="../../../documentation/assets/nojs-c6be9131.css" media="all" rel="stylesheet" type="text/css"/></noscript><link rel="mask-icon" href="../../../documentation/assets/apple-logo.svg" color="#000"/><link rel="shortcut icon" href="../../../documentation/assets/favicon.ico"/><script src="../../../documentation/assets/shared-b7676010.js"></script></head><body><div id="app"><div><a href="#main" id="skip-localnav" class="showonfocus hidden">Skip Navigation</a><aside id="ac-gn-segmentbar" class="ac-gn-segmentbar" lang="en-US" dir="ltr"></aside><input type="checkbox" id="ac-gn-menustate" class="ac-gn-menustate"/><nav id="ac-globalnav" class="no-js" role="navigation" aria-label="Global" data-hires="false" data-analytics-region="global nav" lang="en-US" dir="ltr" data-store-locale="us" data-store-api="/[storefront]/shop/bag/status" data-search-locale="en_US" data-search-api="/search-services/suggestions/">
      <div class="ac-gn-content">
        <ul class="ac-gn-header">
          <li class="ac-gn-item ac-gn-menuicon">
            <label class="ac-gn-menuicon-label" for="ac-gn-menustate" aria-hidden="true">
              <span class="ac-gn-menuicon-bread ac-gn-menuicon-bread-top">
                <span class="ac-gn-menuicon-bread-crust ac-gn-menuicon-bread-crust-top"></span>
              </span>
              <span class="ac-gn-menuicon-bread ac-gn-menuicon-bread-bottom">
                <span class="ac-gn-menuicon-bread-crust ac-gn-menuicon-bread-crust-bottom"></span>
              </span>
            </label>
            <a href="#ac-gn-menustate" role="button" class="ac-gn-menuanchor ac-gn-menuanchor-open" id="ac-gn-menuanchor-open">
              <span class="ac-gn-menuanchor-label">Global Nav Open Menu</span>
            </a>
            <a href="#" role="button" class="ac-gn-menuanchor ac-gn-menuanchor-close" id="ac-gn-menuanchor-close">
              <span class="ac-gn-menuanchor-label">Global Nav Close Menu</span>
            </a>
          </li>
          <li class="ac-gn-item ac-gn-apple">
            <a class="ac-gn-link ac-gn-link-apple-developer" href="/" data-analytics-title="appledeveloper home" id="ac-gn-firstfocus-small">
              <span class="ac-gn-link-text">Apple Developer</span>
            </a>
          </li>
        </ul>
        <div class="ac-gn-search-placeholder-container" role="search">
          <div class="ac-gn-search ac-gn-search-small">
            <a id="ac-gn-link-search-small" class="ac-gn-link" href="/search/" data-analytics-title="search" data-analytics-click="search" data-analytics-intrapage-link aria-label="Search Developer">
              </a><div class="ac-gn-search-placeholder-bar">
                <div class="ac-gn-search-placeholder-input">
                  <div class="ac-gn-search-placeholder-input-text" aria-hidden="true">
                    <div class="ac-gn-link-search ac-gn-search-placeholder-input-icon"></div>
                    <span class="ac-gn-search-placeholder">Search Developer</span>
                  </div>
                </div>
                <div class="ac-gn-searchview-close ac-gn-searchview-close-small ac-gn-search-placeholder-searchview-close">
                  <span class="ac-gn-searchview-close-cancel" aria-hidden="true">Cancel</span>
                </div>
              </div>
            </a>
          </div>
        </div>
        <ul class="ac-gn-list">
          <li class="ac-gn-item ac-gn-apple">
            <a class="ac-gn-link ac-gn-link-apple-developer" href="/" data-analytics-title="appledeveloper home" id="ac-gn-firstfocus">
              <span class="ac-gn-link-text">Apple Developer</span>
              </a>
          </li>
          <li class="ac-gn-item ac-gn-item-menu ac-gn-discover">
            <a class="ac-gn-link ac-gn-link-discover" href="/discover/" data-analytics-title="discover">
              <span class="ac-gn-link-text">Discover</span>
              </a>
          </li>
          <li class="ac-gn-item ac-gn-item-menu ac-gn-design">
            <a class="ac-gn-link ac-gn-link-design" href="/design/" data-analytics-title="design">
              <span class="ac-gn-link-text">Design</span>
              </a>
          </li>
          <li class="ac-gn-item ac-gn-item-menu ac-gn-develop">
            <a class="ac-gn-link ac-gn-link-develop" href="/develop/" data-analytics-title="develop">
              <span class="ac-gn-link-text">Develop</span>
              </a>
          </li>
          <li class="ac-gn-item ac-gn-item-menu ac-gn-distribute">
            <a class="ac-gn-link ac-gn-link-distribute" href="/distribute/" data-analytics-title="distribute">
              <span class="ac-gn-link-text">Distribute</span>
              </a>
          </li>
          <li class="ac-gn-item ac-gn-item-menu ac-gn-dsupport">
            <a class="ac-gn-link ac-gn-link-dsupport" href="/support/" data-analytics-title="dsupport">
              <span class="ac-gn-link-text">Support</span>
              </a>
          </li>
          <li class="ac-gn-item ac-gn-item-menu ac-gn-account">
            <a class="ac-gn-link ac-gn-link-account" href="/account/" data-analytics-title="account">
              <span class="ac-gn-link-text">Account</span>
              </a>
          </li>
          <li class="ac-gn-item ac-gn-item-menu ac-gn-search" role="search">
            <a id="ac-gn-link-search" class="ac-gn-link ac-gn-link-search" href="/search/" data-analytics-title="search" data-analytics-click="search" data-analytics-intrapage-link aria-label="Search Developer"></a>
          </li>
        </ul>
        <aside id="ac-gn-searchview" class="ac-gn-searchview" role="search" data-analytics-region="search">
          <div class="ac-gn-searchview-content">
            <div class="ac-gn-searchview-bar">
              <div class="ac-gn-searchview-bar-wrapper">
                <form id="ac-gn-searchform" class="ac-gn-searchform" action="/search/" method="get">
                  <div class="ac-gn-searchform-wrapper">
                    <input id="ac-gn-searchform-input" class="ac-gn-searchform-input" type="text" name="q" aria-label="Search Developer" placeholder="Search Developer" autocorrect="off" autocapitalize="off" autocomplete="off" spellcheck="false" role="combobox" aria-autocomplete="list" aria-expanded="true" aria-owns="quicklinks suggestions" />
                    <button id="ac-gn-searchform-submit" class="ac-gn-searchform-submit" type="submit" disabled aria-label="Submit Search"></button>
                    <button id="ac-gn-searchform-reset" class="ac-gn-searchform-reset" type="reset" disabled aria-label="Clear Search">
                        <span class="ac-gn-searchform-reset-background"></span>
                      </button>
                  </div>
                </form>
                <button id="ac-gn-searchview-close-small" class="ac-gn-searchview-close ac-gn-searchview-close-small" aria-label="Cancel Search">
                    <span class="ac-gn-searchview-close-cancel" aria-hidden="true">
                      Cancel
                    </span>
                  </button>
              </div>
            </div>
            <aside id="ac-gn-searchresults" class="ac-gn-searchresults" data-string-quicklinks="Quick Links" data-string-suggestions="Suggested Searches" data-string-noresults=""></aside>
          </div>
          <button id="ac-gn-searchview-close" class="ac-gn-searchview-close" aria-label="Cancel Search">
              <span class="ac-gn-searchview-close-wrapper">
                <span class="ac-gn-searchview-close-left"></span>
                <span class="ac-gn-searchview-close-right"></span>
              </span>
            </button>
        </aside>
          </div>
    </nav><div class="ac-gn-blur"></div><div id="ac-gn-curtain" class="ac-gn-curtain"></div><div id="ac-gn-placeholder" class="ac-nav-placeholder"></div><input type="checkbox" id="localnav-menustate" class="localnav-menustate" aria-hidden="true"/><nav id="localnav" class="localnav localnav-dark theme-dark localnav-scrim localnav-noborder" role="navigation" aria-label="API Reference" data-sticky="true"><div class="localnav-wrapper"><div class="referencenav"><div class="localnav-background"></div><div class="localnav-content"><a href="../../../index.html" class="localnav-title">Documentation</a><div class="localnav-menu"><a href="#localnav-menustate" id="localnav-menustate-open" class="localnav-menucta-anchor localnav-menucta-anchor-open"><span class="localnav-menucta-anchor-label" aria-hidden="true">Open Menu</span></a><a href="#" id="localnav-menustate-close" class="localnav-menucta-anchor localnav-menucta-anchor-close"><span class="localnav-menucta-anchor-label" aria-hidden="true">Close Menu</span></a><div class="localnav-menu-tray"><ul aria-label="Breadcrumbs" class="localnav-menu-items localnav-menu-breadcrumbs"><li class="localnav-menu-item localnav-menu-breadcrumb-item"><a class="localnav-menu-link" href="../../../documentation/foundation_language-objc.html"><span class="enstr">Foundation</span><!--end_enstr-->
<span class="jpstr">
ファウンデーション
</span><!--end_jpstr-->
</a></li><li class="localnav-menu-item localnav-menu-breadcrumb-item"><a class="localnav-menu-link" href="../../../documentation/foundation/url_loading_system_language-objc.html"><span class="enstr">URL Loading System</span><!--end_enstr-->
<span class="jpstr">
URLローディングシステム
</span><!--end_jpstr-->
</a></li><li class="localnav-menu-item localnav-menu-breadcrumb-item"><div class="localnav-menu-breadcrumb-current-container localnav-menu-link current"><span aria-current="page" class="localnav-menu-breadcrumb-current"><span class="enstr">Downloading Files in the Background</span><!--end_enstr-->
<span class="jpstr">
ファイルをバックグラウンドでダウンロードする
</span><!--end_jpstr-->
</span></div></li></ul><ul class="localnav-menu-items localnav-menu-settings" data-breadcrumbs-count="3"><li class="localnav-menu-setting language-container"><div class="language-toggle-container"><label for="language-toggle" class="language-toggle-label">Language:</label><select id="language-toggle" class="language-dropdown localnav-menu-link" style="width:auto"><option value="swift">Swift</option><option selected="" value="occ">Objective-C</option></select></div><div class="language-list-container"><span class="localnav-menu-setting-label">Language:</span><ul class="language-list"><li class="language-list-item"><a href="../../../documentation/foundation/url_loading_system/downloading_files_in_the_background.html" class="localnav-menu-setting-link">Swift</a></li><li class="language-list-item"><span data-language="objc" aria-current="page" class="current-language">Objective-C</span></li></ul></div></li><li class="localnav-menu-setting"><span class="localnav-menu-setting-label">API Changes:</span><span class="changes-toggle">None</span></li></ul></div><div class="localnav-actions"><div class="localnav-action localnav-action-menucta" aria-hidden="true"><label for="localnav-menustate" class="localnav-menucta"><span class="localnav-menucta-chevron"></span></label></div></div></div></div></div></div></nav><label for="localnav-menustate" id="localnav-curtain" aria-hidden="true"></label><main role="main" id="main" class="main" tabindex="0"><div class="topic-title"><span class="eyebrow">Article</span><h1 class="topic-heading"><span><span class="enstr">Downloading Files in the Background</span><!--end_enstr-->
<span class="jpstr">
ファイルをバックグラウンドでダウンロードする
</span><!--end_jpstr-->
</span></h1></div><div class="topic-container section-content row"><div class="topic-description column large-9 medium-9 small-12"><div class="topic-abstract abstract formatted-content"><div><p><span class="enstr">Create tasks that download files while your app is inactive.</span><!--end_enstr-->
<span class="jpstr">
あなたのアプリが活動していない間にファイルをダウンロードする、そういうタスクを作成します。
</span><!--end_jpstr-->
</p></div></div></div><div class="topic-summary column large-3 medium-3 small-12"><div class="topic-summary-section frameworks" role="complementary" aria-label="Framework"><p class="topic-summary-section-label subsection-label"><span class="enstr">Framework</span><!--end_enstr-->
<span class="jpstr">
フレームワーク
</span><!--end_jpstr-->
</p><ul class="topic-summary-section-list"><li class="topic-summary-section-item"><span><span class="enstr">Foundation</span><!--end_enstr-->
<span class="jpstr">
ファウンデーション
</span><!--end_jpstr-->
</span></li></ul></div><div class="topic-summary-section onthispage"><nav class="onthispage-nav" aria-labelledby="onthispage-title"><p id="onthispage-title" class="topic-summary-section-label subsection-label"><span class="enstr">On This Page</span><!--end_enstr-->
<span class="jpstr">
この項には
</span><!--end_jpstr-->
</p><ul class="topic-summary-section-list"><li class="topic-summary-section-item"><a href="#overview" class="icon icon-after icon-chevrondowncircle"><span class="enstr">Overview</span><!--end_enstr-->
<span class="jpstr">
概要
</span><!--end_jpstr-->
</a></li><li class="topic-summary-section-item"><a href="#see-also" class="icon icon-after icon-chevrondowncircle"><span class="enstr">See Also</span><!--end_enstr-->
<span class="jpstr">
参照
</span><!--end_jpstr-->
</a></li></ul></nav></div></div><div class="topic-content column large-9 medium-9 small-12" id="topic-content"><section id="overview" class="section"><h2><span class="enstr">Overview</span><!--end_enstr-->
<span class="jpstr">
概要
</span><!--end_jpstr-->
</h2><div class="formatted-content"><div><p><span class="enstr">For long-running and nonurgent transfers, you can create tasks that run in the background. These tasks continue to run even when your app is suspended, allowing your app to access the downloaded file when the app is resumed.</span><!--end_enstr-->
<span class="jpstr">
長く動作するそして急を要しない転送のために、あなたはバックグラウンドで動作するタスクを作成できます。これらのタスクは、あなたのアプリが一時停止される時でさえ実行を継続して、アプリが再開される時に、あなたのアプリがそのダウンロードされるファイルにアクセスできるようにします。
</span><!--end_jpstr-->
 </p><aside class="aside aside-note" role="note"><p class="aside-name"><span class="enstr">Note</span><!--end_enstr-->
<span class="jpstr">
注意
</span><!--end_jpstr-->
</p><p><span class="enstr">You don’t have to do all background network activity with background sessions as described in this article. Apps that declare appropriate background modes can use default URL sessions and data tasks, just as if they were in the foreground.</span><!--end_enstr-->
<span class="jpstr">
あなたは、全てのバックグラウンドネットワーク活動をバックグラウンドセッションで、この記事で記述されるように行う必要はありません。適切なバックグラウンドモードを宣言するアプリは、省略時のURLセッションとデータタスクを、あたかもそれらが前面であったかのように使用できます。
</span><!--end_jpstr-->
</p></aside></div><h3 id="2920773"><span class="enstr">Configure the Background Session</span><!--end_enstr-->
<span class="jpstr">
バックグラウンドセッションを構成設定する
</span><!--end_jpstr-->
</h3><div><p><span class="enstr">To perform a background download, configure a <a class="symbol-name" href="../../../documentation/foundation/nsurlsession_language-objc.html"><code><span>NSURLSession</span></code></a> for background operation. <a href="../../../documentation/foundation/url_loading_system/downloading_files_in_the_background_language-objc.html#2920777">Listing 1</a> demonstrates this process.</span><!--end_enstr-->
<span class="jpstr">
バックグラウンドダウンロードを実行するには、<a class="symbol-name" href="../../../documentation/foundation/nsurlsession_language-objc.html"><code><span>NSURLSession</span></code></a>をバックグラウンド操作に対して構成設定してください。<a href="../../../documentation/foundation/url_loading_system/downloading_files_in_the_background_language-objc.html#2920777">コード出力 1</a> は、この過程を実演します。
</span><!--end_jpstr-->
 </p><ol><li><p><span class="enstr">Create a background <a class="symbol-name" href="../../../documentation/foundation/nsurlsessionconfiguration_language-objc.html"><code><span>NSURLSession<wbr/>Configuration</span></code></a> object with the class method <a class="symbol-name" href="../../../documentation/foundation/nsurlsessionconfiguration/1407496-backgroundsessionconfigurationwi_language-objc.html"><code><span>background<wbr/>Session<wbr/>Configuration<wbr/>With<wbr/>Identifier:</span></code></a> of <code class="code-voice"><span>NSURLSession</span></code>, providing a session identifier that is unique within your app. Because most apps need only a few background sessions (usually one), you can use a fixed string for the identifier, rather than a dynamically generated identifier. The identifier doesn’t need to be unique globally.</span><!--end_enstr-->
<span class="jpstr">
バックグラウンド<a class="symbol-name" href="../../../documentation/foundation/nsurlsessionconfiguration_language-objc.html"><code><span>NSURLSession<wbr/>Configuration</span></code></a>オブジェクトを<code class="code-voice"><span>NSURLSession</span></code>のクラスメソッド<a class="symbol-name" href="../../../documentation/foundation/nsurlsessionconfiguration/1407496-backgroundsessionconfigurationwi_language-objc.html"><code><span>background<wbr/>Session<wbr/>Configuration<wbr/>With<wbr/>Identifier:</span></code></a>で作成してください、あなたのアプリ内で特有であるセッション識別子を提供してください。ほとんどのアプリがほんの少しのバックグラウンドセッション（通常は１つ）を必要とすることから、あなたはその識別子に対して固定された文字列を使うことができます、動的に生成される識別子ではなく。識別子は、グローバルに特有である必要はありません。
</span><!--end_jpstr-->
 </p></li><li><p><span class="enstr">To have the system to wake up your app when a task completes and the app is in the background, make sure the <a class="symbol-name" href="../../../documentation/foundation/nsurlsessionconfiguration/1617174-sessionsendslaunchevents_language-objc.html"><code><span>session<wbr/>Sends<wbr/>Launch<wbr/>Events</span></code></a> property is set to <code class="code-voice"><span>true</span></code> (the default).</span><!--end_enstr-->
<span class="jpstr">
システムにあなたのアプリを目覚めさせるには、あるタスクが完了するそしてそのアプリがバックグラウンドである時は、<a class="symbol-name" href="../../../documentation/foundation/nsurlsessionconfiguration/1617174-sessionsendslaunchevents_language-objc.html"><code><span>session<wbr/>Sends<wbr/>Launch<wbr/>Events</span></code></a>プロパティが<code class="code-voice"><span>true</span></code>に設定される（初期状態）ことを確実にしてください。
</span><!--end_jpstr-->
</p></li><li><p><span class="enstr">For time-insensitive tasks, enable the <a class="symbol-name" href="../../../documentation/foundation/nsurlsessionconfiguration/1411552-discretionary_language-objc.html"><code><span>discretionary</span></code></a> property, so the system can wait for optimal conditions to perform the transfer, such as when the device is plugged in or connected to Wi-Fi.</span><!--end_enstr-->
<span class="jpstr">
時間に無頓着なタスクに対して、<a class="symbol-name" href="../../../documentation/foundation/nsurlsessionconfiguration/1411552-discretionary_language-objc.html"><code><span>discretionary</span></code></a>プロパティを可能にしてください、それでシステムは転送を実行するのに最適な条件を待つことができます、たとえばデバイスがネット接続されるかまたはWi-Fiに接続される時に。
</span><!--end_jpstr-->
</p></li><li><p><span class="enstr">Use the <code class="code-voice"><span>NSURLSession<wbr/>Configuration</span></code> instance to create a <code class="code-voice"><span>NSURLSession</span></code> instance. Provide a delegate, to receive events from the background transfer.</span><!--end_enstr-->
<span class="jpstr">
<code class="code-voice"><span>NSURLSession<wbr/>Configuration</span></code>インスタンスを使って<code class="code-voice"><span>NSURLSession</span></code>インスタンスを作成してください。ある委任先を提供してください、バックグラウンド転送からのイベントを受け取るために。
</span><!--end_jpstr-->
 </p></li></ol><p></p><figure id="2920777"><figcaption><strong class="caption-title"><span class="enstr">Listing 1</span><!--end_enstr-->
<span class="jpstr">
コード出力 1
</span><!--end_jpstr-->
</strong> <div class="caption-content formatted-content"><div><p><span class="enstr">Creating a background URL session</span><!--end_enstr-->
<span class="jpstr">
バックグラウンドURLセッションを作成する
</span><!--end_jpstr-->
</p></div></div></figcaption><div class="formatted-content"><div class="code-listing"><pre class="code-source" data-language="swift"><code>private lazy var urlSession: URLSession = {
    let config = URLSessionConfiguration.background(withIdentifier: "MySession")
    config.isDiscretionary = true
    config.sessionSendsLaunchEvents = true
    return URLSession(configuration: config, delegate: self, delegateQueue: nil)
}()
</code></pre></div></div></figure><p></p><aside class="aside aside-note" role="note"><p class="aside-name"><span class="enstr">Note</span><!--end_enstr-->
<span class="jpstr">
注意
</span><!--end_jpstr-->
</p><p><span class="enstr">For more visibility into how the system is scheduling and performing your background tasks, download and install the Background Networking Profile onto your iOS device from the Bug Reporting <a href="https://developer.apple.com/bug-reporting/profiles-and-logs/">Profiles and Logs</a> page.</span><!--end_enstr-->
<span class="jpstr">
どのようにシステムがあなたのバックグラウンドタスクを予定してそして実行しているかのさらなる可視性のために、Background Networking ProfileをあなたのiOSデバイスへとBug Reportingの<a href="https://developer.apple.com/bug-reporting/profiles-and-logs/">Profiles and Logs</a>ページからダウンロードおよびインストールしてください。
</span><!--end_jpstr-->
</p></aside><p></p></div><h3 id="2920774"><span class="enstr">Create and Schedule the Download Task</span><!--end_enstr-->
<span class="jpstr">
ダウンロードタスクを作成および予定する
</span><!--end_jpstr-->
</h3><div><p><span class="enstr">You create download tasks from the session with either the <a class="symbol-name" href="../../../documentation/foundation/nsurlsession/1411482-downloadtaskwithurl_language-objc.html"><code><span>download<wbr/>Task<wbr/>With<wbr/>URL:</span></code></a> method that takes a URL, or the <a class="symbol-name" href="../../../documentation/foundation/nsurlsession/1411481-downloadtaskwithrequest_language-objc.html"><code><span>download<wbr/>Task<wbr/>With<wbr/>Request:</span></code></a> method that takes a <a class="symbol-name" href="../../../documentation/foundation/urlrequest_language-objc.html"><code><span>URLRequest</span></code></a> instance. You set properties on this method to help the system optimize its behavior.</span><!--end_enstr-->
<span class="jpstr">
あなたはダウンロードタスクをセッションから、あるURLをとる<a class="symbol-name" href="../../../documentation/foundation/nsurlsession/1411482-downloadtaskwithurl_language-objc.html"><code><span>download<wbr/>Task<wbr/>With<wbr/>URL:</span></code></a>メソッド、またはある<a class="symbol-name" href="../../../documentation/foundation/urlrequest_language-objc.html"><code><span>URLRequest</span></code></a>インスタンスをとる<a class="symbol-name" href="../../../documentation/foundation/nsurlsession/1411481-downloadtaskwithrequest_language-objc.html"><code><span>download<wbr/>Task<wbr/>With<wbr/>Request:</span></code></a>メソッドのどちらかで、作成します。あなたは、このメソッド上でプロパティいくつかを設定して、システムがそれの挙動を最適化する助けとします。
</span><!--end_jpstr-->
 </p><ol><li><p><span class="enstr">As shown in <a href="../../../documentation/foundation/url_loading_system/downloading_files_in_the_background_language-objc.html#2920776">Listing 2</a>, create a download task with <code class="code-voice"><span>download<wbr/>Task<wbr/>With<wbr/>URL:</span></code>.</span><!--end_enstr-->
<span class="jpstr">
<a href="../../../documentation/foundation/url_loading_system/downloading_files_in_the_background_language-objc.html#2920776">コード出力 2</a>で示されるように、ダウンロードタスクを<code class="code-voice"><span>download<wbr/>Task<wbr/>With<wbr/>URL:</span></code>で作成してください。
</span><!--end_jpstr-->
</p></li><li><p><span class="enstr">Optionally, set the <a class="symbol-name" href="../../../documentation/foundation/nsurlsessiontask/2873413-earliestbegindate_language-objc.html"><code><span>earliest<wbr/>Begin<wbr/>Date</span></code></a> property to schedule the download to begin at a particular point in the future. The download isn’t guaranteed to begin at precisely this time, but it won’t start sooner.</span><!--end_enstr-->
<span class="jpstr">
随意に、<a class="symbol-name" href="../../../documentation/foundation/nsurlsessiontask/2873413-earliestbegindate_language-objc.html"><code><span>earliest<wbr/>Begin<wbr/>Date</span></code></a>プロパティを設定して、そのダウンロードを未来の特定の時点で始めるように予定してください。ダウンロードは、正確にこの時間で開始すると保証されません、しかしそれは予定より早く始まりません。
</span><!--end_jpstr-->
 </p></li><li><p><span class="enstr">To help the system schedule network activity efficiently, set the properties <a class="symbol-name" href="../../../documentation/foundation/nsurlsessiontask/2873401-countofbytesclientexpectstosend_language-objc.html"><code><span>count<wbr/>Of<wbr/>Bytes<wbr/>Client<wbr/>Expects<wbr/>To<wbr/>Send</span></code></a> and <a class="symbol-name" href="../../../documentation/foundation/nsurlsessiontask/2873414-countofbytesclientexpectstorecei_language-objc.html"><code><span>count<wbr/>Of<wbr/>Bytes<wbr/>Client<wbr/>Expects<wbr/>To<wbr/>Receive</span></code></a>. These values are best-guess upper bounds on the expected byte count, and should account for headers as well as body data.</span><!--end_enstr-->
<span class="jpstr">
システムがネットワーク活動を効率的に予定するのを助けるために、プロパティ<a class="symbol-name" href="../../../documentation/foundation/nsurlsessiontask/2873401-countofbytesclientexpectstosend_language-objc.html"><code><span>count<wbr/>Of<wbr/>Bytes<wbr/>Client<wbr/>Expects<wbr/>To<wbr/>Send</span></code></a>と<a class="symbol-name" href="../../../documentation/foundation/nsurlsessiontask/2873414-countofbytesclientexpectstorecei_language-objc.html"><code><span>count<wbr/>Of<wbr/>Bytes<wbr/>Client<wbr/>Expects<wbr/>To<wbr/>Receive</span></code></a>を設定してください。これらの値は、予想バイト総数の最も有力な上限です、そしてヘッダだけでなくボディのデータも勘定に入れるべきです。
</span><!--end_jpstr-->
</p></li><li><p><span class="enstr">To start the task, call <a class="symbol-name" href="../../../documentation/foundation/nsurlsessiontask/1411121-resume_language-objc.html"><code><span>resume</span></code></a>.</span><!--end_enstr-->
<span class="jpstr">
タスクを開始するために、<a class="symbol-name" href="../../../documentation/foundation/nsurlsessiontask/1411121-resume_language-objc.html"><code><span>resume</span></code></a>を呼び出してください。
</span><!--end_jpstr-->
</p></li></ol><p><span class="enstr">In <a href="../../../documentation/foundation/url_loading_system/downloading_files_in_the_background_language-objc.html#2920776">Listing 2</a>, the task is set to begin at least one hour in the future and is configured to send around 200 bytes of data and receive around 500 KB.</span><!--end_enstr-->
<span class="jpstr">
<a href="../../../documentation/foundation/url_loading_system/downloading_files_in_the_background_language-objc.html#2920776">コード出力 2</a>では、タスクは最小では将来１時間で開始するよう設定されます、そして200バイトのデータを送信して500KBほど受信するように構成設定されます。
</span><!--end_jpstr-->
</p><figure id="2920776"><figcaption><strong class="caption-title"><span class="enstr">Listing 2</span><!--end_enstr-->
<span class="jpstr">
コード出力 2 
</span><!--end_jpstr-->
</strong> <div class="caption-content formatted-content"><div><p><span class="enstr">Creating a download task from a URL session</span><!--end_enstr-->
<span class="jpstr">
URLセッションからダウンロードタスクを作成する
</span><!--end_jpstr-->
</p></div></div></figcaption><div class="formatted-content"><div class="code-listing"><pre class="code-source" data-language="swift"><code>let backgroundTask = urlSession.downloadTask(with: url)
backgroundTask.earliestBeginDate = Date().addingTimeInterval(60 * 60)
backgroundTask.countOfBytesClientExpectsToSend = 200
backgroundTask.countOfBytesClientExpectsToReceive = 500 * 1024
backgroundTask.resume()
</code></pre></div></div></figure></div><h3 id="2928518"><span class="enstr">Handle App Suspension</span><!--end_enstr-->
<span class="jpstr">
アプリの一時停止を取り扱う
</span><!--end_jpstr-->
</h3><div><p><span class="enstr">Different app states affect how your app interacts with the background download. In iOS, your app could be in the foreground, suspended, or even terminated by the system. See <a href="https://developer.apple.com/documentation/uikit/app_and_environment/managing_your_app_s_life_cycle_language-objc">Managing Your App's Life Cycle</a> for more information about these states.</span><!--end_enstr-->
<span class="jpstr">
異なるアプリ状態は、どのようにあなたのアプリがバックグラウンドダウンロードと相互作用するかに影響します。iOSでは、あなたのアプリはシステムによって前面、一時停止、または終了されることさえありえます。<a href="https://developer.apple.com/documentation/uikit/app_and_environment/managing_your_app_s_life_cycle_language-objc">Managing Your App's Life Cycle</a>をそれらの状態についてのさらなる情報として見てください。
</span><!--end_jpstr-->
</p><p><span class="enstr">If your app is in the background, the system may suspend your app while the download is performed in another process. In this case, when the download finishes, the system resumes the app and calls the <a class="symbol-name" href="https://developer.apple.com/documentation/uikit/uiapplicationdelegate_language-objc"><code><span>UIApplication<wbr/>Delegate</span></code></a> method <a class="symbol-name" href="https://developer.apple.com/documentation/uikit/uiapplicationdelegate/1622941-application_language-objc"><code><span>application:<wbr/>handle<wbr/>Events<wbr/>For<wbr/>Background<wbr/>URLSession:<wbr/>completion<wbr/>Handler:</span></code></a>. This method receives the session identifier you created in <span class="reference">Listing 1</span> as its second parameter.</span><!--end_enstr-->
<span class="jpstr">
あなたのアプリがバックグラウンドであるならば、システムはあなたのアプリを、ダウンロードが別のプロセスにおいて実行される間に一時停止にするかもしれません。この場合には、タウンロードが終了する時、システムはアプリを再開して、<a class="symbol-name" href="https://developer.apple.com/documentation/uikit/uiapplicationdelegate_language-objc"><code><span>UIApplication<wbr/>Delegate</span></code></a>のメソッド<a class="symbol-name" href="https://developer.apple.com/documentation/uikit/uiapplicationdelegate/1622941-application_language-objc"><code><span>application:<wbr/>handle<wbr/>Events<wbr/>For<wbr/>Background<wbr/>URLSession:<wbr/>completion<wbr/>Handler:</span></code></a>を呼び出します。このメソッドは、あなたが<span class="reference">コード出力 1</span> において作成したセッション識別子を、それの２番目のパラメータとして受け取ります。
</span><!--end_jpstr-->
</p><p><span class="enstr">This delegate method also receives a completion handler as its final parameter. Immediately store this handler wherever it makes sense for your app, perhaps as a property of your app delegate, or of your class that implements <code class="code-voice"><span>NSURLSession<wbr/>Download<wbr/>Delegate</span></code>. In <a href="../../../documentation/foundation/url_loading_system/downloading_files_in_the_background_language-objc.html#2936325">Listing 3</a>, this completion handler is stored in an app delegate property called <code class="code-voice"><span>background<wbr/>Completion<wbr/>Handler</span></code>.</span><!--end_enstr-->
<span class="jpstr">
この委任先メソッドはまた、完了ハンドラをそれの最終パラメータとして受け取ります。直接にこのハンドラをそれがあなたのアプリを理解するどこへでも格納してください、おそらくあなたのアプリ委任先の、または<code class="code-voice"><span>NSURLSession<wbr/>Download<wbr/>Delegate</span></code>を実装するあなたのクラスのプロパティとして。<a href="../../../documentation/foundation/url_loading_system/downloading_files_in_the_background_language-objc.html#2936325">コード出力 3</a> では、この完了ハンドラは<code class="code-voice"><span>background<wbr/>Completion<wbr/>Handler</span></code>と呼ばれるアプリ委任先プロパティにおいて格納されます。
</span><!--end_jpstr-->
</p><figure id="2936325"><figcaption><strong class="caption-title"><span class="enstr">Listing 3</span><!--end_enstr-->
<span class="jpstr">
コード出力 3 
</span><!--end_jpstr-->
</strong> <div class="caption-content formatted-content"><div><p><span class="enstr">Storing the background download completion handler sent to the application delegate</span><!--end_enstr-->
<span class="jpstr">
アプリケーション委任先に送信されるバックグラウンドダウンロード完了ハンドラを格納する
</span><!--end_jpstr-->
</p></div></div></figcaption><div class="formatted-content"><div class="code-listing"><pre class="code-source" data-language="swift"><code>func application(_ application: UIApplication,
                 handleEventsForBackgroundURLSession identifier: String,
                 completionHandler: @escaping () -&gt; Void) {
        backgroundCompletionHandler = completionHandler
}
</code></pre></div></div></figure><p><span class="enstr">When all events have been delivered,  the system calls the <a class="symbol-name" href="../../../documentation/foundation/nsurlsessiondelegate/1617185-urlsessiondidfinisheventsforback_language-objc.html"><code><span>URLSession<wbr/>Did<wbr/>Finish<wbr/>Events<wbr/>For<wbr/>Background<wbr/>URLSession:</span></code></a> method of <a class="symbol-name" href="../../../documentation/foundation/nsurlsessiondelegate_language-objc.html"><code><span>NSURLSession<wbr/>Delegate</span></code></a>. At this point, fetch  the <code class="code-voice"><span>background<wbr/>Completion<wbr/>Handler</span></code> stored by the app delegate in <a href="../../../documentation/foundation/url_loading_system/downloading_files_in_the_background_language-objc.html#2936325">Listing 3</a> and execute it. <a href="../../../documentation/foundation/url_loading_system/downloading_files_in_the_background_language-objc.html#2928519">Listing 4</a> shows this process.</span><!--end_enstr-->
<span class="jpstr">
全てのイベントが配達される時、システムは<a class="symbol-name" href="../../../documentation/foundation/nsurlsessiondelegate_language-objc.html"><code><span>NSURLSession<wbr/>Delegate</span></code></a>の<a class="symbol-name" href="../../../documentation/foundation/nsurlsessiondelegate/1617185-urlsessiondidfinisheventsforback_language-objc.html"><code><span>URLSession<wbr/>Did<wbr/>Finish<wbr/>Events<wbr/>For<wbr/>Background<wbr/>URLSession:</span></code></a>メソッドを呼び出します。この時点で、<a href="../../../documentation/foundation/url_loading_system/downloading_files_in_the_background_language-objc.html#2936325">コード出力 3</a>でのアプリ委任先によって格納される<code class="code-voice"><span>background<wbr/>Completion<wbr/>Handler</span></code>を取って来てそれを遂行します。<a href="../../../documentation/foundation/url_loading_system/downloading_files_in_the_background_language-objc.html#2928519">コード出力 4</a> は、このプロセスを示します。
</span><!--end_jpstr-->
</p><p><span class="enstr">Note that because <code class="code-voice"><span>URLSession<wbr/>Did<wbr/>Finish<wbr/>Events<wbr/>For<wbr/>Background<wbr/>URLSession:</span></code> may be called on a secondary queue, it needs to explicitly execute the handler (which was received from a UIKit method) on the main queue.</span><!--end_enstr-->
<span class="jpstr">
<code class="code-voice"><span>URLSession<wbr/>Did<wbr/>Finish<wbr/>Events<wbr/>For<wbr/>Background<wbr/>URLSession:</span></code>が二次的なキュー上で呼び出されるかもしれないことから、それは明示的にハンドラ（それはUIKitメソッドから受け取られた）をメインキュー上で遂行する必要があることに注意してください。
</span><!--end_jpstr-->
</p><figure id="2928519"><figcaption><strong class="caption-title"><span class="enstr">Listing 4</span><!--end_enstr-->
<span class="jpstr">
コード出力 4 
</span><!--end_jpstr-->
</strong> <div class="caption-content formatted-content"><div><p><span class="enstr">Executing the background URL session completion handler on the main queue</span><!--end_enstr-->
<span class="jpstr">
バックグラウンドURLセッション完了ハンドラをメインキュー上で遂行する
</span><!--end_jpstr-->
</p></div></div></figcaption><div class="formatted-content"><div class="code-listing"><pre class="code-source" data-language="swift"><code>func urlSessionDidFinishEvents(forBackgroundURLSession session: URLSession) {
    DispatchQueue.main.async {
        guard let appDelegate = UIApplication.shared.delegate as? AppDelegate,
            let backgroundCompletionHandler =
            appDelegate.backgroundCompletionHandler else {
                return
        }
        backgroundCompletionHandler()
    }
}
</code></pre></div></div></figure><p></p></div><h3 id="3087615"><span class="enstr">Access the File, or Move It to a Permanent Location</span><!--end_enstr-->
<span class="jpstr">
ファイルにアクセスする、またはそれを永久的な場所に移動する
</span><!--end_jpstr-->
</h3><div><p><span class="enstr">Once your resumed app calls the completion handler, the download task finishes its work and calls the delegate’s <a class="symbol-name" href="../../../documentation/foundation/nsurlsessiondownloaddelegate/1411575-urlsession_language-objc.html"><code><span>URLSession:<wbr/>download<wbr/>Task:<wbr/>did<wbr/>Finish<wbr/>Downloading<wbr/>To<wbr/>URL:</span></code></a> method. At this point, the file is fully downloaded, and will be available until your delegate method returns. If you only need to read it once, you can access the file immediately in its temporary location. If you want to preserve the file, move it to a permanent location like the <code class="code-voice"><span>Documents</span></code> directory, as described in <a href="../../../documentation/foundation/url_loading_system/downloading_files_from_websites_language-objc.html">Downloading Files from Websites</a>.</span><!--end_enstr-->
<span class="jpstr">
一旦あなたの再開されたアプリが完了ハンドラを呼び出すならば、ダウンロードタスクはそれの仕事を終了します、そして委任先のもつ<a class="symbol-name" href="../../../documentation/foundation/nsurlsessiondownloaddelegate/1411575-urlsession_language-objc.html"><code><span>URLSession:<wbr/>download<wbr/>Task:<wbr/>did<wbr/>Finish<wbr/>Downloading<wbr/>To<wbr/>URL:</span></code></a>メソッドを呼び出します。この時点で、ファイルは完全にダウンロードされます、そしてあなたの委任先メソッドが返るまでは利用可能でしょう。あなたがそれを一度だけ読み出す必要があるだけならば、あなたはそのファイルに直接にそれの一時的場所でアクセスできます。あなたがファイルを保存することを望むならば、それを<code class="code-voice"><span>Documents</span></code>ディレクトリのような永久的な場所に移動してください、<a href="../../../documentation/foundation/url_loading_system/downloading_files_from_websites_language-objc.html">ファイルをウェブサイトからダウンロードする</a>で記述されるように。
</span><!--end_jpstr-->
</p></div><h3 id="2936566"><span class="enstr">Recreate the Session If the App Was Terminated</span><!--end_enstr-->
<span class="jpstr">
アプリが終了されたならばセッションを再度作成する
</span><!--end_jpstr-->
</h3><div><p><span class="enstr">If the system terminated the app while it was suspended, the system relaunches the app in the background. As part of your launch time setup, recreate the background session (see <span class="reference">Listing 1</span>), using the same session identifier as before, to allow the system to reassociate the background download task with your session. You do this so your background session is ready to go whether the app was launched by the user or by the system. Once the app relaunches, the series of events is the same as if the app had been suspended and resumed, as discussed earlier in <a href="../../../documentation/foundation/url_loading_system/downloading_files_in_the_background_language-objc.html#2928518">Handle App Suspension</a>.</span><!--end_enstr-->
<span class="jpstr">
システムがそのアプリをそれが一時停止された間に終了するならば、システムはそのアプリをバックグラウンドで再起動します。あなたの起動時準備の一部として、バックグラウンドセッションを再作成して（<span class="reference">コード出力 1</span>を見てください）、前と同じセッション識別子を使用することで、システムがバックグラウンドタスクをあなたのセッションと再度結び付けられるようにします。あなたがこれをすることで、あなたのバックグラウンドセッションは、アプリがユーザによって起動されようとシステムによってであろうと、すぐに使えます。一旦アプリが再起動するならば、一連の出来事は、アプリが一時停止および再開された場合と同じです、より前に<a href="../../../documentation/foundation/url_loading_system/downloading_files_in_the_background_language-objc.html#2928518">アプリの一時停止を取り扱う</a>で議論されたように。
</span><!--end_jpstr-->
</p><aside class="aside aside-note" role="note"><p class="aside-name"><span class="enstr">Note</span><!--end_enstr-->
<span class="jpstr">
注意
</span><!--end_jpstr-->
</p><p><span class="enstr">In cases where the transfer is initiated while the app is in the background, the session configuration's <code class="code-voice"><span>discretionary</span></code> property is treated as being <code class="code-voice"><span>YES</span></code>.</span><!--end_enstr-->
<span class="jpstr">
アプリがバックグラウンドにある間に転送が開始される場合では、セッション構成設定のもつ<code class="code-voice"><span>discretionary</span></code>プロパティは<code class="code-voice"><span>YES</span></code>であると扱われます。
</span><!--end_jpstr-->
</p></aside></div><h3 id="2920790"><span class="enstr">Comply with Background Transfer Limitations</span><!--end_enstr-->
<span class="jpstr">
バックグラウンド転送制限に従う
</span><!--end_jpstr-->
</h3><div><p><span class="enstr">With background sessions, the actual transfer is performed by a process that is separate from your app’s process. Because restarting your app’s process is fairly expensive, a few features are unavailable, resulting in the following limitations:</span><!--end_enstr-->
<span class="jpstr">
バックグラウンドセッションでは、実際の転送は、あなたのアプリのもつプロセスから独立するあるプロセスによって実行されます。あなたのアプリのもつプロセスを再始動することはかなり高くつくことから、少数の機能は利用できません、結果として以下の制限になります：
</span><!--end_jpstr-->
</p><ul><li><p><span class="enstr">The session <em>must</em> provide a delegate for event delivery. (For uploads and downloads, the delegates behave the same as for in-process transfers.)</span><!--end_enstr-->
<span class="jpstr">
セッションは、ある委任先をイベント配送のために提供する<em>必要があります</em>。（アップロードとダウンロードに対して、委任先は進行中の転送と同じに振る舞います。）
</span><!--end_jpstr-->
</p></li><li><p><span class="enstr">Only HTTP and HTTPS protocols are supported (no custom protocols).</span><!--end_enstr-->
<span class="jpstr">
HTTPとHTTPSプロトコルだけがサポートされます（あつらえのプロトコルはだめです）。
</span><!--end_jpstr-->
</p></li><li><p><span class="enstr">Redirects are always followed. As a result, even if you have implemented <a class="symbol-name" href="../../../documentation/foundation/nsurlsessiontaskdelegate/1411626-urlsession_language-objc.html"><code><span>URLSession:<wbr/>task:<wbr/>will<wbr/>Perform<wbr/>HTTPRedirection:<wbr/>new<wbr/>Request:<wbr/>completion<wbr/>Handler:</span></code></a>, it is <em>not</em> called.</span><!--end_enstr-->
<span class="jpstr">
リダイレクトは、常に対応されます。結果として、たとえあなたが<a class="symbol-name" href="../../../documentation/foundation/nsurlsessiontaskdelegate/1411626-urlsession_language-objc.html"><code><span>URLSession:<wbr/>task:<wbr/>will<wbr/>Perform<wbr/>HTTPRedirection:<wbr/>new<wbr/>Request:<wbr/>completion<wbr/>Handler:</span></code></a>を実装したとしても、それは呼び出され<em>ません</em>。
</span><!--end_jpstr-->
</p></li><li><p><span class="enstr">Only upload tasks from a file are supported (uploads from data instances or a stream fail after the app exits).</span><!--end_enstr-->
<span class="jpstr">
ファイルからのアップロードタスクだけがサポートされます（データインスタンスまたはストリームからのアップロードはアプリが終了する後に失敗します）。
</span><!--end_jpstr-->
 </p></li></ul><p></p></div><h3 id="3038438"><span class="enstr">Use Background Sessions Efficiently</span><!--end_enstr-->
<span class="jpstr">
バックグラウンドセッションを効率的に使う
</span><!--end_jpstr-->
</h3><div><p><span class="enstr">When the system resumes or relaunches your app, it uses a rate limiter to prevent abuse of background downloads. When your app starts a new download task while in the background, the task doesn't begin until the delay expires. The delay increases each time the system resumes or relaunches your app.</span><!--end_enstr-->
<span class="jpstr">
システムがあなたのアプリを再開または再起動する時、それはある比率制限を使ってバックグラウンドダウンロードの乱用を防ぎます。あなたのアプリが新しいダウンロードタスクを開始する一方でバックグラウンドにある場合、そのタスクは延期が満了するまで始まりません。延期は、システムがあなたのアプリを再開または再起動するごとに増大します。
</span><!--end_jpstr-->
</p><p><span class="enstr">As a result, if your app starts a single background download, gets resumed when the download completes, and then starts a new download, it will greatly increase the delay. Instead, use a small number of background sessions — ideally just one — and use these sessions to start many download tasks at once. This allows the system to perform multiple downloads at once, and resume your app when they have completed.</span><!--end_enstr-->
<span class="jpstr">
結果として、あなたのアプリがある単一のバックグラウンドダウンロードを開始するならば、ダウンロードが完了する時に再開されます、そしてそれから新しいダウンロードを始めます、それは大幅に延期を増やすでしょう。代わりに、少ない数のバックグラウンドセッションを使ってください — 理想的にはただ１つだけ — そしてそれらセッションを使って多くのダウンロードタスクを一度に開始してください。これは、システムに複数のダウンロードを一度に実行させます、そしてそれらが完了する時にあなたのアプリを再開します。
</span><!--end_jpstr-->
</p><p><span class="enstr">Keep in mind, though, that each task has its own overhead. If you find you need to launch thousands of download tasks, change your design to perform fewer, larger transfers.</span><!--end_enstr-->
<span class="jpstr">
心に留めておいてください、各タスクはそれ自身の経費がかかることを。あなたが何千というダウンロードタスクを起動する必要があることに気づくならば、あなたの設計を変更することで、より少しの、より多くの転送を実行してください。
</span><!--end_jpstr-->
</p><aside class="aside aside-note" role="note"><p class="aside-name"><span class="enstr">Note</span><!--end_enstr-->
<span class="jpstr">
注意
</span><!--end_jpstr-->
</p><p><span class="enstr">The delay is reset to 0 whenever the user brings your app to the foreground. It also resets if the delay period elapses without the system resuming or relaunching your app.</span><!--end_enstr-->
<span class="jpstr">
延期は、ユーザがあなたのアプリを前面に持って来るときはいつでも、０に設定し直されます。それはまた、システムがあなたのアプリを再開または再起動することなく延期期間が過ぎ去るならば設定し直されます。
</span><!--end_jpstr-->
</p></aside><p></p></div></div></section></div></div><section id="see-also" class="contenttable section alt-light-container row"><div class="alt-light"><div class="section-content"><h2 class="contenttable-title"><span class="enstr">See Also</span><!--end_enstr-->
<span class="jpstr">
参照
</span><!--end_jpstr-->
</h2><section id="3038364" class="contenttable-section"><div class="contenttable-container row"><div class="contenttable-section-title-container column large-3 medium-3 small-12"><h3 class="contenttable-section-title"><span class="enstr">Downloading</span><!--end_enstr-->
<span class="jpstr">
ダウンロード
</span><!--end_jpstr-->
</h3></div><div class="contenttable-section-content column large-9 medium-9 small-12"><div class="task-topics"><div class="task-topic"><div class="task-topic-info"><a class="has-adjacent-element symbol-name" href="../../../documentation/foundation/url_loading_system/downloading_files_from_websites_language-objc.html"><svg xmlns="http://www.w3.org/2000/svg" height="15" viewBox="0 0 22 30" class="svg-icon symbol-name-icon" aria-hidden="true"><title>Article</title><g id="Article" class="svg-icon-small"><path d="M12.87,0H0V2H0V28H0v2H22V9.13ZM20,28H2V2h9V12h9Zm0-18H13V3l7,7Z"></path></g></svg><span><span class="enstr">Downloading Files from Websites</span><!--end_enstr-->
<span class="jpstr">
ファイルをウェブサイトからダウンロードする
</span><!--end_jpstr-->
</span></a><div class="task-topic-abstract task-topic-data abstract formatted-content"><div><p><span class="enstr">Download files directly to the filesystem.</span><!--end_enstr-->
<span class="jpstr">
ファイルを直接にファイルシステムにダウンロードします。
</span><!--end_jpstr-->
</p></div></div></div></div><div class="task-topic"><div class="task-topic-info"><a class="has-adjacent-element symbol-name" href="../../../documentation/foundation/url_loading_system/pausing_and_resuming_downloads_language-objc.html"><svg xmlns="http://www.w3.org/2000/svg" height="15" viewBox="0 0 22 30" class="svg-icon symbol-name-icon" aria-hidden="true"><title>Article</title><g id="Article" class="svg-icon-small"><path d="M12.87,0H0V2H0V28H0v2H22V9.13ZM20,28H2V2h9V12h9Zm0-18H13V3l7,7Z"></path></g></svg><span><span class="enstr">Pausing and Resuming Downloads</span><!--end_enstr-->
<span class="jpstr">
ダウンロードを一時停止および再開する
</span><!--end_jpstr-->
</span></a><div class="task-topic-abstract task-topic-data abstract formatted-content"><div><p><span class="enstr">Allow the user to resume a download without starting over.</span><!--end_enstr-->
<span class="jpstr">
ユーザにダウンロードを最初からやり直すことなく再開させます。
</span><!--end_jpstr-->
</p></div></div></div></div></div></div></div></section></div></div></section></main><section id="globalfooter-wrapper"><footer id="globalfooter" role="contentinfo">
        <nav class="footer-breadory">
          <a href="/" class="home breadcrumbs-home"><span aria-hidden="true"></span><span class="breadcrumbs-home-label">Developer</span></a>
          <section class="breadcrumbs">
            <ol class="breadcrumbs-list">
              <li><a href=/documentation>Documentation</a></li>
            </ol>
          </section>
          <div id="directorynav" class="directorynav">
            <div id="dn-cola" class="column">
              <h3><a href="/discover/">Discover</a></h3>
              <ul>
                <li><a href="/macos/">macOS</a></li>
                <li><a href="/ios/">iOS</a></li>
                <li><a href="/watchos/">watchOS</a></li>
                <li><a href="/tvos/">tvOS</a></li>
                <li><a href="/safari/">Safari and Web</a></li>
                <li><a href="/games/">Games</a></li>
                <li><a href="/business/">Business</a></li>
                <li><a href="/education/">Education</a></li>
                <li><a href="/wwdc/">WWDC</a></li>
              </ul>
            </div>
            <div id="dn-colb" class="column">
              <h3><a href="/design/">Design</a></h3>
              <ul>
                <li><a href="/design/human-interface-guidelines/">Human Interface Guidelines</a></li>
                <li><a href="/design/resources/"><span class="enstr">Resources</span><!--end_enstr-->
<span class="jpstr">
リソース
</span><!--end_jpstr-->
</a></li>
                <li><a href="/videos/design/">Videos</a></li>
                <li><a href="/design/awards/">Apple Design Awards</a></li>
                <li><a href="/accessibility/">Accessibility</a></li>
                <li><a href="/internationalization/"><span class="enstr">Internationalization</span><!--end_enstr-->
<span class="jpstr">
国際化
</span><!--end_jpstr-->
</a></li>
                <li><a href="/accessories/">Accessories</a></li>
              </ul>
            </div>
            <div id="dn-colc" class="column">
              <h3><a href="/develop/">Develop</a></h3>
              <ul>
                <li><a href="/xcode/">Xcode</a></li>
                <li><a href="/swift/">Swift</a></li>
                <li><a href="/swift-playgrounds/">Swift Playgrounds</a></li>
                <li><a href="/testflight/">TestFlight</a></li>
                <li><a href="https://developer.apple.com/documentation/">Documentation</a></li>
                <li><a href="/videos/">Videos</a></li>
                <li><a href="/download/">Downloads</a></li>
              </ul>
            </div>
            <div id="dn-cold" class="column">
              <h3><a href="/distribute/">Distribute</a></h3>
              <ul>
                <li><a href="/programs/">Developer Program</a></li>
                <li><a href="/app-store/">App Store</a></li>
                <li><a href="/app-store/review/">App Review</a></li>
                <li><a href="/macos/distribution/">Mac Software</a></li>
                <li><a href="/business/distribute/">Apps for Business</a></li>
                <li><a href="/safari/extensions/">Safari Extensions</a></li>
                <li><a href="/app-store/marketing/guidelines/">Marketing Resources</a></li>
                <li><a href="/softwarelicensing/">Trademark Licensing</a></li>
              </ul>
            </div>
            <div id="dn-cole" class="column">
              <h3><a href="/support/">Support</a></h3>
              <ul>
                <li><a href="https://forums.developer.apple.com">Developer Forums</a></li>
                <li><a href="/bug-reporting/">Bug Reporting</a></li>
                <li><a href="/terms/">License Agreements</a></li>
                <li><a href="/system-status/">System Status</a></li>
                <li><a href="/contact/">Contact Us</a></li>
              </ul>
              <h3><a href="/account/">Account</a></h3>
              <ul>
                <li><a href="/account/ios/certificate/">Certificates, IDs &amp; Profiles</a></li>
                <li><a href="https://appstoreconnect.apple.com/">App Store Connect</a></li>
              </ul>
            </div>
          </div>
        </nav>
        <div class="ac-gf-footer-legal">
          <div class="ac-gf-footer-news"> To receive the latest developer news, visit and subscribe to our <a href="/news/">News and Updates</a>.
          </div>
          <div class="ac-gf-footer-legal-copyright">Copyright © 2020 Apple Inc. All rights reserved.</div>
          <div class="ac-gf-footer-legal-links">
            <a href="https://www.apple.com/legal/internet-services/terms/site.html" class="first">Terms of Use</a>
            <a href="https://www.apple.com/privacy/privacy-policy/">Privacy Policy</a>
            <a href="/bug-reporting/">Report Bugs</a>
            <a href="/contact/submit/?subject=website-feedback">Feedback</a>
          </div>
          <div class="ac-gf-footer-language-links">
            <a href="/cn/" class="first">简体中文</a>
            <a href="/jp/">日本語</a>
            <a href="/kr/">한국어</a>
          </div>
        </div>
      </footer></section></div></div><script id="bootstrap-data" type="application/json">{"id":2919403,"abstract":"<div><p>Create tasks that download files while your app is inactive.<\/p><\/div>","title":{"content":"Downloading Files in the Background"},"discussion":"<div><p>For long-running and nonurgent transfers, you can create tasks that run in the background. These tasks continue to run even when your app is suspended, allowing your app to access the downloaded file when the app is resumed. <\/p><aside class=\"aside aside-note\" role=\"note\"><p class=\"aside-name\">Note<\/p><p>You don’t have to do all background network activity with background sessions as described in this article. Apps that declare appropriate background modes can use default URL sessions and data tasks, just as if they were in the foreground.<\/p><\/aside><\/div><h3 id=\"2920773\">Configure the Background Session<\/h3><div><p>To perform a background download, configure a <a class=\"symbol-name\" href=\"\/documentation\/foundation\/nsurlsession_language-objc\"><code><span>NSURLSession<\/span><\/code><\/a> for background operation. <a href=\"\/documentation\/foundation\/url_loading_system\/downloading_files_in_the_background_language-objc#2920777\">Listing 1<\/a> demonstrates this process. <\/p><ol><li><p>Create a background <a class=\"symbol-name\" href=\"\/documentation\/foundation\/nsurlsessionconfiguration_language-objc\"><code><span>NSURLSession<wbr\/>Configuration<\/span><\/code><\/a> object with the class method <a class=\"symbol-name\" href=\"\/documentation\/foundation\/nsurlsessionconfiguration\/1407496-backgroundsessionconfigurationwi_language-objc\"><code><span>background<wbr\/>Session<wbr\/>Configuration<wbr\/>With<wbr\/>Identifier:<\/span><\/code><\/a> of <code class=\"code-voice\"><span>NSURLSession<\/span><\/code>, providing a session identifier that is unique within your app. Because most apps need only a few background sessions (usually one), you can use a fixed string for the identifier, rather than a dynamically generated identifier. The identifier doesn’t need to be unique globally. <\/p><\/li><li><p>To have the system to wake up your app when a task completes and the app is in the background, make sure the <a class=\"symbol-name\" href=\"\/documentation\/foundation\/nsurlsessionconfiguration\/1617174-sessionsendslaunchevents_language-objc\"><code><span>session<wbr\/>Sends<wbr\/>Launch<wbr\/>Events<\/span><\/code><\/a> property is set to <code class=\"code-voice\"><span>true<\/span><\/code> (the default).<\/p><\/li><li><p>For time-insensitive tasks, enable the <a class=\"symbol-name\" href=\"\/documentation\/foundation\/nsurlsessionconfiguration\/1411552-discretionary_language-objc\"><code><span>discretionary<\/span><\/code><\/a> property, so the system can wait for optimal conditions to perform the transfer, such as when the device is plugged in or connected to Wi-Fi.<\/p><\/li><li><p>Use the <code class=\"code-voice\"><span>NSURLSession<wbr\/>Configuration<\/span><\/code> instance to create a <code class=\"code-voice\"><span>NSURLSession<\/span><\/code> instance. Provide a delegate, to receive events from the background transfer. <\/p><\/li><\/ol><p><\/p><figure id=\"2920777\"><figcaption><strong class=\"caption-title\">Listing 1<\/strong> <div class=\"caption-content formatted-content\"><div><p>Creating a background URL session<\/p><\/div><\/div><\/figcaption><div class=\"formatted-content\"><div class=\"code-listing\"><pre class=\"code-source\" data-language=\"swift\"><code>private lazy var urlSession: URLSession = {\n    let config = URLSessionConfiguration.background(withIdentifier: &quot;MySession&quot;)\n    config.isDiscretionary = true\n    config.sessionSendsLaunchEvents = true\n    return URLSession(configuration: config, delegate: self, delegateQueue: nil)\n}()\n<\/code><\/pre><\/div><\/div><\/figure><p><\/p><aside class=\"aside aside-note\" role=\"note\"><p class=\"aside-name\">Note<\/p><p>For more visibility into how the system is scheduling and performing your background tasks, download and install the Background Networking Profile onto your iOS device from the Bug Reporting <a href=\"https:\/\/developer.apple.com\/bug-reporting\/profiles-and-logs\/\">Profiles and Logs<\/a> page.<\/p><\/aside><p><\/p><\/div><h3 id=\"2920774\">Create and Schedule the Download Task<\/h3><div><p>You create download tasks from the session with either the <a class=\"symbol-name\" href=\"\/documentation\/foundation\/nsurlsession\/1411482-downloadtaskwithurl_language-objc\"><code><span>download<wbr\/>Task<wbr\/>With<wbr\/>URL:<\/span><\/code><\/a> method that takes a URL, or the <a class=\"symbol-name\" href=\"\/documentation\/foundation\/nsurlsession\/1411481-downloadtaskwithrequest_language-objc\"><code><span>download<wbr\/>Task<wbr\/>With<wbr\/>Request:<\/span><\/code><\/a> method that takes a <a class=\"symbol-name\" href=\"\/documentation\/foundation\/urlrequest_language-objc\"><code><span>URLRequest<\/span><\/code><\/a> instance.  You set properties on this method to help the system optimize its behavior. <\/p><ol><li><p>As shown in <a href=\"\/documentation\/foundation\/url_loading_system\/downloading_files_in_the_background_language-objc#2920776\">Listing 2<\/a>, create a download task with <code class=\"code-voice\"><span>download<wbr\/>Task<wbr\/>With<wbr\/>URL:<\/span><\/code>.<\/p><\/li><li><p>Optionally, set the <a class=\"symbol-name\" href=\"\/documentation\/foundation\/nsurlsessiontask\/2873413-earliestbegindate_language-objc\"><code><span>earliest<wbr\/>Begin<wbr\/>Date<\/span><\/code><\/a> property to schedule the download to begin at a particular point in the future. The download isn’t guaranteed to begin at precisely this time, but it won’t start sooner. <\/p><\/li><li><p>To help the system schedule network activity efficiently, set the properties <a class=\"symbol-name\" href=\"\/documentation\/foundation\/nsurlsessiontask\/2873401-countofbytesclientexpectstosend_language-objc\"><code><span>count<wbr\/>Of<wbr\/>Bytes<wbr\/>Client<wbr\/>Expects<wbr\/>To<wbr\/>Send<\/span><\/code><\/a> and <a class=\"symbol-name\" href=\"\/documentation\/foundation\/nsurlsessiontask\/2873414-countofbytesclientexpectstorecei_language-objc\"><code><span>count<wbr\/>Of<wbr\/>Bytes<wbr\/>Client<wbr\/>Expects<wbr\/>To<wbr\/>Receive<\/span><\/code><\/a>. These values are best-guess upper bounds on the expected byte count, and should account for headers as well as body data.<\/p><\/li><li><p>To start the task, call <a class=\"symbol-name\" href=\"\/documentation\/foundation\/nsurlsessiontask\/1411121-resume_language-objc\"><code><span>resume<\/span><\/code><\/a>.<\/p><\/li><\/ol><p>In <a href=\"\/documentation\/foundation\/url_loading_system\/downloading_files_in_the_background_language-objc#2920776\">Listing 2<\/a>, the task is set to begin at least one hour in the future and is configured to send around 200 bytes of data and receive around 500 KB.<\/p><figure id=\"2920776\"><figcaption><strong class=\"caption-title\">Listing 2<\/strong> <div class=\"caption-content formatted-content\"><div><p>Creating a download task from a URL session<\/p><\/div><\/div><\/figcaption><div class=\"formatted-content\"><div class=\"code-listing\"><pre class=\"code-source\" data-language=\"swift\"><code>let backgroundTask = urlSession.downloadTask(with: url)\nbackgroundTask.earliestBeginDate = Date().addingTimeInterval(60 * 60)\nbackgroundTask.countOfBytesClientExpectsToSend = 200\nbackgroundTask.countOfBytesClientExpectsToReceive = 500 * 1024\nbackgroundTask.resume()\n<\/code><\/pre><\/div><\/div><\/figure><\/div><h3 id=\"2928518\">Handle App Suspension<\/h3><div><p>Different app states affect how your app interacts with the background download. In iOS, your app could be in the foreground, suspended, or even terminated by the system. See <a href=\"\/documentation\/uikit\/app_and_environment\/managing_your_app_s_life_cycle_language-objc\">Managing Your App&#x27;s Life Cycle<\/a> for more information about these states.<\/p><p>If your app is in the background, the system may suspend your app while the download is performed in another process. In this case, when the download finishes, the system resumes the app and calls the <a class=\"symbol-name\" href=\"\/documentation\/uikit\/uiapplicationdelegate_language-objc\"><code><span>UIApplication<wbr\/>Delegate<\/span><\/code><\/a> method <a class=\"symbol-name\" href=\"\/documentation\/uikit\/uiapplicationdelegate\/1622941-application_language-objc\"><code><span>application:<wbr\/>handle<wbr\/>Events<wbr\/>For<wbr\/>Background<wbr\/>URLSession:<wbr\/>completion<wbr\/>Handler:<\/span><\/code><\/a>. This method receives the session identifier you created in <span class=\"reference\">Listing 1<\/span> as its second parameter.<\/p><p>This delegate method also receives a completion handler as its final parameter. Immediately store this handler wherever it makes sense for your app, perhaps as a property of your app delegate, or of your class that implements <code class=\"code-voice\"><span>NSURLSession<wbr\/>Download<wbr\/>Delegate<\/span><\/code>. In <a href=\"\/documentation\/foundation\/url_loading_system\/downloading_files_in_the_background_language-objc#2936325\">Listing 3<\/a>, this completion handler is stored in an app delegate property called <code class=\"code-voice\"><span>background<wbr\/>Completion<wbr\/>Handler<\/span><\/code>.<\/p><figure id=\"2936325\"><figcaption><strong class=\"caption-title\">Listing 3<\/strong> <div class=\"caption-content formatted-content\"><div><p>Storing the background download completion handler sent to the application delegate<\/p><\/div><\/div><\/figcaption><div class=\"formatted-content\"><div class=\"code-listing\"><pre class=\"code-source\" data-language=\"swift\"><code>func application(_ application: UIApplication,\n                 handleEventsForBackgroundURLSession identifier: String,\n                 completionHandler: @escaping () -&gt; Void) {\n        backgroundCompletionHandler = completionHandler\n}\n<\/code><\/pre><\/div><\/div><\/figure><p>When all events have been delivered,  the system calls the <a class=\"symbol-name\" href=\"\/documentation\/foundation\/nsurlsessiondelegate\/1617185-urlsessiondidfinisheventsforback_language-objc\"><code><span>URLSession<wbr\/>Did<wbr\/>Finish<wbr\/>Events<wbr\/>For<wbr\/>Background<wbr\/>URLSession:<\/span><\/code><\/a> method of <a class=\"symbol-name\" href=\"\/documentation\/foundation\/nsurlsessiondelegate_language-objc\"><code><span>NSURLSession<wbr\/>Delegate<\/span><\/code><\/a>. At this point, fetch  the <code class=\"code-voice\"><span>background<wbr\/>Completion<wbr\/>Handler<\/span><\/code> stored by the app delegate in <a href=\"\/documentation\/foundation\/url_loading_system\/downloading_files_in_the_background_language-objc#2936325\">Listing 3<\/a> and execute it. <a href=\"\/documentation\/foundation\/url_loading_system\/downloading_files_in_the_background_language-objc#2928519\">Listing 4<\/a> shows this process.<\/p><p>Note that because <code class=\"code-voice\"><span>URLSession<wbr\/>Did<wbr\/>Finish<wbr\/>Events<wbr\/>For<wbr\/>Background<wbr\/>URLSession:<\/span><\/code> may be called on a secondary queue, it needs to explicitly execute the handler (which was received from a UIKit method) on the main queue.<\/p><figure id=\"2928519\"><figcaption><strong class=\"caption-title\">Listing 4<\/strong> <div class=\"caption-content formatted-content\"><div><p>Executing the background URL session completion handler on the main queue<\/p><\/div><\/div><\/figcaption><div class=\"formatted-content\"><div class=\"code-listing\"><pre class=\"code-source\" data-language=\"swift\"><code>func urlSessionDidFinishEvents(forBackgroundURLSession session: URLSession) {\n    DispatchQueue.main.async {\n        guard let appDelegate = UIApplication.shared.delegate as? AppDelegate,\n            let backgroundCompletionHandler =\n            appDelegate.backgroundCompletionHandler else {\n                return\n        }\n        backgroundCompletionHandler()\n    }\n}\n<\/code><\/pre><\/div><\/div><\/figure><p><\/p><\/div><h3 id=\"3087615\">Access the File, or Move It to a Permanent Location<\/h3><div><p>Once your resumed app calls the completion handler, the download task finishes its work and calls the delegate’s <a class=\"symbol-name\" href=\"\/documentation\/foundation\/nsurlsessiondownloaddelegate\/1411575-urlsession_language-objc\"><code><span>URLSession:<wbr\/>download<wbr\/>Task:<wbr\/>did<wbr\/>Finish<wbr\/>Downloading<wbr\/>To<wbr\/>URL:<\/span><\/code><\/a> method. At this point, the file is fully downloaded, and will be available until your delegate method returns. If you only need to read it once, you can access the file immediately in its temporary location. If you want to preserve the file, move it to a permanent location like the <code class=\"code-voice\"><span>Documents<\/span><\/code> directory, as described in <a href=\"\/documentation\/foundation\/url_loading_system\/downloading_files_from_websites_language-objc\">Downloading Files from Websites<\/a>.<\/p><\/div><h3 id=\"2936566\">Recreate the Session If the App Was Terminated<\/h3><div><p>If the system terminated the app while it was suspended, the system relaunches the app in the background. As part of your launch time setup, recreate the background session (see <span class=\"reference\">Listing 1<\/span>), using the same session identifier as before, to allow the system to reassociate the background download task with your session. You do this so your background session is ready to go whether the app was launched by the user or by the system. Once the app relaunches, the series of events is the same as if the app had been suspended and resumed, as discussed earlier in <a href=\"\/documentation\/foundation\/url_loading_system\/downloading_files_in_the_background_language-objc#2928518\">Handle App Suspension<\/a>.<\/p><aside class=\"aside aside-note\" role=\"note\"><p class=\"aside-name\">Note<\/p><p>In cases where the transfer is initiated while the app is in the background, the session configuration&#x27;s <code class=\"code-voice\"><span>discretionary<\/span><\/code> property is treated as being <code class=\"code-voice\"><span>YES<\/span><\/code>.<\/p><\/aside><\/div><h3 id=\"2920790\">Comply with Background Transfer Limitations<\/h3><div><p>With background sessions, the actual transfer is performed by a process that is separate from your app’s process. Because restarting your app’s process is fairly expensive, a few features are unavailable, resulting in the following limitations:<\/p><ul><li><p>The session <em>must<\/em> provide a delegate for event delivery. (For uploads and downloads, the delegates behave the same as for in-process transfers.)<\/p><\/li><li><p>Only HTTP and HTTPS protocols are supported (no custom protocols).<\/p><\/li><li><p>Redirects are always followed. As a result, even if you have implemented <a class=\"symbol-name\" href=\"\/documentation\/foundation\/nsurlsessiontaskdelegate\/1411626-urlsession_language-objc\"><code><span>URLSession:<wbr\/>task:<wbr\/>will<wbr\/>Perform<wbr\/>HTTPRedirection:<wbr\/>new<wbr\/>Request:<wbr\/>completion<wbr\/>Handler:<\/span><\/code><\/a>, it is <em>not<\/em> called.<\/p><\/li><li><p>Only upload tasks from a file are supported (uploads from data instances or a stream fail after the app exits). <\/p><\/li><\/ul><p><\/p><\/div><h3 id=\"3038438\">Use Background Sessions Efficiently<\/h3><div><p>When the system resumes or relaunches your app, it uses a rate limiter to prevent abuse of background downloads. When your app starts a new download task while in the background, the task doesn&#x27;t begin until the delay expires. The delay increases each time the system resumes or relaunches your app.<\/p><p>As a result, if your app starts a single background download, gets resumed when the download completes, and then starts a new download, it will greatly increase the delay. Instead, use a small number of background sessions — ideally just one — and use these sessions to start many download tasks at once. This allows the system to perform multiple downloads at once, and resume your app when they have completed.<\/p><p>Keep in mind, though, that each task has its own overhead. If you find you need to launch thousands of download tasks, change your design to perform fewer, larger transfers.<\/p><aside class=\"aside aside-note\" role=\"note\"><p class=\"aside-name\">Note<\/p><p>The delay is reset to 0 whenever the user brings your app to the foreground. It also resets if the delay period elapses without the system resuming or relaunching your app.<\/p><\/aside><p><\/p><\/div>","containingGroup":[{"id":3038364,"role":"task","paths":[],"symbols":[{"id":3037341,"role":"article","paths":["documentation\/foundation\/url_loading_system\/downloading_files_from_websites"],"abstract":"<div><p>Download files directly to the filesystem.<\/p><\/div>","title":{"content":"Downloading Files from Websites"}},{"id":3038374,"role":"article","paths":["documentation\/foundation\/url_loading_system\/pausing_and_resuming_downloads"],"abstract":"<div><p>Allow the user to resume a download without starting over.<\/p><\/div>","title":{"content":"Pausing and Resuming Downloads"}},{"id":2919403,"role":"article","paths":["documentation\/foundation\/url_loading_system\/downloading_files_in_the_background"],"abstract":"<div><p>Create tasks that download files while your app is inactive.<\/p><\/div>","title":{"content":"Downloading Files in the Background"}}],"title":{"content":"Downloading"}}],"modules":[{"title":{"content":"Foundation"},"paths":["documentation\/foundation"],"importStatement":"<import xml:space=\"preserve\"><keyWord>@import<\/keyWord> Foundation<\/import>","availability":[{"platform":"iOS","introduced":"2.0"},{"platform":"tvOS","introduced":"9.0"},{"platform":"watchOS","introduced":"2.0"},{"platform":"Mac Catalyst","introduced":"13.0"},{"platform":"macOS","introduced":"10.0"}]}],"role":"article","language":"occ","roleHeading":"Article","languages":["occ","swift"],"variants":{"occ":{"paths":["documentation\/foundation\/url_loading_system\/downloading_files_in_the_background"]},"swift":{"paths":["documentation\/foundation\/url_loading_system\/downloading_files_in_the_background"]}},"pid":492525,"paths":["documentation\/foundation\/url_loading_system\/downloading_files_in_the_background"],"hierarchy":[[{"id":1613013,"role":"collection","title":{"content":"Foundation"},"paths":["documentation\/foundation"]},{"id":2877756,"role":"collectionGroup","title":{"content":"URL Loading System"},"paths":["documentation\/foundation\/url_loading_system"]}]],"legalNotices":{"copyright":"Copyright &copy; 2020 Apple Inc. All rights reserved.","termsOfUse":"https:\/\/www.apple.com\/legal\/internet-services\/terms\/site.html","privacyPolicy":"https:\/\/www.apple.com\/privacy\/privacy-policy"}}</script></body></html>