<!DOCTYPE html><html lang="en" data-reactroot=""><head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8"><title>Implementing Handoff in Your App | Apple Developer Documentation</title><!-- link href="https://www.apple.com/wss/fonts?families=SF+Pro,v1|SF+Mono,v1|SF+Pro+Icons,v1" media="all" rel="stylesheet" type="text/css"/ --><meta content="width=device-width, initial-scale=1 viewport-fit=cover" name="viewport"/><meta data-pid="424974"/><link href="../../../documentation/assets/application-e5bb1544.css" media="all" rel="stylesheet" type="text/css"/><noscript><link href="../../../documentation/assets/nojs-c6be9131.css" media="all" rel="stylesheet" type="text/css"/></noscript><link rel="mask-icon" href="../../../documentation/assets/apple-logo.svg" color="#000"/><link rel="shortcut icon" href="../../../documentation/assets/favicon.ico"/><script src="../../../documentation/assets/shared-b7676010.js"></script></head><body><div id="_omniture_top">
      <script>
        var s_account="awdappledeveloper"
      </script><!-- script src="https://developer.apple.com/assets/metrics/scripts/analytics.js" -->
      </script>
      <script>
        s.pageName= AC && AC.Tracking && AC.Tracking.pageName();
        s.channel="www.documentation.developer"

        var s_code=s.t();if(s_code)document.write(s_code)
      </script>
    </div><div id="app"><div><a href="#main" id="skip-localnav" class="showonfocus hidden">Skip Navigation</a><aside id="ac-gn-segmentbar" class="ac-gn-segmentbar" lang="en-US" dir="ltr"></aside><input type="checkbox" id="ac-gn-menustate" class="ac-gn-menustate"/><nav id="ac-globalnav" class="no-js" role="navigation" aria-label="Global" data-hires="false" data-analytics-region="global nav" lang="en-US" dir="ltr" data-store-locale="us" data-store-api="/[storefront]/shop/bag/status" data-search-locale="en_US" data-search-api="/search-services/suggestions/">
      <div class="ac-gn-content">
        <ul class="ac-gn-header">
          <li class="ac-gn-item ac-gn-menuicon">
            <label class="ac-gn-menuicon-label" for="ac-gn-menustate" aria-hidden="true">
              <span class="ac-gn-menuicon-bread ac-gn-menuicon-bread-top">
                <span class="ac-gn-menuicon-bread-crust ac-gn-menuicon-bread-crust-top"></span>
              </span>
              <span class="ac-gn-menuicon-bread ac-gn-menuicon-bread-bottom">
                <span class="ac-gn-menuicon-bread-crust ac-gn-menuicon-bread-crust-bottom"></span>
              </span>
            </label>
            <a href="#ac-gn-menustate" role="button" class="ac-gn-menuanchor ac-gn-menuanchor-open" id="ac-gn-menuanchor-open">
              <span class="ac-gn-menuanchor-label">Global Nav Open Menu</span>
            </a>
            <a href="#" role="button" class="ac-gn-menuanchor ac-gn-menuanchor-close" id="ac-gn-menuanchor-close">
              <span class="ac-gn-menuanchor-label">Global Nav Close Menu</span>
            </a>
          </li>
          <li class="ac-gn-item ac-gn-apple">
            <a class="ac-gn-link ac-gn-link-apple-developer" href="/" data-analytics-title="appledeveloper home" id="ac-gn-firstfocus-small">
              <span class="ac-gn-link-text">Apple Developer</span>
            </a>
          </li>
        </ul>
        <div class="ac-gn-search-placeholder-container" role="search">
          <div class="ac-gn-search ac-gn-search-small">
            <a id="ac-gn-link-search-small" class="ac-gn-link" href="/search/" data-analytics-title="search" data-analytics-click="search" data-analytics-intrapage-link aria-label="Search Developer">
              </a><div class="ac-gn-search-placeholder-bar">
                <div class="ac-gn-search-placeholder-input">
                  <div class="ac-gn-search-placeholder-input-text" aria-hidden="true">
                    <div class="ac-gn-link-search ac-gn-search-placeholder-input-icon"></div>
                    <span class="ac-gn-search-placeholder">Search Developer</span>
                  </div>
                </div>
                <div class="ac-gn-searchview-close ac-gn-searchview-close-small ac-gn-search-placeholder-searchview-close">
                  <span class="ac-gn-searchview-close-cancel" aria-hidden="true">Cancel</span>
                </div>
              </div>
            </a>
          </div>
        </div>
        <ul class="ac-gn-list">
          <li class="ac-gn-item ac-gn-apple">
            <a class="ac-gn-link ac-gn-link-apple-developer" href="/" data-analytics-title="appledeveloper home" id="ac-gn-firstfocus">
              <span class="ac-gn-link-text">Apple Developer</span>
              </a>
          </li>
          <li class="ac-gn-item ac-gn-item-menu ac-gn-discover">
            <a class="ac-gn-link ac-gn-link-discover" href="/discover/" data-analytics-title="discover">
              <span class="ac-gn-link-text">Discover</span>
              </a>
          </li>
          <li class="ac-gn-item ac-gn-item-menu ac-gn-design">
            <a class="ac-gn-link ac-gn-link-design" href="/design/" data-analytics-title="design">
              <span class="ac-gn-link-text">Design</span>
              </a>
          </li>
          <li class="ac-gn-item ac-gn-item-menu ac-gn-develop">
            <a class="ac-gn-link ac-gn-link-develop" href="/develop/" data-analytics-title="develop">
              <span class="ac-gn-link-text">Develop</span>
              </a>
          </li>
          <li class="ac-gn-item ac-gn-item-menu ac-gn-distribute">
            <a class="ac-gn-link ac-gn-link-distribute" href="/distribute/" data-analytics-title="distribute">
              <span class="ac-gn-link-text">Distribute</span>
              </a>
          </li>
          <li class="ac-gn-item ac-gn-item-menu ac-gn-dsupport">
            <a class="ac-gn-link ac-gn-link-dsupport" href="/support/" data-analytics-title="dsupport">
              <span class="ac-gn-link-text">Support</span>
              </a>
          </li>
          <li class="ac-gn-item ac-gn-item-menu ac-gn-account">
            <a class="ac-gn-link ac-gn-link-account" href="/account/" data-analytics-title="account">
              <span class="ac-gn-link-text">Account</span>
              </a>
          </li>
          <li class="ac-gn-item ac-gn-item-menu ac-gn-search" role="search">
            <a id="ac-gn-link-search" class="ac-gn-link ac-gn-link-search" href="/search/" data-analytics-title="search" data-analytics-click="search" data-analytics-intrapage-link aria-label="Search Developer"></a>
          </li>
        </ul>
        <aside id="ac-gn-searchview" class="ac-gn-searchview" role="search" data-analytics-region="search">
          <div class="ac-gn-searchview-content">
            <div class="ac-gn-searchview-bar">
              <div class="ac-gn-searchview-bar-wrapper">
                <form id="ac-gn-searchform" class="ac-gn-searchform" action="/search/" method="get">
                  <div class="ac-gn-searchform-wrapper">
                    <input id="ac-gn-searchform-input" class="ac-gn-searchform-input" type="text" name="q" aria-label="Search Developer" placeholder="Search Developer" autocorrect="off" autocapitalize="off" autocomplete="off" spellcheck="false" role="combobox" aria-autocomplete="list" aria-expanded="true" aria-owns="quicklinks suggestions" />
                    <button id="ac-gn-searchform-submit" class="ac-gn-searchform-submit" type="submit" disabled aria-label="Submit Search"></button>
                    <button id="ac-gn-searchform-reset" class="ac-gn-searchform-reset" type="reset" disabled aria-label="Clear Search">
                        <span class="ac-gn-searchform-reset-background"></span>
                      </button>
                  </div>
                </form>
                <button id="ac-gn-searchview-close-small" class="ac-gn-searchview-close ac-gn-searchview-close-small" aria-label="Cancel Search">
                    <span class="ac-gn-searchview-close-cancel" aria-hidden="true">
                      Cancel
                    </span>
                  </button>
              </div>
            </div>
            <aside id="ac-gn-searchresults" class="ac-gn-searchresults" data-string-quicklinks="Quick Links" data-string-suggestions="Suggested Searches" data-string-noresults=""></aside>
          </div>
          <button id="ac-gn-searchview-close" class="ac-gn-searchview-close" aria-label="Cancel Search">
              <span class="ac-gn-searchview-close-wrapper">
                <span class="ac-gn-searchview-close-left"></span>
                <span class="ac-gn-searchview-close-right"></span>
              </span>
            </button>
        </aside>
          </div>
    </nav><div class="ac-gn-blur"></div><div id="ac-gn-curtain" class="ac-gn-curtain"></div><div id="ac-gn-placeholder" class="ac-nav-placeholder"></div><input type="checkbox" id="localnav-menustate" class="localnav-menustate" aria-hidden="true"/><nav id="localnav" class="localnav localnav-dark theme-dark localnav-scrim localnav-noborder" role="navigation" aria-label="API Reference" data-sticky="true"><div class="localnav-wrapper"><div class="referencenav"><div class="localnav-background"></div><div class="localnav-content"><a href="../../../index.html" class="localnav-title">Documentation</a><div class="localnav-menu"><a href="#localnav-menustate" id="localnav-menustate-open" class="localnav-menucta-anchor localnav-menucta-anchor-open"><span class="localnav-menucta-anchor-label" aria-hidden="true">Open Menu</span></a><a href="#" id="localnav-menustate-close" class="localnav-menucta-anchor localnav-menucta-anchor-close"><span class="localnav-menucta-anchor-label" aria-hidden="true">Close Menu</span></a><div class="localnav-menu-tray"><ul aria-label="Breadcrumbs" class="localnav-menu-items localnav-menu-breadcrumbs"><li class="localnav-menu-item localnav-menu-breadcrumb-item"><a class="localnav-menu-link" href="../../../documentation/foundation.html">Foundation</a></li><li class="localnav-menu-item localnav-menu-breadcrumb-item"><a class="localnav-menu-link" href="../../../documentation/foundation/task_management.html"><span class="enstr">Task Management</span><!--end_enstr-->
<span class="jpstr">
タスク管理
</span><!--end_jpstr-->
</a></li><li class="localnav-menu-item localnav-menu-breadcrumb-item"><div class="localnav-menu-breadcrumb-current-container localnav-menu-link current"><span aria-current="page" class="localnav-menu-breadcrumb-current"><span class="enstr">Implementing Handoff in Your App</span><!--end_enstr-->
<span class="jpstr">
Handoffをあなたのアプリにおいて実装する
</span><!--end_jpstr-->
</span></div></li></ul><ul class="localnav-menu-items localnav-menu-settings" data-breadcrumbs-count="3"><li class="localnav-menu-setting language-container"><div class="language-toggle-container"><label for="language-toggle" class="language-toggle-label">Language:</label><select id="language-toggle" class="language-dropdown localnav-menu-link" style="width:auto"><option selected="" value="swift">Swift</option><option value="occ">Objective-C</option></select></div><div class="language-list-container"><span class="localnav-menu-setting-label">Language:</span><ul class="language-list"><li class="language-list-item"><span data-language="swift" aria-current="page" class="current-language">Swift</span></li><li class="language-list-item"><a href="../../../documentation/foundation/task_management/implementing_handoff_in_your_app?language=objc.html" class="localnav-menu-setting-link">Objective-C</a></li></ul></div></li><li class="localnav-menu-setting"><span class="localnav-menu-setting-label">API Changes:</span><span class="changes-toggle">None</span></li></ul></div><div class="localnav-actions"><div class="localnav-action localnav-action-menucta" aria-hidden="true"><label for="localnav-menustate" class="localnav-menucta"><span class="localnav-menucta-chevron"></span></label></div></div></div></div></div></div></nav><label for="localnav-menustate" id="localnav-curtain" aria-hidden="true"></label><main role="main" id="main" class="main" tabindex="0"><div class="topic-title"><span class="eyebrow">Article</span><h1 class="topic-heading"><span><span class="enstr">Implementing Handoff in Your App</span><!--end_enstr-->
<span class="jpstr">
Handoffをあなたのアプリにおいて実装する
</span><!--end_jpstr-->
</span></h1></div><div class="topic-container section-content row"><div class="topic-description column large-9 medium-9 small-12"><div class="topic-abstract abstract formatted-content"><div><p><span class="enstr">Create, send, and receive user activities directly.</span><!--end_enstr-->
<span class="jpstr">
ユーザアクティビティを直接に作成、送信、そして受信します。
</span><!--end_jpstr-->
</p></div></div></div><div class="topic-summary column large-3 medium-3 small-12"><div class="topic-summary-section frameworks" role="complementary" aria-label="Framework"><p class="topic-summary-section-label subsection-label"><span class="enstr">Framework</span><!--end_enstr-->
<span class="jpstr">
フレームワーク
</span><!--end_jpstr-->
</p><ul class="topic-summary-section-list"><li class="topic-summary-section-item"><span>Foundation</span></li></ul></div><div class="topic-summary-section onthispage"><nav class="onthispage-nav" aria-labelledby="onthispage-title"><p id="onthispage-title" class="topic-summary-section-label subsection-label"><span class="enstr">On This Page</span><!--end_enstr-->
<span class="jpstr">
この項には
</span><!--end_jpstr-->
</p><ul class="topic-summary-section-list"><li class="topic-summary-section-item"><a href="#overview" class="icon icon-after icon-chevrondowncircle"><span class="enstr">Overview</span><!--end_enstr-->
<span class="jpstr">
概要
</span><!--end_jpstr-->
</a></li><li class="topic-summary-section-item"><a href="#see-also" class="icon icon-after icon-chevrondowncircle"><span class="enstr">See Also</span><!--end_enstr-->
<span class="jpstr">
参照
</span><!--end_jpstr-->
</a></li></ul></nav></div></div><div class="topic-content column large-9 medium-9 small-12" id="topic-content"><section id="overview" class="section"><h2><span class="enstr">Overview</span><!--end_enstr-->
<span class="jpstr">
概要
</span><!--end_jpstr-->
</h2><div class="formatted-content"><div><p><span class="enstr">Use Handoff to transfer activities the user starts on one iOS, watchOS, or macOS device to a different device. For example, a vector graphics app on macOS can send details about an in-progress editing action to the user’s iPhone so that editing can continue there.</span><!--end_enstr-->
<span class="jpstr">
Handoffを使ってさまざまなアクティビティ、あるiOS、watchOS、またはmacOSデバイス上のさまざまなユーザ状態を、異なるデバイスに転送します。例えば、macOS上のあるベクターグラフィックアプリは、進行中の編集行動についての詳細を、そのユーザのもつiPhoneに送信できます、そうしてその編集はそこで継続できます。
</span><!--end_jpstr-->
</p><figure id="3174632"><img class="centered-block" src="../../../../docs-assets.developer.apple.com/published/4ba77c3058/f21c09e7-3a45-4ae1-81a3-dc1658607c9f.png" srcSet="../../../../docs-assets.developer.apple.com/published/4ba77c3058/f21c09e7-3a45-4ae1-81a3-dc1658607c9f.png 2x" alt='Diagram showing an application open on a MacBook. One of three activities, "create shape", is selected. This is shown as being delivered to an iPhone, which presents a user interface similar to the one on the MacBook.' width="490" height="auto"/></figure><p><span class="enstr">You implement Handoff in your app by:</span><!--end_enstr-->
<span class="jpstr">
あなたは、Handoffをあなたのアプリにおいて以下によって実装します：
</span><!--end_jpstr-->
</p><ul><li><p><span class="enstr">Representing user activities as instances of <a class="symbol-name" href="../../../documentation/foundation/nsuseractivity.html"><code><span>NSUser<wbr/>Activity</span></code></a>.</span><!--end_enstr-->
<span class="jpstr">
ユーザアクティビティを<a class="symbol-name" href="../../../documentation/foundation/nsuseractivity.html"><code><span>NSUser<wbr/>Activity</span></code></a>のインスタンスとして表す。
</span><!--end_jpstr-->
</p></li><li><p><span class="enstr">Updating the activity instances as the user performs actions in your app.</span><!--end_enstr-->
<span class="jpstr">
アクティビティインスタンスを、ユーザがあなたのアプリにおいてさまざまな動作を実行するにつれて更新する。
</span><!--end_jpstr-->
</p></li><li><p><span class="enstr">Receiving activities from Handoff in your app on other devices.</span><!--end_enstr-->
<span class="jpstr">
アクティビティを別のデバイス上のあなたのアプリにおいてHandoffから受け取る。
</span><!--end_jpstr-->
</p></li></ul><aside class="aside aside-important" aria-label="important"><p class="aside-name"><span class="enstr">Important</span><!--end_enstr-->
<span class="jpstr">
重要
</span><!--end_jpstr-->
</p><p><span class="enstr">To handoff between apps on different platforms, your apps must share the same developer Team ID. This means you must either distribute your apps through the App Store, or sign them with the same credentials.</span><!--end_enstr-->
<span class="jpstr">
異なるプラットホーム上のアプリ間で手渡し（handoff）するには、あなたのアプリそれらは同じ開発者Team IDを共有しなければなりません。これは、あなたがあなたのアプリそれらをApp Storeを通して配布するか、またはそれらを同じ資格情報で署名するかのどちらかでなければなりません。
</span><!--end_jpstr-->
</p></aside><p></p></div><h3 id="3112023"><span class="enstr">Declare Handoff Activities in Your App’s Info.plist</span><!--end_enstr-->
<span class="jpstr">
HandoffアクティビティをあなたのアプリのもつInfo.plistにおいて宣言する
</span><!--end_jpstr-->
</h3><div><p><span class="enstr">Start by identifying which activities make sense to use with Handoff. Choose activities that represent what the user is doing at some point in time, like creating a shape or editing document properties. Choose a universally-unique identifier string for each of your activities, using a reverse-DNS pattern, like <code class="code-voice"><span>com<wbr/>.example<wbr/>.app<wbr/>.activity-name</span></code>.</span><!--end_enstr-->
<span class="jpstr">
どのアクティビティがHandoffで使うのに筋が通っているか明確にすることによって始めてください。ユーザがある時点で行っている何かを表すアクティビティを選んでください、図形を作成するまたは書類プロパティを編集するのような。あなたのアクティビティのそれぞれに対して普遍的に特有な識別子文字列を選んでください、逆DNS様式を使って、<code class="code-voice"><span>com<wbr/>.example<wbr/>.app<wbr/>.activity-name</span></code>のように。
</span><!--end_jpstr-->
</p><p><span class="enstr">You use your app’s <code class="code-voice"><span>Info<wbr/>.plist</span></code> file to declare that your app can receive an activity from Handoff. Create a new top-level entry in this file with the key <a href="https://developer.apple.com/library/archive/documentation/General/Reference/InfoPlistKeyReference/Articles/CocoaKeys.html#//apple_ref/doc/uid/TP40009251-SW28">NSUserActivityTypes</a> and with the type <code class="code-voice"><span>Array</span></code>. Each member of the array should be a <code class="code-voice"><span>String</span></code> whose value is one of your activity identifiers. The following example shows the <code class="code-voice"><span>Info<wbr/>.plist</span></code> XML source of a <code class="code-voice"><span>NSUser<wbr/>Activity<wbr/>Types</span></code> entry that declares three activities that the app can continue:</span><!--end_enstr-->
<span class="jpstr">
あなたは、あなたのアプリのもつ<code class="code-voice"><span>Info<wbr/>.plist</span></code>ファイルを使って、あなたのアプリがアクティビティをHandoffから受け取り可能であることを宣言します。新しいトップレベル登録項目をこのファイルにおいてキー<a href="https://developer.apple.com/library/archive/documentation/General/Reference/InfoPlistKeyReference/Articles/CocoaKeys.html#//apple_ref/doc/uid/TP40009251-SW28">NSUserActivityTypes</a>でそして型<code class="code-voice"><span>Array</span></code>で作成してください。その配列の各項は、値があなたのアクティビティ識別子の１つである<code class="code-voice"><span>String</span></code>でなければなりません。以下の例は、<code class="code-voice"><span>NSUser<wbr/>Activity<wbr/>Types</span></code>登録項目の<code class="code-voice"><span>Info<wbr/>.plist</span></code> XMLソースを示します、それはアプリが継続可能な３つのアクティビティを宣言します：
</span><!--end_jpstr-->
</p><figure id="3112024"><div class="formatted-content"><div class="code-listing"><pre class="code-source" data-language="other"><code>&lt;key&gt;NSUserActivityTypes&lt;/key&gt;
&lt;array&gt;
    &lt;string&gt;com.example.myapp.create-shape&lt;/string&gt;
    &lt;string&gt;com.example.myapp.edit-shape&lt;/string&gt;
    &lt;string&gt;com.example.myapp.edit-document-properties&lt;/string&gt;
&lt;/array&gt;
</code></pre></div></div></figure><p><span class="enstr">Your app doesn’t need to send and receive the same set of identifiers on all platforms. For example, you might have a large macOS app and a suite of smaller iOS apps. In this case, the macOS app might handle all your activities, while each iOS app would handle a subset of these activities. Also, while watchOS can send user activities, it cannot receive them, so watchOS apps don’t declare an <code class="code-voice"><span>NSUser<wbr/>Activity<wbr/>Types</span></code> property.</span><!--end_enstr-->
<span class="jpstr">
あなたのアプリは、同じひとそろいの識別子を全てのプラットホーム上で送信および受信する必要はありません。例えば、あなたはある大きなmacOSアプリそして一揃いのより小さないくつかのiOSアプリを持つかもしれません。この場合には、macOSアプリは全てのあなたのアクティビティを取り扱うかもしれません、一方で各iOSアプリはそれらアクティビティの部分集合を取り扱うでしょう。また、watchOSはユーザアクティビティそれらを送信できる一方で、それはそれらを受信できません、それでwatchOSアプリは<code class="code-voice"><span>NSUser<wbr/>Activity<wbr/>Types</span></code>プロパティを宣言しません。
</span><!--end_jpstr-->
</p><p><span class="enstr">Your app can have many activities, each of which has different details to send to Handoff. Identify what information you’ll need to recreate the activity on the receiving device. Be careful to only include the transient details of the user activity, and not any information that the app needs to store permanently. For example, if a user is working on a document, the activity should indicate the document—and possibly what part of the document—the user is editing. Don’t include the document itself as part of the activity, since the user could launch your app without Handoff, such as by tapping or clicking its app icon. Instead, use techniques like iCloud Drive to share documents between the user’s devices.</span><!--end_enstr-->
<span class="jpstr">
あなたのアプリは、多くのアクティビティを持つことができ、そのそれぞれはHandoffに送信する異なる詳細を持ちます。アクティビティを受け手側デバイス上で回復するのにどんな情報をあなたは必要とするかを明確にしてください。ユーザアクティビティの一過性の詳細だけを含むように、そしてアプリが永続的に格納する必要があるどんな情報も含まないように、気をつけて下さい。例えば、ユーザがある書類上で作業しているならば、アクティビティはユーザが編集している書類 — そしてことによると書類の何かの部分 — を指し示すべきです。書類それ自体をアクティビティの一部として含まないでください、ユーザはあなたのアプリをHandoffなしで起動できるので、たとえばそのアプリアイコンをタップやクリックすることによって。代わりに、iCloud Driveのようなテクニックを使ってユーザのもつデバイス間で書類を共有してください。
</span><!--end_jpstr-->
</p></div><h3 id="3112026"><span class="enstr">Create User Activity Objects</span><!--end_enstr-->
<span class="jpstr">
ユーザアクティビティオブジェクトを作成する
</span><!--end_jpstr-->
	</h3><div><p><span class="enstr">At runtime, create instances of <code class="code-voice"><span>NSUser<wbr/>Activity</span></code> for each of your app’s activities. Use the same identifier strings that you used in the <code class="code-voice"><span>Info<wbr/>.plist</span></code> to indicate which activities your app can continue.</span><!--end_enstr-->
<span class="jpstr">
実行時に、<code class="code-voice"><span>NSUser<wbr/>Activity</span></code>のインスタンスをあなたのアプリのもつアクティビティのそれぞれに対して作成してください。あなたが<code class="code-voice"><span>Info<wbr/>.plist</span></code>で使ったのと同じ識別子文字列を使って、あなたのアプリが継続できるのはどのアクティビティかを指し示してください。
</span><!--end_jpstr-->
</p><p><span class="enstr">The <code class="code-voice"><span>NSUser<wbr/>Activity</span></code> class contains a <a class="symbol-name" href="../../../documentation/foundation/nsuseractivity/1411706-userinfo.html"><code><span>user<wbr/>Info</span></code></a> dictionary that you use to recreate the activity on other devices. The activity type also has a <a class="symbol-name" href="../../../documentation/foundation/nsuseractivity/1417256-requireduserinfokeys.html"><code><span>required<wbr/>User<wbr/>Info<wbr/>Keys</span></code></a> property that you populate with the minimal set of dictionary keys to make the activity restorable. The activity also contains a user-readable <a class="symbol-name" href="../../../documentation/foundation/nsuseractivity/1413375-title.html"><code><span>title</span></code></a> property that you should set. If the activity also supports search, the system displays this title in the search results.</span><!--end_enstr-->
<span class="jpstr">
<code class="code-voice"><span>NSUser<wbr/>Activity</span></code>クラスは、ある<a class="symbol-name" href="../../../documentation/foundation/nsuseractivity/1411706-userinfo.html"><code><span>user<wbr/>Info</span></code></a>辞書を含みます、それはあなたがアクティビティを他のデバイス上で回復するのに使うものです。アクティビティ型はまた、ある<a class="symbol-name" href="../../../documentation/foundation/nsuseractivity/1417256-requireduserinfokeys.html"><code><span>required<wbr/>User<wbr/>Info<wbr/>Keys</span></code></a>プロパティを持ちます、それはあなたが辞書キーの最小の集合で満たすものです。アクティビティはまた、ユーザに読みやすい<a class="symbol-name" href="../../../documentation/foundation/nsuseractivity/1413375-title.html"><code><span>title</span></code></a>プロパティを含みます、それはあなたが設定するべきものです。アクティビティがまた検索をサポートするならば、システムはこのタイトルを検索結果において表示します。
</span><!--end_jpstr-->
</p><figure id="3126005"><div class="formatted-content"><div class="code-listing"><pre class="code-source" data-language="swift"><code>let activity = NSUserActivity(activityType: "com.example.myapp.create-shape")
activity?.isEligibleForHandoff = true
activity?.requiredUserInfoKeys = ["shape-type"]
activity.title = NSLocalizedString("Creating shape", comment: "Creating shape activity")
</code></pre></div></div></figure><p><span class="enstr">The <a class="symbol-name" href="https://developer.apple.com/documentation/appkit/nsresponder"><code><span>NSResponder</span></code></a> (macOS) and <a class="symbol-name" href="https://developer.apple.com/documentation/uikit/uiresponder"><code><span>UIResponder</span></code></a> (iOS) classes define a <a class="symbol-name" href="https://developer.apple.com/documentation/uikit/uiresponder/1621089-useractivity"><code><span>user<wbr/>Activity</span></code></a> property. Since <a class="symbol-name" href="https://developer.apple.com/documentation/appkit/nsviewcontroller"><code><span>NSView<wbr/>Controller</span></code></a> and <a class="symbol-name" href="https://developer.apple.com/documentation/uikit/uiviewcontroller"><code><span>UIView<wbr/>Controller</span></code></a> are subclasses of these responder types, you can set this property to represent the activity the controller is managing. Your app can share a single activity across multiple view controllers. Conversely, if a single view controller supports multiple activities, you can reassign the view controller’s <code class="code-voice"><span>user<wbr/>Activity</span></code> to different <code class="code-voice"><span>NSUser<wbr/>Activity</span></code> instances as needed.</span><!--end_enstr-->
<span class="jpstr">
<a class="symbol-name" href="https://developer.apple.com/documentation/appkit/nsresponder"><code><span>NSResponder</span></code></a>（macOS）および<a class="symbol-name" href="https://developer.apple.com/documentation/uikit/uiresponder"><code><span>UIResponder</span></code></a>（iOS）クラスは、<a class="symbol-name" href="https://developer.apple.com/documentation/uikit/uiresponder/1621089-useractivity"><code><span>user<wbr/>Activity</span></code></a>プロパティを定義します。<a class="symbol-name" href="https://developer.apple.com/documentation/appkit/nsviewcontroller"><code><span>NSView<wbr/>Controller</span></code></a>と<a class="symbol-name" href="https://developer.apple.com/documentation/uikit/uiviewcontroller"><code><span>UIView<wbr/>Controller</span></code></a>がこれらレスポンダ型のサブクラスであることから、あなたはこのプロパティを設定して、コントローラが管理しているアクティビティを表せます。あなたのアプリは、複数のビューコントローラにまたがって単一のアクティビティを共有できます。逆に、単一のビューコントローラが複数のアクティビティをサポートするならば、あなたはビューコントローラのもつ<code class="code-voice"><span>user<wbr/>Activity</span></code>を異なる<code class="code-voice"><span>NSUser<wbr/>Activity</span></code>インスタンスに再割り当てできます、必要に応じて。
</span><!--end_jpstr-->
</p></div><h3 id="3113136"><span class="enstr">Update Activities While the User is Active</span><!--end_enstr-->
<span class="jpstr">
ユーザが活動的である間にアクティビティを更新する
</span><!--end_jpstr-->
</h3><div><p><span class="enstr">As your user interacts with your app, update the user activity to save the state of their interaction. If you have set the <code class="code-voice"><span>user<wbr/>Activity</span></code> property of a responder, the system automatically calls its <a class="symbol-name" href="https://developer.apple.com/documentation/uikit/uiresponder/1621095-updateuseractivitystate"><code><span>update<wbr/>User<wbr/>Activity<wbr/>State(_:)</span></code></a> (iOS) or <a class="symbol-name" href="https://developer.apple.com/documentation/appkit/nsresponder/1534884-updateuseractivitystate"><code><span>update<wbr/>User<wbr/>Activity<wbr/>State(_:)</span></code></a> (macOS) method. Override this method to write new values to the activity’s <a class="symbol-name" href="../../../documentation/foundation/nsuseractivity/1411706-userinfo.html"><code><span>user<wbr/>Info</span></code></a> dictionary.</span><!--end_enstr-->
<span class="jpstr">
あなたのユーザがあなたのアプリと相互作用するにつれて、ユーザアクティビティを更新してそれら相互作用の状態を保存してください。あなたがあるレスポンダの<code class="code-voice"><span>user<wbr/>Activity</span></code>プロパティを設定しおわるならば、システムは自動的にそれの<a class="symbol-name" href="https://developer.apple.com/documentation/uikit/uiresponder/1621095-updateuseractivitystate"><code><span>update<wbr/>User<wbr/>Activity<wbr/>State(_:)</span></code></a>（iOS）または<a class="symbol-name" href="https://developer.apple.com/documentation/appkit/nsresponder/1534884-updateuseractivitystate"><code><span>update<wbr/>User<wbr/>Activity<wbr/>State(_:)</span></code></a>（macOS）メソッドを呼び出します。このメソッドをオーバーライドすることで新しい値をアクティビティのもつ<a class="symbol-name" href="../../../documentation/foundation/nsuseractivity/1411706-userinfo.html"><code><span>user<wbr/>Info</span></code></a>辞書に書き出してください。
</span><!--end_jpstr-->
</p><p><span class="enstr">The keys and values you use in <code class="code-voice"><span>user<wbr/>Info</span></code> must be of the types <a class="symbol-name" href="../../../documentation/foundation/nsarray.html"><code><span>NSArray</span></code></a>, <a class="symbol-name" href="../../../documentation/foundation/nsdata.html"><code><span>NSData</span></code></a>, <a class="symbol-name" href="../../../documentation/foundation/nsdate.html"><code><span>NSDate</span></code></a>, <a class="symbol-name" href="../../../documentation/foundation/nsdictionary.html"><code><span>NSDictionary</span></code></a>, <a class="symbol-name" href="../../../documentation/foundation/nsnull.html"><code><span>NSNull</span></code></a>, <a class="symbol-name" href="../../../documentation/foundation/nsnumber.html"><code><span>NSNumber</span></code></a>, <a class="symbol-name" href="../../../documentation/foundation/nsset.html"><code><span>NSSet</span></code></a>, <a class="symbol-name" href="../../../documentation/foundation/nsstring.html"><code><span>NSString</span></code></a>, or <a class="symbol-name" href="../../../documentation/foundation/nsurl.html"><code><span>NSURL</span></code></a> (or their Swift-bridged equivalents). Create a dictionary with any data needed to recreate the activity on the other device, then call <a class="symbol-name" href="../../../documentation/foundation/nsuseractivity/1410066-adduserinfoentries.html"><code><span>add<wbr/>User<wbr/>Info<wbr/>Entries(from:)</span></code></a> to update the activity. It’s also a good idea to provide a key-value pair that versions the dictionary itself. That way, you can change the activity’s dictionary representation later and be able to detect incompatible versions.</span><!--end_enstr-->
<span class="jpstr">
あなたが<code class="code-voice"><span>user<wbr/>Info</span></code>において使うキーと値は、型<a class="symbol-name" href="../../../documentation/foundation/nsarray.html"><code><span>NSArray</span></code></a>、<a class="symbol-name" href="../../../documentation/foundation/nsdata.html"><code><span>NSData</span></code></a>、<a class="symbol-name" href="../../../documentation/foundation/nsdate.html"><code><span>NSDate</span></code></a>、<a class="symbol-name" href="../../../documentation/foundation/nsdictionary.html"><code><span>NSDictionary</span></code></a>、<a class="symbol-name" href="../../../documentation/foundation/nsnull.html"><code><span>NSNull</span></code></a>、<a class="symbol-name" href="../../../documentation/foundation/nsnumber.html"><code><span>NSNumber</span></code></a>、<a class="symbol-name" href="../../../documentation/foundation/nsset.html"><code><span>NSSet</span></code></a>、<a class="symbol-name" href="../../../documentation/foundation/nsstring.html"><code><span>NSString</span></code></a>、または<a class="symbol-name" href="../../../documentation/foundation/nsurl.html"><code><span>NSURL</span></code></a>のものでなければなりません（またはそれらのSwiftブリッジされた相当物）。アクティビティを他のデバイス上で回復するために必要とされる何らかのデータでひとつの辞書を作成してください、それから<a class="symbol-name" href="../../../documentation/foundation/nsuseractivity/1410066-adduserinfoentries.html"><code><span>add<wbr/>User<wbr/>Info<wbr/>Entries(from:)</span></code></a>を呼び出すことでアクティビティを更新してください。そのバージョンのキー値ペアひとつで辞書それ自身を提供することもまたよい考えです。そのやり方で、あなたはアクティビティのもつ辞書表現を後で変更できます、そして互換性のないバージョンを検知できます。
</span><!--end_jpstr-->
</p><figure id="3126004"><div class="formatted-content"><div class="code-listing"><pre class="code-source" data-language="swift"><code>override func updateUserActivityState(_ activity: NSUserActivity) {
    if activity.activityType == "com.example.myapp.create-shape" {
        let updateDict:  [AnyHashable : Any] = [
            "shape-type" : currentShapeType(),
            "activity-version" : 1
        ]
        activity.addUserInfoEntries(from: updateDict)
    }
}
</code></pre></div></div></figure><p><span class="enstr">Transfer as small a payload in the <code class="code-voice"><span>user<wbr/>Info</span></code> as possible, keeping the total size under 3KB. If you must transfer more data than this, use continuation streams to connect the two devices directly (see <a href="../../../documentation/foundation/nsuseractivity.html#3174613">Working with Continuation Streams</a>).</span><!--end_enstr-->
<span class="jpstr">
可能な限り小さいペイロードを<code class="code-voice"><span>user<wbr/>Info</span></code>において転送して、全体の大きさを３KB未満に保ってください。あなたがこれより多くのデータを転送しなければならないならば、継続ストリームを使って２つのデバイスを直接に接続してください（<a href="../../../documentation/foundation/nsuseractivity.html#3174613">継続ストリームを扱う</a>を見てください）。
</span><!--end_jpstr-->
</p></div><h3 id="3112028"><span class="enstr">Receive User Activities in the Application Delegate</span><!--end_enstr-->
<span class="jpstr">
ユーザアクティビティをアプリケーション委任先において受け取る
</span><!--end_jpstr-->
</h3><div><p><span class="enstr">When the user launches your app from Handoff on another device, the app receives callbacks to methods in its application delegate. You implement these methods to accept the activity and restore its state in your app.</span><!--end_enstr-->
<span class="jpstr">
別のデバイス上でユーザがあなたのアプリをHandoffから起動する場合、アプリはそれのアプリケーション委任先におけるメソッドそれらへのコールバックを受け取ります。あなたは、これらメソッドを実装することで、アクティビティを受け入れて、それの状態をあなたのアプリにおいて回復します。
</span><!--end_jpstr-->
</p><p><span class="enstr">After launching your app, Handoff calls the <a class="symbol-name" href="https://developer.apple.com/documentation/uikit/uiapplicationdelegate/1622919-application"><code><span>application(_:<wbr/>will<wbr/>Continue<wbr/>User<wbr/>Activity<wbr/>With<wbr/>Type:)</span></code></a> method of <a class="symbol-name" href="https://developer.apple.com/documentation/uikit/uiapplicationdelegate"><code><span>UIApplication<wbr/>Delegate</span></code></a> (iOS), or <a class="symbol-name" href="https://developer.apple.com/documentation/appkit/nsapplicationdelegate/1428364-application"><code><span>application(_:<wbr/>will<wbr/>Continue<wbr/>User<wbr/>Activity<wbr/>With<wbr/>Type:)</span></code></a> method of <a class="symbol-name" href="https://developer.apple.com/documentation/appkit/nsapplicationdelegate"><code><span>NSApplication<wbr/>Delegate</span></code></a> (macOS). Implement this method by updating your UI to indicate to your user that it is receiving the activity from the other device. If Handoff fails for some reason, the system calls <a class="symbol-name" href="https://developer.apple.com/documentation/uikit/uiapplicationdelegate/1622927-application"><code><span>application(_:<wbr/>did<wbr/>Fail<wbr/>To<wbr/>Continue<wbr/>User<wbr/>Activity<wbr/>With<wbr/>Type:<wbr/>error:)</span></code></a> (iOS), or <a class="symbol-name" href="https://developer.apple.com/documentation/appkit/nsapplicationdelegate/1428613-application"><code><span>application(_:<wbr/>did<wbr/>Fail<wbr/>To<wbr/>Continue<wbr/>User<wbr/>Activity<wbr/>With<wbr/>Type:<wbr/>error:)</span></code></a> (macOS).</span><!--end_enstr-->
<span class="jpstr">
あなたのアプリを起動する後に、Handoffは<a class="symbol-name" href="https://developer.apple.com/documentation/uikit/uiapplicationdelegate"><code><span>UIApplication<wbr/>Delegate</span></code></a>（iOS）の<a class="symbol-name" href="https://developer.apple.com/documentation/uikit/uiapplicationdelegate/1622919-application"><code><span>application(_:<wbr/>will<wbr/>Continue<wbr/>User<wbr/>Activity<wbr/>With<wbr/>Type:)</span></code></a>メソッド、または<a class="symbol-name" href="https://developer.apple.com/documentation/appkit/nsapplicationdelegate"><code><span>NSApplication<wbr/>Delegate</span></code></a>（macOS）の<a class="symbol-name" href="https://developer.apple.com/documentation/appkit/nsapplicationdelegate/1428364-application"><code><span>application(_:<wbr/>will<wbr/>Continue<wbr/>User<wbr/>Activity<wbr/>With<wbr/>Type:)</span></code></a>メソッドを呼び出します。このメソッドを、あなたのUIを更新することによってあなたのユーザにそれがアクティビティを他のデバイスから受け取っていることを指し示すように実装してください。Handoffが何らかの理由のために失敗するならば、システムは<a class="symbol-name" href="https://developer.apple.com/documentation/uikit/uiapplicationdelegate/1622927-application"><code><span>application(_:<wbr/>did<wbr/>Fail<wbr/>To<wbr/>Continue<wbr/>User<wbr/>Activity<wbr/>With<wbr/>Type:<wbr/>error:)</span></code></a>（iOS）、または<a class="symbol-name" href="https://developer.apple.com/documentation/appkit/nsapplicationdelegate/1428613-application"><code><span>application(_:<wbr/>did<wbr/>Fail<wbr/>To<wbr/>Continue<wbr/>User<wbr/>Activity<wbr/>With<wbr/>Type:<wbr/>error:)</span></code></a>（macOS）を呼び出します。
</span><!--end_jpstr-->
</p><aside class="aside aside-note" role="note"><p class="aside-name"><span class="enstr">Note</span><!--end_enstr-->
<span class="jpstr">
注意
</span><!--end_jpstr-->
</p><p><span class="enstr">While watchOS can create <code class="code-voice"><span>NSUser<wbr/>Activity</span></code> objects and send them to other devices, Handoff cannot launch watchOS apps.</span><!--end_enstr-->
<span class="jpstr">
watchOSが<code class="code-voice"><span>NSUser<wbr/>Activity</span></code>オブジェクトを作成してそれらを他のデバイスに送信できる一方で、HandoffはwatchOSアプリを起動できません。
</span><!--end_jpstr-->
</p></aside><p><span class="enstr">Handoff provides the activity to your app in the <a class="symbol-name" href="https://developer.apple.com/documentation/uikit/uiapplicationdelegate/1623072-application"><code><span>application(_:<wbr/>continue:<wbr/>restoration<wbr/>Handler:)</span></code></a> (iOS), or <a class="symbol-name" href="https://developer.apple.com/documentation/appkit/nsapplicationdelegate/1428471-application"><code><span>application(_:<wbr/>continue:<wbr/>restoration<wbr/>Handler:)</span></code></a> (macOS) delegate method. Implement the method by creating an array of view controllers that need to update for the activity, and provide this array to the completion handler. Return <a class="symbol-name" href="../../../documentation/swift/true.html"><code><span>true</span></code></a> if your implementation successfully handled the activity, or <a class="symbol-name" href="../../../documentation/swift/false.html"><code><span>false</span></code></a> if it did not. The following example shows an iOS app delegate finding its top view controller and providing it to the completion handler.</span><!--end_enstr-->
<span class="jpstr">
Handoffは、アクティビティをあなたのアプリに対して<a class="symbol-name" href="https://developer.apple.com/documentation/uikit/uiapplicationdelegate/1623072-application"><code><span>application(_:<wbr/>continue:<wbr/>restoration<wbr/>Handler:)</span></code></a>（iOS）、または<a class="symbol-name" href="https://developer.apple.com/documentation/appkit/nsapplicationdelegate/1428471-application"><code><span>application(_:<wbr/>continue:<wbr/>restoration<wbr/>Handler:)</span></code></a>（macOS）の委任先メソッドにおいて提供します。メソッドを、アクティビティに対する更新に必要であるビューコントローラからなるある配列を作成することによって実装してください、そしてこの配列を完了ハンドラに提供してください。<a class="symbol-name" href="../../../documentation/swift/true.html"><code><span>true</span></code></a>を返してください、もしあなたの実装がうまくアクティビティを取り扱ったならば、または<a class="symbol-name" href="../../../documentation/swift/false.html"><code><span>false</span></code></a>をもしそれがそうしなかったならば。以下の例は、iOSアプリ委任先がそれのトップビューコントローラを見つけ出してそれを完了ハンドラに提供しているのを示します。
</span><!--end_jpstr-->
</p><figure id="3126088"><div class="formatted-content"><div class="code-listing"><pre class="code-source" data-language="swift"><code>func application(_ application: UIApplication, continue userActivity: NSUserActivity,
                 restorationHandler: @escaping ([UIUserActivityRestoring]?) -&gt; Void) -&gt; Bool {
    guard let topNav = application.keyWindow?.rootViewController as? UINavigationController,
        let shapesVC = topNav.viewControllers.first as? MyShapesViewController else {
            return false
    }
    restorationHandler([shapesVC])
    return true
}

</code></pre></div></div></figure><p></p></div><h3 id="3113134"><span class="enstr">Continue the Activity in Your App</span><!--end_enstr-->
<span class="jpstr">
アクティビティをあなたにアプリにおいて継続する
</span><!--end_jpstr-->
</h3><div><p><span class="enstr">Each view controller provided to the completion handler in the previous step receives a call to its <a class="symbol-name" href="https://developer.apple.com/documentation/uikit/uiresponder/1621111-restoreuseractivitystate"><code><span>restore<wbr/>User<wbr/>Activity<wbr/>State(_:)</span></code></a> (iOS), or <a class="symbol-name" href="https://developer.apple.com/documentation/appkit/nsuseractivityrestoring/3022485-restoreuseractivitystate"><code><span>restore<wbr/>User<wbr/>Activity<wbr/>State(_:)</span></code></a> (macOS) method. Use this method to update the view controller’s state to match the state of the originating device. If you have several activity types, use the <a class="symbol-name" href="../../../documentation/foundation/nsuseractivity/1409611-activitytype.html"><code><span>activity<wbr/>Type</span></code></a> to determine which activity you are handling. Then, get the values from the activity’s <code class="code-voice"><span>user<wbr/>Info</span></code> dictionary to update the view controller’s state.</span><!--end_enstr-->
<span class="jpstr">
前の段階において完了ハンドラに提供された各ビューコントローラは、それの<a class="symbol-name" href="https://developer.apple.com/documentation/uikit/uiresponder/1621111-restoreuseractivitystate"><code><span>restore<wbr/>User<wbr/>Activity<wbr/>State(_:)</span></code></a>（iOS）、または<a class="symbol-name" href="https://developer.apple.com/documentation/appkit/nsuseractivityrestoring/3022485-restoreuseractivitystate"><code><span>restore<wbr/>User<wbr/>Activity<wbr/>State(_:)</span></code></a>（macOS）メソッドへのある呼び出しを受け取ります。このメソッドを使って、ビューコントローラのもつ状態を更新して、元のデバイスの状態と合致するようにしてください。あなたがいくつかのアクティビティ型を持つならば、<a class="symbol-name" href="../../../documentation/foundation/nsuseractivity/1409611-activitytype.html"><code><span>activity<wbr/>Type</span></code></a>を使ってどのアクティビディをあなたは取り扱っているか決定してください。それから、そのアクティビティのもつ<code class="code-voice"><span>user<wbr/>Info</span></code>辞書からいくつかの値を取得することで、ビューコントローラのもつ状態を更新してください。
</span><!--end_jpstr-->
</p><figure id="3126280"><div class="formatted-content"><div class="code-listing"><pre class="code-source" data-language="swift"><code>override func restoreUserActivityState(_ userActivity: NSUserActivity) {    super.restoreUserActivityState(userActivity)
    guard userActivity.activityType == "com.example.myapp.create-shape",
        let type = userActivity.userInfo?["shape-type"] as?String,
        let version = userActivity.userInfo?["activity-version"] as?Int,
        version &gt;= 1 else {
            return
    }
    
    createShape(type: type)
}
</code></pre></div></div></figure><p><span class="enstr">For URLs transferred in the <code class="code-voice"><span>user<wbr/>Info</span></code> dictionary, you must first call <a class="symbol-name" href="../../../documentation/foundation/url/1779698-startaccessingsecurityscopedreso.html"><code><span>start<wbr/>Accessing<wbr/>Security<wbr/>Scoped<wbr/>Resource()</span></code></a> and it must return <a class="symbol-name" href="../../../documentation/swift/true.html"><code><span>true</span></code></a> before you can access the URL. Call <a class="symbol-name" href="../../../documentation/foundation/url/1780153-stopaccessingsecurityscopedresou.html"><code><span>stop<wbr/>Accessing<wbr/>Security<wbr/>Scoped<wbr/>Resource()</span></code></a> when you finish using the URL. Also be aware that the system modifies <code class="code-voice"><span>file:</span></code> URLs pointing to iCloud documents, so that they point to the same document on the receiving device.</span><!--end_enstr-->
<span class="jpstr">
<code class="code-voice"><span>user<wbr/>Info</span></code>辞書において転送されたURLに対して、あなたは最初に<a class="symbol-name" href="../../../documentation/foundation/url/1779698-startaccessingsecurityscopedreso.html"><code><span>start<wbr/>Accessing<wbr/>Security<wbr/>Scoped<wbr/>Resource()</span></code></a>を呼び出さなければなりません、そしてそれが<a class="symbol-name" href="../../../documentation/swift/true.html"><code><span>true</span></code></a>を返さなければなりません、あなたがURLにアクセスするに先立って。<a class="symbol-name" href="../../../documentation/foundation/url/1780153-stopaccessingsecurityscopedresou.html"><code><span>stop<wbr/>Accessing<wbr/>Security<wbr/>Scoped<wbr/>Resource()</span></code></a>をあなたがURLの使用を終了する時は呼び出してください。またシステムはiCloud書類を指している<code class="code-voice"><span>file:</span></code> URLそれらを修正することに気をつけてください、それでそれらは同じ書類をその受け取っているデバイス上で指します。
</span><!--end_jpstr-->
</p></div></div></section></div></div><section id="see-also" class="contenttable section alt-light-container row"><div class="alt-light"><div class="section-content"><h2 class="contenttable-title"><span class="enstr">See Also</span><!--end_enstr-->
<span class="jpstr">
参照
</span><!--end_jpstr-->
</h2><section id="2877763" class="contenttable-section"><div class="contenttable-container row"><div class="contenttable-section-title-container column large-3 medium-3 small-12"><h3 class="contenttable-section-title"><span class="enstr">Activity Sharing</span><!--end_enstr-->
<span class="jpstr">
アクティビティを共有する
</span><!--end_jpstr-->
</h3></div><div class="contenttable-section-content column large-9 medium-9 small-12"><div class="task-topics"><div class="task-topic"><div class="task-topic-info"><a class="has-adjacent-element symbol-name" href="../../../documentation/foundation/task_management/increasing_app_usage_with_suggestions_based_on_user_activities.html"><svg xmlns="http://www.w3.org/2000/svg" height="15" viewBox="0 0 15 15" class="svg-icon symbol-name-icon" aria-hidden="true"><title>Sample Code</title><g class="svg-icon-small" fill-rule="evenodd"><path d="M9 15L9 14 11.0104712 14C11.5759162 14 12.1832461 13.86 12.1832461 12.14L12.1832461 10.28C12.1529524 9.27545906 12.5278004 8.29817424 13.2303665 7.55L13.3246073 7.47C12.5372999 6.72356427 12.1089306 5.6990224 12.1413613 4.64L12.1413613 3.42C12.1413613 3 12.1413613 1 11.0104712 1L9 1 9 0 11.0104712 0C12.3926702 0 13.1884817 1.28 13.1884817 3.42L13.1884817 4.64C13.1884817 6 13.8691099 6.95 14.4764398 6.95L15 6.95 15 7.95 14.4764398 7.95C14.2508552 7.96082278 14.0394061 8.05818375 13.8900524 8.22 13.4104115 8.78359074 13.1611361 9.49421163 13.1884817 10.22L13.1884817 12.09C13.1884817 14 12.4764398 15 11.0104712 15L9 15zM6 15L4.28 15C2.87 15 2 13.85 2 12L2 10.13C2 8.46 1.66 8 .5 8L0 8 0 7 .5 7C1.61 6.95 2 6.3 2 4.49L2 3.27C2 1.32 2.92 0 4.28 0L6 0 6 1 4.28 1C3.4 1 3 2.14 3 3.27L3 4.49C3.11371534 5.55342654 2.78458756 6.61676246 2.09 7.43 2.79401717 8.14117553 3.12990379 9.13776222 3 10.13L3 12C3 12.75 3.17 14 4.29 14L6 14 6 15z"></path></g></svg><span><span class="enstr">Increasing App Usage with Suggestions Based on User Activities</span><!--end_enstr-->
<span class="jpstr">
ユーザアクションに基づく提案でアプリ利用を拡大する
</span><!--end_jpstr-->
</span></a><div class="task-topic-abstract task-topic-data abstract formatted-content"><div><p><span class="enstr">Provide a continuous user experience by capturing information from your app and displaying this information as proactive suggestions across the system.</span><!--end_enstr-->
<span class="jpstr">
情報をあなたのアプリからキャプチャして、この情報を積極的提案としてシステムの至る所で表示することによって、途切れのないユーザ体験を提供してください。
</span><!--end_jpstr-->
</p></div></div></div></div><div class="task-topic"><div class="task-topic-info"><a class="has-adjacent-element symbol-name" href="../../../documentation/foundation/task_management/continuing_user_activities_with_handoff.html"><svg xmlns="http://www.w3.org/2000/svg" height="15" viewBox="0 0 15 15" class="svg-icon symbol-name-icon" aria-hidden="true"><title>Sample Code</title><g class="svg-icon-small" fill-rule="evenodd"><path d="M9 15L9 14 11.0104712 14C11.5759162 14 12.1832461 13.86 12.1832461 12.14L12.1832461 10.28C12.1529524 9.27545906 12.5278004 8.29817424 13.2303665 7.55L13.3246073 7.47C12.5372999 6.72356427 12.1089306 5.6990224 12.1413613 4.64L12.1413613 3.42C12.1413613 3 12.1413613 1 11.0104712 1L9 1 9 0 11.0104712 0C12.3926702 0 13.1884817 1.28 13.1884817 3.42L13.1884817 4.64C13.1884817 6 13.8691099 6.95 14.4764398 6.95L15 6.95 15 7.95 14.4764398 7.95C14.2508552 7.96082278 14.0394061 8.05818375 13.8900524 8.22 13.4104115 8.78359074 13.1611361 9.49421163 13.1884817 10.22L13.1884817 12.09C13.1884817 14 12.4764398 15 11.0104712 15L9 15zM6 15L4.28 15C2.87 15 2 13.85 2 12L2 10.13C2 8.46 1.66 8 .5 8L0 8 0 7 .5 7C1.61 6.95 2 6.3 2 4.49L2 3.27C2 1.32 2.92 0 4.28 0L6 0 6 1 4.28 1C3.4 1 3 2.14 3 3.27L3 4.49C3.11371534 5.55342654 2.78458756 6.61676246 2.09 7.43 2.79401717 8.14117553 3.12990379 9.13776222 3 10.13L3 12C3 12.75 3.17 14 4.29 14L6 14 6 15z"></path></g></svg><span><span class="enstr">Continuing User Activities with Handoff</span><!--end_enstr-->
<span class="jpstr">
ユーザアクティビティをHandoffで継続する
</span><!--end_jpstr-->
</span></a><div class="task-topic-abstract task-topic-data abstract formatted-content"><div><p><span class="enstr">Define and manage which of your app’s activities can be continued between devices.</span><!--end_enstr-->
<span class="jpstr">
あなたのアプリのもつアクティビティのどれがデバイス間で継続されることが可能か定義および管理します。
</span><!--end_jpstr-->
</p></div></div></div></div><div class="task-topic"><div class="task-topic-info"><a class="has-adjacent-element symbol-name symbol-name-decorated" href="../../../documentation/foundation/nsuseractivity.html"><code class="display-name"><span class="decorator">class </span><span class="identifier">NSUser<wbr/>Activity</span></code></a><div class="task-topic-abstract task-topic-data abstract formatted-content"><div><p><span class="enstr">A representation of the state of your app at a moment in time.</span><!--end_enstr-->
<span class="jpstr">
現時点でのあなたのアプリの状態の表現。
</span><!--end_jpstr-->
</p></div></div></div></div><div class="task-topic"><div class="task-topic-info"><a class="has-adjacent-element symbol-name symbol-name-decorated" href="../../../documentation/foundation/nsuseractivitydelegate.html"><code class="display-name"><span class="decorator">protocol </span><span class="identifier">NSUser<wbr/>Activity<wbr/>Delegate</span></code></a><div class="task-topic-abstract task-topic-data abstract formatted-content"><div><p><span class="enstr">The interface through which a user activity instance notifies its delegate of updates.</span><!--end_enstr-->
<span class="jpstr">
それを通してユーザ活動インスタンスがそれの更新の委任先を通知するインターフェイス。
</span><!--end_jpstr-->
</p></div></div></div></div></div></div></div></section></div></div></section></main><section id="globalfooter-wrapper"><footer id="globalfooter" role="contentinfo">
        <nav class="footer-breadory">
          <a href="/" class="home breadcrumbs-home"><span aria-hidden="true"></span><span class="breadcrumbs-home-label">Developer</span></a>
          <section class="breadcrumbs">
            <ol class="breadcrumbs-list">
              <li><a href=/documentation>Documentation</a></li>
            </ol>
          </section>
          <div id="directorynav" class="directorynav">
            <div id="dn-cola" class="column">
              <h3><a href="/discover/">Discover</a></h3>
              <ul>
                <li><a href="/macos/">macOS</a></li>
                <li><a href="/ios/">iOS</a></li>
                <li><a href="/watchos/">watchOS</a></li>
                <li><a href="/tvos/">tvOS</a></li>
                <li><a href="/safari/">Safari and Web</a></li>
                <li><a href="/games/">Games</a></li>
                <li><a href="/business/">Business</a></li>
                <li><a href="/education/">Education</a></li>
                <li><a href="/wwdc/">WWDC</a></li>
              </ul>
            </div>
            <div id="dn-colb" class="column">
              <h3><a href="/design/">Design</a></h3>
              <ul>
                <li><a href="/design/human-interface-guidelines/">Human Interface Guidelines</a></li>
                <li><a href="/design/resources/"><span class="enstr">Resources</span><!--end_enstr-->
<span class="jpstr">
リソース
</span><!--end_jpstr-->
</a></li>
                <li><a href="/videos/design/">Videos</a></li>
                <li><a href="/design/awards/">Apple Design Awards</a></li>
                <li><a href="/accessibility/">Accessibility</a></li>
                <li><a href="/internationalization/"><span class="enstr">Internationalization</span><!--end_enstr-->
<span class="jpstr">
国際化
</span><!--end_jpstr-->
</a></li>
                <li><a href="/accessories/">Accessories</a></li>
              </ul>
            </div>
            <div id="dn-colc" class="column">
              <h3><a href="/develop/">Develop</a></h3>
              <ul>
                <li><a href="/xcode/">Xcode</a></li>
                <li><a href="/swift/">Swift</a></li>
                <li><a href="/swift-playgrounds/">Swift Playgrounds</a></li>
                <li><a href="/testflight/">TestFlight</a></li>
                <li><a href="https://developer.apple.com/documentation/">Documentation</a></li>
                <li><a href="/videos/">Videos</a></li>
                <li><a href="/download/">Downloads</a></li>
              </ul>
            </div>
            <div id="dn-cold" class="column">
              <h3><a href="/distribute/">Distribute</a></h3>
              <ul>
                <li><a href="/programs/">Developer Program</a></li>
                <li><a href="/app-store/">App Store</a></li>
                <li><a href="/app-store/review/">App Review</a></li>
                <li><a href="/macos/distribution/">Mac Software</a></li>
                <li><a href="/business/distribute/">Apps for Business</a></li>
                <li><a href="/safari/extensions/">Safari Extensions</a></li>
                <li><a href="/app-store/marketing/guidelines/">Marketing Resources</a></li>
                <li><a href="/softwarelicensing/">Trademark Licensing</a></li>
              </ul>
            </div>
            <div id="dn-cole" class="column">
              <h3><a href="/support/">Support</a></h3>
              <ul>
                <li><a href="https://forums.developer.apple.com">Developer Forums</a></li>
                <li><a href="/bug-reporting/">Bug Reporting</a></li>
                <li><a href="/terms/">License Agreements</a></li>
                <li><a href="/system-status/">System Status</a></li>
                <li><a href="/contact/">Contact Us</a></li>
              </ul>
              <h3><a href="/account/">Account</a></h3>
              <ul>
                <li><a href="/account/ios/certificate/">Certificates, IDs &amp; Profiles</a></li>
                <li><a href="https://appstoreconnect.apple.com/">App Store Connect</a></li>
              </ul>
            </div>
          </div>
        </nav>
        <div class="ac-gf-footer-legal">
          <div class="ac-gf-footer-news"> To receive the latest developer news, visit and subscribe to our <a href="/news/">News and Updates</a>.
          </div>
          <div class="ac-gf-footer-legal-copyright">Copyright © 2019 Apple Inc. All rights reserved.</div>
          <div class="ac-gf-footer-legal-links">
            <a href="https://www.apple.com/legal/internet-services/terms/site.html" class="first">Terms of Use</a>
            <a href="https://www.apple.com/privacy/privacy-policy/">Privacy Policy</a>
            <a href="/bug-reporting/">Report Bugs</a>
            <a href="/contact/submit/?subject=website-feedback">Feedback</a>
          </div>
          <div class="ac-gf-footer-language-links">
            <a href="/cn/" class="first">简体中文</a>
            <a href="/jp/">日本語</a>
            <a href="/kr/">한국어</a>
          </div>
        </div>
      </footer></section></div></div><script id="bootstrap-data" type="application/json">{"id":3112025,"title":{"content":"Implementing Handoff in Your App"},"discussion":"<div><p>Use Handoff to transfer activities the user starts on one iOS, watchOS, or macOS device to a different device. For example, a vector graphics app on macOS can send details about an in-progress editing action to the user’s iPhone so that editing can continue there.<\/p><figure id=\"3174632\"><img class=\"centered-block\" src=\"https:\/\/docs-assets.developer.apple.com\/published\/4ba77c3058\/f21c09e7-3a45-4ae1-81a3-dc1658607c9f.png\" srcSet=\"https:\/\/docs-assets.developer.apple.com\/published\/4ba77c3058\/f21c09e7-3a45-4ae1-81a3-dc1658607c9f.png 2x\" alt=\"Diagram showing an application open on a MacBook. One of three activities, &quot;create shape&quot;, is selected. This is shown as being delivered to an iPhone, which presents a user interface similar to the one on the MacBook.\" width=\"490\" height=\"auto\"\/><\/figure><p>You implement Handoff in your app by:<\/p><ul><li><p>Representing user activities as instances of <a class=\"symbol-name\" href=\"\/documentation\/foundation\/nsuseractivity\"><code><span>NSUser<wbr\/>Activity<\/span><\/code><\/a>.<\/p><\/li><li><p>Updating the activity instances as the user performs actions in your app.<\/p><\/li><li><p>Receiving activities from Handoff in your app on other devices.<\/p><\/li><\/ul><aside class=\"aside aside-important\" aria-label=\"important\"><p class=\"aside-name\">Important<\/p><p>To handoff between apps on different platforms, your apps must share the same developer Team ID. This means you must either distribute your apps through the App Store, or sign them with the same credentials.<\/p><\/aside><p><\/p><\/div><h3 id=\"3112023\">Declare Handoff Activities in Your App’s Info.plist<\/h3><div><p>Start by identifying which activities make sense to use with Handoff. Choose activities that represent what the user is doing at some point in time, like creating a shape or editing document properties. Choose a universally-unique identifier string for each of your activities, using a reverse-DNS pattern, like <code class=\"code-voice\"><span>com<wbr\/>.example<wbr\/>.app<wbr\/>.activity-name<\/span><\/code>.<\/p><p>You use your app’s <code class=\"code-voice\"><span>Info<wbr\/>.plist<\/span><\/code> file to declare that your app can receive an activity from Handoff. Create a new top-level entry in this file with the key <a href=\"https:\/\/developer.apple.com\/library\/archive\/documentation\/General\/Reference\/InfoPlistKeyReference\/Articles\/CocoaKeys.html#\/\/apple_ref\/doc\/uid\/TP40009251-SW28\">NSUserActivityTypes<\/a> and with the type <code class=\"code-voice\"><span>Array<\/span><\/code>. Each member of the array should be a <code class=\"code-voice\"><span>String<\/span><\/code> whose value is one of your activity identifiers. The following example shows the <code class=\"code-voice\"><span>Info<wbr\/>.plist<\/span><\/code> XML source of a <code class=\"code-voice\"><span>NSUser<wbr\/>Activity<wbr\/>Types<\/span><\/code> entry that declares three activities that the app can continue:<\/p><figure id=\"3112024\"><div class=\"formatted-content\"><div class=\"code-listing\"><pre class=\"code-source\" data-language=\"other\"><code>&lt;key&gt;NSUserActivityTypes&lt;\/key&gt;\n&lt;array&gt;\n    &lt;string&gt;com.example.myapp.create-shape&lt;\/string&gt;\n    &lt;string&gt;com.example.myapp.edit-shape&lt;\/string&gt;\n    &lt;string&gt;com.example.myapp.edit-document-properties&lt;\/string&gt;\n&lt;\/array&gt;\n<\/code><\/pre><\/div><\/div><\/figure><p>Your app doesn’t need to send and receive the same set of identifiers on all platforms. For example, you might have a large macOS app and a suite of smaller iOS apps. In this case, the macOS app might handle all your activities, while each iOS app would handle a subset of these activities. Also, while watchOS can send user activities, it cannot receive them, so watchOS apps don’t declare an <code class=\"code-voice\"><span>NSUser<wbr\/>Activity<wbr\/>Types<\/span><\/code> property.<\/p><p>Your app can have many activities, each of which has different details to send to Handoff. Identify what information you’ll need to recreate the activity on the receiving device. Be careful to only include the transient details of the user activity, and not any information that the app needs to store permanently. For example, if a user is working on a document, the activity should indicate the document—and possibly what part of the document—the user is editing. Don’t include the document itself as part of the activity, since the user could launch your app without Handoff, such as by tapping or clicking its app icon. Instead, use techniques like iCloud Drive to share documents between the user’s devices.<\/p><\/div><h3 id=\"3112026\">Create User Activity Objects\t<\/h3><div><p>At runtime, create instances of <code class=\"code-voice\"><span>NSUser<wbr\/>Activity<\/span><\/code> for each of your app’s activities. Use the same identifier strings that you used in the <code class=\"code-voice\"><span>Info<wbr\/>.plist<\/span><\/code> to indicate which activities your app can continue.<\/p><p>The <code class=\"code-voice\"><span>NSUser<wbr\/>Activity<\/span><\/code> class contains a <a class=\"symbol-name\" href=\"\/documentation\/foundation\/nsuseractivity\/1411706-userinfo\"><code><span>user<wbr\/>Info<\/span><\/code><\/a> dictionary that you use to recreate the activity on other devices. The activity type also has a <a class=\"symbol-name\" href=\"\/documentation\/foundation\/nsuseractivity\/1417256-requireduserinfokeys\"><code><span>required<wbr\/>User<wbr\/>Info<wbr\/>Keys<\/span><\/code><\/a> property that you populate with the minimal set of dictionary keys to make the activity restorable. The activity also contains a user-readable <a class=\"symbol-name\" href=\"\/documentation\/foundation\/nsuseractivity\/1413375-title\"><code><span>title<\/span><\/code><\/a> property that you should set. If the activity also supports search, the system displays this title in the search results.<\/p><figure id=\"3126005\"><div class=\"formatted-content\"><div class=\"code-listing\"><pre class=\"code-source\" data-language=\"swift\"><code>let activity = NSUserActivity(activityType: &quot;com.example.myapp.create-shape&quot;)\nactivity?.isEligibleForHandoff = true\nactivity?.requiredUserInfoKeys = [&quot;shape-type&quot;]\nactivity.title = NSLocalizedString(&quot;Creating shape&quot;, comment: &quot;Creating shape activity&quot;)\n<\/code><\/pre><\/div><\/div><\/figure><p>The <a class=\"symbol-name\" href=\"\/documentation\/appkit\/nsresponder\"><code><span>NSResponder<\/span><\/code><\/a> (macOS) and <a class=\"symbol-name\" href=\"\/documentation\/uikit\/uiresponder\"><code><span>UIResponder<\/span><\/code><\/a> (iOS) classes define a <a class=\"symbol-name\" href=\"\/documentation\/uikit\/uiresponder\/1621089-useractivity\"><code><span>user<wbr\/>Activity<\/span><\/code><\/a> property. Since <a class=\"symbol-name\" href=\"\/documentation\/appkit\/nsviewcontroller\"><code><span>NSView<wbr\/>Controller<\/span><\/code><\/a> and <a class=\"symbol-name\" href=\"\/documentation\/uikit\/uiviewcontroller\"><code><span>UIView<wbr\/>Controller<\/span><\/code><\/a> are subclasses of these responder types, you can set this property to represent the activity the controller is managing. Your app can share a single activity across multiple view controllers. Conversely, if a single view controller supports multiple activities, you can reassign the view controller’s <code class=\"code-voice\"><span>user<wbr\/>Activity<\/span><\/code> to different <code class=\"code-voice\"><span>NSUser<wbr\/>Activity<\/span><\/code> instances as needed.<\/p><\/div><h3 id=\"3113136\">Update Activities While the User is Active<\/h3><div><p>As your user interacts with your app, update the user activity to save the state of their interaction. If you have set the <code class=\"code-voice\"><span>user<wbr\/>Activity<\/span><\/code> property of a responder, the system automatically calls its <a class=\"symbol-name\" href=\"\/documentation\/uikit\/uiresponder\/1621095-updateuseractivitystate\"><code><span>update<wbr\/>User<wbr\/>Activity<wbr\/>State(_:)<\/span><\/code><\/a> (iOS) or <a class=\"symbol-name\" href=\"\/documentation\/appkit\/nsresponder\/1534884-updateuseractivitystate\"><code><span>update<wbr\/>User<wbr\/>Activity<wbr\/>State(_:)<\/span><\/code><\/a> (macOS) method. Override this method to write new values to the activity’s <a class=\"symbol-name\" href=\"\/documentation\/foundation\/nsuseractivity\/1411706-userinfo\"><code><span>user<wbr\/>Info<\/span><\/code><\/a> dictionary.<\/p><p>The keys and values you use in <code class=\"code-voice\"><span>user<wbr\/>Info<\/span><\/code> must be of the types <a class=\"symbol-name\" href=\"\/documentation\/foundation\/nsarray\"><code><span>NSArray<\/span><\/code><\/a>, <a class=\"symbol-name\" href=\"\/documentation\/foundation\/nsdata\"><code><span>NSData<\/span><\/code><\/a>, <a class=\"symbol-name\" href=\"\/documentation\/foundation\/nsdate\"><code><span>NSDate<\/span><\/code><\/a>, <a class=\"symbol-name\" href=\"\/documentation\/foundation\/nsdictionary\"><code><span>NSDictionary<\/span><\/code><\/a>, <a class=\"symbol-name\" href=\"\/documentation\/foundation\/nsnull\"><code><span>NSNull<\/span><\/code><\/a>, <a class=\"symbol-name\" href=\"\/documentation\/foundation\/nsnumber\"><code><span>NSNumber<\/span><\/code><\/a>, <a class=\"symbol-name\" href=\"\/documentation\/foundation\/nsset\"><code><span>NSSet<\/span><\/code><\/a>, <a class=\"symbol-name\" href=\"\/documentation\/foundation\/nsstring\"><code><span>NSString<\/span><\/code><\/a>, or <a class=\"symbol-name\" href=\"\/documentation\/foundation\/nsurl\"><code><span>NSURL<\/span><\/code><\/a> (or their Swift-bridged equivalents). Create a dictionary with any data needed to recreate the activity on the other device, then call <a class=\"symbol-name\" href=\"\/documentation\/foundation\/nsuseractivity\/1410066-adduserinfoentries\"><code><span>add<wbr\/>User<wbr\/>Info<wbr\/>Entries(from:)<\/span><\/code><\/a> to update the activity. It’s also a good idea to provide a key-value pair that versions the dictionary itself. That way, you can change the activity’s dictionary representation later and be able to detect incompatible versions.<\/p><figure id=\"3126004\"><div class=\"formatted-content\"><div class=\"code-listing\"><pre class=\"code-source\" data-language=\"swift\"><code>override func updateUserActivityState(_ activity: NSUserActivity) {\n    if activity.activityType == &quot;com.example.myapp.create-shape&quot; {\n        let updateDict:  [AnyHashable : Any] = [\n            &quot;shape-type&quot; : currentShapeType(),\n            &quot;activity-version&quot; : 1\n        ]\n        activity.addUserInfoEntries(from: updateDict)\n    }\n}\n<\/code><\/pre><\/div><\/div><\/figure><p>Transfer as small a payload in the <code class=\"code-voice\"><span>user<wbr\/>Info<\/span><\/code> as possible, keeping the total size under 3KB. If you must transfer more data than this, use continuation streams to connect the two devices directly (see <a href=\"\/documentation\/foundation\/nsuseractivity#3174613\">Working with Continuation Streams<\/a>).<\/p><\/div><h3 id=\"3112028\">Receive User Activities in the Application Delegate<\/h3><div><p>When the user launches your app from Handoff on another device, the app receives callbacks to methods in its application delegate. You implement these methods to accept the activity and restore its state in your app.<\/p><p>After launching your app, Handoff calls the <a class=\"symbol-name\" href=\"\/documentation\/uikit\/uiapplicationdelegate\/1622919-application\"><code><span>application(_:<wbr\/>will<wbr\/>Continue<wbr\/>User<wbr\/>Activity<wbr\/>With<wbr\/>Type:)<\/span><\/code><\/a> method of <a class=\"symbol-name\" href=\"\/documentation\/uikit\/uiapplicationdelegate\"><code><span>UIApplication<wbr\/>Delegate<\/span><\/code><\/a> (iOS), or <a class=\"symbol-name\" href=\"\/documentation\/appkit\/nsapplicationdelegate\/1428364-application\"><code><span>application(_:<wbr\/>will<wbr\/>Continue<wbr\/>User<wbr\/>Activity<wbr\/>With<wbr\/>Type:)<\/span><\/code><\/a> method of <a class=\"symbol-name\" href=\"\/documentation\/appkit\/nsapplicationdelegate\"><code><span>NSApplication<wbr\/>Delegate<\/span><\/code><\/a> (macOS). Implement this method by updating your UI to indicate to your user that it is receiving the activity from the other device. If Handoff fails for some reason, the system calls <a class=\"symbol-name\" href=\"\/documentation\/uikit\/uiapplicationdelegate\/1622927-application\"><code><span>application(_:<wbr\/>did<wbr\/>Fail<wbr\/>To<wbr\/>Continue<wbr\/>User<wbr\/>Activity<wbr\/>With<wbr\/>Type:<wbr\/>error:)<\/span><\/code><\/a> (iOS), or <a class=\"symbol-name\" href=\"\/documentation\/appkit\/nsapplicationdelegate\/1428613-application\"><code><span>application(_:<wbr\/>did<wbr\/>Fail<wbr\/>To<wbr\/>Continue<wbr\/>User<wbr\/>Activity<wbr\/>With<wbr\/>Type:<wbr\/>error:)<\/span><\/code><\/a> (macOS).<\/p><aside class=\"aside aside-note\" role=\"note\"><p class=\"aside-name\">Note<\/p><p>While watchOS can create <code class=\"code-voice\"><span>NSUser<wbr\/>Activity<\/span><\/code> objects and send them to other devices, Handoff cannot launch watchOS apps.<\/p><\/aside><p>Handoff provides the activity to your app in the <a class=\"symbol-name\" href=\"\/documentation\/uikit\/uiapplicationdelegate\/1623072-application\"><code><span>application(_:<wbr\/>continue:<wbr\/>restoration<wbr\/>Handler:)<\/span><\/code><\/a> (iOS), or <a class=\"symbol-name\" href=\"\/documentation\/appkit\/nsapplicationdelegate\/1428471-application\"><code><span>application(_:<wbr\/>continue:<wbr\/>restoration<wbr\/>Handler:)<\/span><\/code><\/a> (macOS) delegate method. Implement the method by creating an array of view controllers that need to update for the activity, and provide this array to the completion handler. Return <a class=\"symbol-name\" href=\"\/documentation\/swift\/true\"><code><span>true<\/span><\/code><\/a> if your implementation successfully handled the activity, or <a class=\"symbol-name\" href=\"\/documentation\/swift\/false\"><code><span>false<\/span><\/code><\/a> if it did not. The following example shows an iOS app delegate finding its top view controller and providing it to the completion handler.<\/p><figure id=\"3126088\"><div class=\"formatted-content\"><div class=\"code-listing\"><pre class=\"code-source\" data-language=\"swift\"><code>func application(_ application: UIApplication, continue userActivity: NSUserActivity,\n                 restorationHandler: @escaping ([UIUserActivityRestoring]?) -&gt; Void) -&gt; Bool {\n    guard let topNav = application.keyWindow?.rootViewController as? UINavigationController,\n        let shapesVC = topNav.viewControllers.first as? MyShapesViewController else {\n            return false\n    }\n    restorationHandler([shapesVC])\n    return true\n}\n\n<\/code><\/pre><\/div><\/div><\/figure><p><\/p><\/div><h3 id=\"3113134\">Continue the Activity in Your App<\/h3><div><p>Each view controller provided to the completion handler in the previous step receives a call to its <a class=\"symbol-name\" href=\"\/documentation\/uikit\/uiresponder\/1621111-restoreuseractivitystate\"><code><span>restore<wbr\/>User<wbr\/>Activity<wbr\/>State(_:)<\/span><\/code><\/a> (iOS), or <a class=\"symbol-name\" href=\"\/documentation\/appkit\/nsuseractivityrestoring\/3022485-restoreuseractivitystate\"><code><span>restore<wbr\/>User<wbr\/>Activity<wbr\/>State(_:)<\/span><\/code><\/a> (macOS) method. Use this method to update the view controller’s state to match the state of the originating device. If you have several activity types, use the <a class=\"symbol-name\" href=\"\/documentation\/foundation\/nsuseractivity\/1409611-activitytype\"><code><span>activity<wbr\/>Type<\/span><\/code><\/a> to determine which activity you are handling. Then, get the values from the activity’s <code class=\"code-voice\"><span>user<wbr\/>Info<\/span><\/code> dictionary to update the view controller’s state.<\/p><figure id=\"3126280\"><div class=\"formatted-content\"><div class=\"code-listing\"><pre class=\"code-source\" data-language=\"swift\"><code>override func restoreUserActivityState(_ userActivity: NSUserActivity) {    super.restoreUserActivityState(userActivity)\n    guard userActivity.activityType == &quot;com.example.myapp.create-shape&quot;,\n        let type = userActivity.userInfo?[&quot;shape-type&quot;] as? String,\n        let version = userActivity.userInfo?[&quot;activity-version&quot;] as? Int,\n        version &gt;= 1 else {\n            return\n    }\n    \n    createShape(type: type)\n}\n<\/code><\/pre><\/div><\/div><\/figure><p>For URLs transferred in the <code class=\"code-voice\"><span>user<wbr\/>Info<\/span><\/code> dictionary, you must first call <a class=\"symbol-name\" href=\"\/documentation\/foundation\/url\/1779698-startaccessingsecurityscopedreso\"><code><span>start<wbr\/>Accessing<wbr\/>Security<wbr\/>Scoped<wbr\/>Resource()<\/span><\/code><\/a> and it must return <a class=\"symbol-name\" href=\"\/documentation\/swift\/true\"><code><span>true<\/span><\/code><\/a> before you can access the URL. Call <a class=\"symbol-name\" href=\"\/documentation\/foundation\/url\/1780153-stopaccessingsecurityscopedresou\"><code><span>stop<wbr\/>Accessing<wbr\/>Security<wbr\/>Scoped<wbr\/>Resource()<\/span><\/code><\/a> when you finish using the URL. Also be aware that the system modifies <code class=\"code-voice\"><span>file:<\/span><\/code> URLs pointing to iCloud documents, so that they point to the same document on the receiving device.<\/p><\/div>","abstract":"<div><p>Create, send, and receive user activities directly.<\/p><\/div>","containingGroup":[{"id":2877763,"role":"task","paths":[],"abstract":"<div><p>Share the user’s current activity with Handoff, Spotlight, and Siri Shortcuts.<\/p><\/div>","symbols":[{"id":2962158,"role":"sampleCode","paths":["documentation\/foundation\/task_management\/increasing_app_usage_with_suggestions_based_on_user_activities"],"abstract":"<div><p>Provide a continuous user experience by capturing information from your app and displaying this information as proactive suggestions across the system.<\/p><\/div>","title":{"content":"Increasing App Usage with Suggestions Based on User Activities"}},{"id":3108512,"role":"sampleCode","paths":["documentation\/foundation\/task_management\/continuing_user_activities_with_handoff"],"abstract":"<div><p>Define and manage which of your app’s activities can be continued between devices.<\/p><\/div>","title":{"content":"Continuing User Activities with Handoff"}},{"id":3112025,"role":"article","paths":["documentation\/foundation\/task_management\/implementing_handoff_in_your_app"],"abstract":"<div><p>Create, send, and receive user activities directly.<\/p><\/div>","title":{"content":"Implementing Handoff in Your App"}},{"id":1414761,"role":"symbol","usr":"c:objc(cs)NSUserActivity","name":"NSUserActivity","domain":"swift","kind":"cl","availability":[{"platform":"iOS","introduced":"8.0"},{"platform":"macOS","introduced":"10.10"},{"platform":"Mac Catalyst","introduced":"13.0"},{"platform":"tvOS","introduced":"9.0"},{"platform":"watchOS","introduced":"2.0"}],"displayName":"<code class=\"display-name\"><span class=\"decorator\">class <\/span><span class=\"identifier\">NSUser<wbr\/>Activity<\/span><\/code>","paths":["documentation\/foundation\/nsuseractivity"],"title":{"content":"NSUserActivity"},"abstract":"<div><p>A representation of the state of your app at a moment in time.<\/p><\/div>","hasChildren":true},{"id":1417869,"role":"symbol","usr":"c:objc(pl)NSUserActivityDelegate","name":"NSUserActivityDelegate","domain":"swift","kind":"intf","availability":[{"platform":"iOS","introduced":"8.0"},{"platform":"macOS","introduced":"10.10"},{"platform":"Mac Catalyst","introduced":"13.0"},{"platform":"tvOS","introduced":"9.0"},{"platform":"watchOS","introduced":"3.0"}],"displayName":"<code class=\"display-name\"><span class=\"decorator\">protocol <\/span><span class=\"identifier\">NSUser<wbr\/>Activity<wbr\/>Delegate<\/span><\/code>","paths":["documentation\/foundation\/nsuseractivitydelegate"],"title":{"content":"NSUserActivityDelegate"},"abstract":"<div><p>The interface through which a user activity instance notifies its delegate of updates.<\/p><\/div>","hasChildren":true}],"title":{"content":"Activity Sharing"}}],"modules":[{"title":{"content":"Foundation"},"paths":["documentation\/foundation"],"importStatement":"<import xml:space=\"preserve\"><keyWord>import<\/keyWord> Foundation<\/import>","availability":[{"platform":"watchOS","introduced":"2.0"},{"platform":"Mac Catalyst","introduced":"13.0"},{"platform":"tvOS","introduced":"9.0"},{"platform":"iOS","introduced":"2.0"},{"platform":"macOS","introduced":"10.0"}]}],"role":"article","language":"swift","roleHeading":"Article","languages":["occ","swift"],"variants":{"occ":{"paths":["documentation\/foundation\/task_management\/implementing_handoff_in_your_app"]},"swift":{"paths":["documentation\/foundation\/task_management\/implementing_handoff_in_your_app"]}},"pid":424974,"paths":["documentation\/foundation\/task_management\/implementing_handoff_in_your_app"],"hierarchy":[[{"id":1613013,"role":"collection","title":{"content":"Foundation"},"paths":["documentation\/foundation"]},{"id":2877754,"role":"collectionGroup","title":{"content":"Task Management"},"paths":["documentation\/foundation\/task_management"]}]],"legalNotices":{"copyright":"Copyright &copy; 2019 Apple Inc. All rights reserved.","termsOfUse":"https:\/\/www.apple.com\/legal\/internet-services\/terms\/site.html","privacyPolicy":"https:\/\/www.apple.com\/privacy\/privacy-policy"}}</script></body></html>