<!DOCTYPE html><html lang="en" data-reactroot=""><head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8"><title>Fetching Website Data into Memory | Apple Developer Documentation</title><!-- link href="https://www.apple.com/wss/fonts?families=SF+Pro,v1|SF+Mono,v1|SF+Pro+Icons,v1" media="all" rel="stylesheet" type="text/css"/ --><meta content="width=device-width, initial-scale=1 viewport-fit=cover" name="viewport"/><meta data-pid="424974"/><link href="../../../documentation/assets/application-e5bb1544.css" media="all" rel="stylesheet" type="text/css"/><noscript><link href="../../../documentation/assets/nojs-c6be9131.css" media="all" rel="stylesheet" type="text/css"/></noscript><link rel="mask-icon" href="../../../documentation/assets/apple-logo.svg" color="#000"/><link rel="shortcut icon" href="../../../documentation/assets/favicon.ico"/><script src="../../../documentation/assets/shared-b7676010.js"></script></head><body><div id="_omniture_top">
      <script>
        var s_account="awdappledeveloper"
      </script><!-- script src="https://developer.apple.com/assets/metrics/scripts/analytics.js" -->
      </script>
      <script>
        s.pageName= AC && AC.Tracking && AC.Tracking.pageName();
        s.channel="www.documentation.developer"

        var s_code=s.t();if(s_code)document.write(s_code)
      </script>
    </div><div id="app"><div><a href="#main" id="skip-localnav" class="showonfocus hidden">Skip Navigation</a><aside id="ac-gn-segmentbar" class="ac-gn-segmentbar" lang="en-US" dir="ltr"></aside><input type="checkbox" id="ac-gn-menustate" class="ac-gn-menustate"/><nav id="ac-globalnav" class="no-js" role="navigation" aria-label="Global" data-hires="false" data-analytics-region="global nav" lang="en-US" dir="ltr" data-store-locale="us" data-store-api="/[storefront]/shop/bag/status" data-search-locale="en_US" data-search-api="/search-services/suggestions/">
      <div class="ac-gn-content">
        <ul class="ac-gn-header">
          <li class="ac-gn-item ac-gn-menuicon">
            <label class="ac-gn-menuicon-label" for="ac-gn-menustate" aria-hidden="true">
              <span class="ac-gn-menuicon-bread ac-gn-menuicon-bread-top">
                <span class="ac-gn-menuicon-bread-crust ac-gn-menuicon-bread-crust-top"></span>
              </span>
              <span class="ac-gn-menuicon-bread ac-gn-menuicon-bread-bottom">
                <span class="ac-gn-menuicon-bread-crust ac-gn-menuicon-bread-crust-bottom"></span>
              </span>
            </label>
            <a href="#ac-gn-menustate" role="button" class="ac-gn-menuanchor ac-gn-menuanchor-open" id="ac-gn-menuanchor-open">
              <span class="ac-gn-menuanchor-label">Global Nav Open Menu</span>
            </a>
            <a href="#" role="button" class="ac-gn-menuanchor ac-gn-menuanchor-close" id="ac-gn-menuanchor-close">
              <span class="ac-gn-menuanchor-label">Global Nav Close Menu</span>
            </a>
          </li>
          <li class="ac-gn-item ac-gn-apple">
            <a class="ac-gn-link ac-gn-link-apple-developer" href="/" data-analytics-title="appledeveloper home" id="ac-gn-firstfocus-small">
              <span class="ac-gn-link-text">Apple Developer</span>
            </a>
          </li>
        </ul>
        <div class="ac-gn-search-placeholder-container" role="search">
          <div class="ac-gn-search ac-gn-search-small">
            <a id="ac-gn-link-search-small" class="ac-gn-link" href="/search/" data-analytics-title="search" data-analytics-click="search" data-analytics-intrapage-link aria-label="Search Developer">
              </a><div class="ac-gn-search-placeholder-bar">
                <div class="ac-gn-search-placeholder-input">
                  <div class="ac-gn-search-placeholder-input-text" aria-hidden="true">
                    <div class="ac-gn-link-search ac-gn-search-placeholder-input-icon"></div>
                    <span class="ac-gn-search-placeholder">Search Developer</span>
                  </div>
                </div>
                <div class="ac-gn-searchview-close ac-gn-searchview-close-small ac-gn-search-placeholder-searchview-close">
                  <span class="ac-gn-searchview-close-cancel" aria-hidden="true">Cancel</span>
                </div>
              </div>
            </a>
          </div>
        </div>
        <ul class="ac-gn-list">
          <li class="ac-gn-item ac-gn-apple">
            <a class="ac-gn-link ac-gn-link-apple-developer" href="/" data-analytics-title="appledeveloper home" id="ac-gn-firstfocus">
              <span class="ac-gn-link-text">Apple Developer</span>
              </a>
          </li>
          <li class="ac-gn-item ac-gn-item-menu ac-gn-discover">
            <a class="ac-gn-link ac-gn-link-discover" href="/discover/" data-analytics-title="discover">
              <span class="ac-gn-link-text">Discover</span>
              </a>
          </li>
          <li class="ac-gn-item ac-gn-item-menu ac-gn-design">
            <a class="ac-gn-link ac-gn-link-design" href="/design/" data-analytics-title="design">
              <span class="ac-gn-link-text">Design</span>
              </a>
          </li>
          <li class="ac-gn-item ac-gn-item-menu ac-gn-develop">
            <a class="ac-gn-link ac-gn-link-develop" href="/develop/" data-analytics-title="develop">
              <span class="ac-gn-link-text">Develop</span>
              </a>
          </li>
          <li class="ac-gn-item ac-gn-item-menu ac-gn-distribute">
            <a class="ac-gn-link ac-gn-link-distribute" href="/distribute/" data-analytics-title="distribute">
              <span class="ac-gn-link-text">Distribute</span>
              </a>
          </li>
          <li class="ac-gn-item ac-gn-item-menu ac-gn-dsupport">
            <a class="ac-gn-link ac-gn-link-dsupport" href="/support/" data-analytics-title="dsupport">
              <span class="ac-gn-link-text">Support</span>
              </a>
          </li>
          <li class="ac-gn-item ac-gn-item-menu ac-gn-account">
            <a class="ac-gn-link ac-gn-link-account" href="/account/" data-analytics-title="account">
              <span class="ac-gn-link-text">Account</span>
              </a>
          </li>
          <li class="ac-gn-item ac-gn-item-menu ac-gn-search" role="search">
            <a id="ac-gn-link-search" class="ac-gn-link ac-gn-link-search" href="/search/" data-analytics-title="search" data-analytics-click="search" data-analytics-intrapage-link aria-label="Search Developer"></a>
          </li>
        </ul>
        <aside id="ac-gn-searchview" class="ac-gn-searchview" role="search" data-analytics-region="search">
          <div class="ac-gn-searchview-content">
            <div class="ac-gn-searchview-bar">
              <div class="ac-gn-searchview-bar-wrapper">
                <form id="ac-gn-searchform" class="ac-gn-searchform" action="/search/" method="get">
                  <div class="ac-gn-searchform-wrapper">
                    <input id="ac-gn-searchform-input" class="ac-gn-searchform-input" type="text" name="q" aria-label="Search Developer" placeholder="Search Developer" autocorrect="off" autocapitalize="off" autocomplete="off" spellcheck="false" role="combobox" aria-autocomplete="list" aria-expanded="true" aria-owns="quicklinks suggestions" />
                    <button id="ac-gn-searchform-submit" class="ac-gn-searchform-submit" type="submit" disabled aria-label="Submit Search"></button>
                    <button id="ac-gn-searchform-reset" class="ac-gn-searchform-reset" type="reset" disabled aria-label="Clear Search">
                        <span class="ac-gn-searchform-reset-background"></span>
                      </button>
                  </div>
                </form>
                <button id="ac-gn-searchview-close-small" class="ac-gn-searchview-close ac-gn-searchview-close-small" aria-label="Cancel Search">
                    <span class="ac-gn-searchview-close-cancel" aria-hidden="true">
                      Cancel
                    </span>
                  </button>
              </div>
            </div>
            <aside id="ac-gn-searchresults" class="ac-gn-searchresults" data-string-quicklinks="Quick Links" data-string-suggestions="Suggested Searches" data-string-noresults=""></aside>
          </div>
          <button id="ac-gn-searchview-close" class="ac-gn-searchview-close" aria-label="Cancel Search">
              <span class="ac-gn-searchview-close-wrapper">
                <span class="ac-gn-searchview-close-left"></span>
                <span class="ac-gn-searchview-close-right"></span>
              </span>
            </button>
        </aside>
          </div>
    </nav><div class="ac-gn-blur"></div><div id="ac-gn-curtain" class="ac-gn-curtain"></div><div id="ac-gn-placeholder" class="ac-nav-placeholder"></div><input type="checkbox" id="localnav-menustate" class="localnav-menustate" aria-hidden="true"/><nav id="localnav" class="localnav localnav-dark theme-dark localnav-scrim localnav-noborder" role="navigation" aria-label="API Reference" data-sticky="true"><div class="localnav-wrapper"><div class="referencenav"><div class="localnav-background"></div><div class="localnav-content"><a href="../../../index.html" class="localnav-title">Documentation</a><div class="localnav-menu"><a href="#localnav-menustate" id="localnav-menustate-open" class="localnav-menucta-anchor localnav-menucta-anchor-open"><span class="localnav-menucta-anchor-label" aria-hidden="true">Open Menu</span></a><a href="#" id="localnav-menustate-close" class="localnav-menucta-anchor localnav-menucta-anchor-close"><span class="localnav-menucta-anchor-label" aria-hidden="true">Close Menu</span></a><div class="localnav-menu-tray"><ul aria-label="Breadcrumbs" class="localnav-menu-items localnav-menu-breadcrumbs"><li class="localnav-menu-item localnav-menu-breadcrumb-item"><a class="localnav-menu-link" href="../../../documentation/foundation.html">Foundation</a></li><li class="localnav-menu-item localnav-menu-breadcrumb-item"><a class="localnav-menu-link" href="../../../documentation/foundation/url_loading_system.html"><span class="enstr">URL Loading System</span><!--end_enstr-->
<span class="jpstr">
URLローディングシステム
</span><!--end_jpstr-->
</a></li><li class="localnav-menu-item localnav-menu-breadcrumb-item"><div class="localnav-menu-breadcrumb-current-container localnav-menu-link current"><span aria-current="page" class="localnav-menu-breadcrumb-current"><span class="enstr">Fetching Website Data into Memory</span><!--end_enstr-->
<span class="jpstr">
ウェブサイトデータをメモリへと取ってくる
</span><!--end_jpstr-->
</span></div></li></ul><ul class="localnav-menu-items localnav-menu-settings" data-breadcrumbs-count="3"><li class="localnav-menu-setting language-container"><div class="language-toggle-container"><label for="language-toggle" class="language-toggle-label">Language:</label><select id="language-toggle" class="language-dropdown localnav-menu-link" style="width:auto"><option selected="" value="swift">Swift</option><option value="occ">Objective-C</option></select></div><div class="language-list-container"><span class="localnav-menu-setting-label">Language:</span><ul class="language-list"><li class="language-list-item"><span data-language="swift" aria-current="page" class="current-language">Swift</span></li><li class="language-list-item"><a href="../../../documentation/foundation/url_loading_system/fetching_website_data_into_memory?language=objc.html" class="localnav-menu-setting-link">Objective-C</a></li></ul></div></li><li class="localnav-menu-setting"><span class="localnav-menu-setting-label">API Changes:</span><span class="changes-toggle">None</span></li></ul></div><div class="localnav-actions"><div class="localnav-action localnav-action-menucta" aria-hidden="true"><label for="localnav-menustate" class="localnav-menucta"><span class="localnav-menucta-chevron"></span></label></div></div></div></div></div></div></nav><label for="localnav-menustate" id="localnav-curtain" aria-hidden="true"></label><main role="main" id="main" class="main" tabindex="0"><div class="topic-title"><span class="eyebrow">Article</span><h1 class="topic-heading"><span><span class="enstr">Fetching Website Data into Memory</span><!--end_enstr-->
<span class="jpstr">
ウェブサイトデータをメモリへと取ってくる
</span><!--end_jpstr-->
</span></h1></div><div class="topic-container section-content row"><div class="topic-description column large-9 medium-9 small-12"><div class="topic-abstract abstract formatted-content"><div><p><span class="enstr">Receive data directly into memory by creating a data task from a URL session.</span><!--end_enstr-->
<span class="jpstr">
データを直接にメモリへと、あるデータタスクをURLセッションから作成することによって、受け取ります。
</span><!--end_jpstr-->
</p></div></div></div><div class="topic-summary column large-3 medium-3 small-12"><div class="topic-summary-section frameworks" role="complementary" aria-label="Framework"><p class="topic-summary-section-label subsection-label"><span class="enstr">Framework</span><!--end_enstr-->
<span class="jpstr">
フレームワーク
</span><!--end_jpstr-->
</p><ul class="topic-summary-section-list"><li class="topic-summary-section-item"><span>Foundation</span></li></ul></div><div class="topic-summary-section onthispage"><nav class="onthispage-nav" aria-labelledby="onthispage-title"><p id="onthispage-title" class="topic-summary-section-label subsection-label"><span class="enstr">On This Page</span><!--end_enstr-->
<span class="jpstr">
この項には
</span><!--end_jpstr-->
</p><ul class="topic-summary-section-list"><li class="topic-summary-section-item"><a href="#overview" class="icon icon-after icon-chevrondowncircle"><span class="enstr">Overview</span><!--end_enstr-->
<span class="jpstr">
概要
</span><!--end_jpstr-->
</a></li><li class="topic-summary-section-item"><a href="#see-also" class="icon icon-after icon-chevrondowncircle"><span class="enstr">See Also</span><!--end_enstr-->
<span class="jpstr">
参照
</span><!--end_jpstr-->
</a></li></ul></nav></div></div><div class="topic-content column large-9 medium-9 small-12" id="topic-content"><section id="overview" class="section"><h2><span class="enstr">Overview</span><!--end_enstr-->
<span class="jpstr">
概要
</span><!--end_jpstr-->
</h2><div class="formatted-content"><div><p><span class="enstr">For small interactions with remote servers, you can use the <a class="symbol-name" href="../../../documentation/foundation/urlsessiondatatask.html"><code><span>URLSession<wbr/>Data<wbr/>Task</span></code></a> class to receive response data into memory (as opposed to using the <a class="symbol-name" href="../../../documentation/foundation/urlsessiondownloadtask.html"><code><span>URLSession<wbr/>Download<wbr/>Task</span></code></a> class, which stores the data directly to the file system). A data task is ideal for uses like calling a web service endpoint.</span><!--end_enstr-->
<span class="jpstr">
リモートサーバーとの少しの相互作用に対して、あなたは<a class="symbol-name" href="../../../documentation/foundation/urlsessiondatatask.html"><code><span>URLSession<wbr/>Data<wbr/>Task</span></code></a>クラスを使って、応答データをメモリに受け取ることができます（<a class="symbol-name" href="../../../documentation/foundation/urlsessiondownloadtask.html"><code><span>URLSession<wbr/>Download<wbr/>Task</span></code></a>クラスとはまったく異なります、それはデータを直接にファイルシステムに格納します）。データタスクは、ウェブサービスエンドポイントを呼び出すことのような用法に最適です。
</span><!--end_jpstr-->
</p><p><span class="enstr">You use a URL session instance to create the task. If your needs are fairly simple, you can use the <a class="symbol-name" href="../../../documentation/foundation/urlsession/1409000-shared.html"><code><span>shared</span></code></a> instance of the <a class="symbol-name" href="../../../documentation/foundation/urlsession.html"><code><span>URLSession</span></code></a> class. If you want to interact with the transfer through delegate callbacks, you’ll need to create a session instead of using the shared instance. You use a <a class="symbol-name" href="../../../documentation/foundation/urlsessionconfiguration.html"><code><span>URLSession<wbr/>Configuration</span></code></a> instance when creating a session, also passing in a class that implements <a class="symbol-name" href="../../../documentation/foundation/urlsessiondelegate.html"><code><span>URLSession<wbr/>Delegate</span></code></a> or one of its subprotocols. Sessions can be reused to create multiple tasks, so for each unique configuration you need, create a session and store it as a property.</span><!--end_enstr-->
<span class="jpstr">
あなたは、URLセッションインスタンスを使ってタスクを作成します。あなたの要求がまあまあ単純ならば、あなたは<a class="symbol-name" href="../../../documentation/foundation/urlsession.html"><code><span>URLSession</span></code></a>クラスの<a class="symbol-name" href="../../../documentation/foundation/urlsession/1409000-shared.html"><code><span>shared</span></code></a>インスタンスを使用できます。あなたが委任先コールバックを通してその転送と相互作用したいならば、あなたは共有インスタンスを使う代わりにセッションを作成する必要があるでしょう。あなたは、セッションを作成する場合に<a class="symbol-name" href="../../../documentation/foundation/urlsessionconfiguration.html"><code><span>URLSession<wbr/>Configuration</span></code></a>インスタンスを使います、そして<a class="symbol-name" href="../../../documentation/foundation/urlsessiondelegate.html"><code><span>URLSession<wbr/>Delegate</span></code></a>またはそれのサブプロトコルの１つを実装するあるクラスに渡します。セッションは複数のタスクを作成するために再利用できます、それゆえあなたが必要とする固有の構成設定それぞれに対して、あるセッションを作成してそれをプロパティとして格納してください。
</span><!--end_jpstr-->
</p><aside class="aside aside-note" role="note"><p class="aside-name"><span class="enstr">Note</span><!--end_enstr-->
<span class="jpstr">
注意
</span><!--end_jpstr-->
</p><p><span class="enstr">Be careful to not create more sessions than you need. For example, if you have several parts of your app that need a similarly configured session, create one session and share it among them.</span><!--end_enstr-->
<span class="jpstr">
あなたが必要とするより多くのセッションを作成しないよう気をつけてください。例えば、あなたがある同様に構成設定されたセッションを必要とするあなたのアプリの幾つかの部分を持つならば、１つのセッションを作成してそれをそれらの間で共有してください。
</span><!--end_jpstr-->
 </p></aside><p><span class="enstr">Once you have a session, you create a data task with one of the <code class="code-voice"><span>data<wbr/>Task()</span></code> methods. Tasks are created in a suspended state, and can be started by calling <a class="symbol-name" href="../../../documentation/foundation/urlsessiontask/1411121-resume.html"><code><span>resume()</span></code></a>.</span><!--end_enstr-->
<span class="jpstr">
一旦あなたがあるセッションを持つならば、あなたはデータタスクを<code class="code-voice"><span>data<wbr/>Task()</span></code>メソッドそれらのうちの１つで作成します。タスクは、ある一時停止状態で作成されます、そして<a class="symbol-name" href="../../../documentation/foundation/urlsessiontask/1411121-resume.html"><code><span>resume()</span></code></a>を呼び出すことによって開始できます。
</span><!--end_jpstr-->
</p></div><h3 id="2919375"><span class="enstr">Receive Results with a Completion Handler</span><!--end_enstr-->
<span class="jpstr">
結果を完了ハンドラで受け取る
</span><!--end_jpstr-->
</h3><div><p><span class="enstr">The simplest way to fetch data is to create a data task that uses a completion handler. With this arrangement, the task delivers the server’s response, data, and possibly errors to a completion handler block that you provide. <a href="../../../documentation/foundation/url_loading_system/fetching_website_data_into_memory.html#2927984">Figure 1</a> shows the relationship between a session and a task, and how results are delivered to the completion handler.</span><!--end_enstr-->
<span class="jpstr">
データを取って来る最も単純な方法は、完了ハンドラを使うデータタスクを作成することです。この解決で、タスクはサーバーのもつ応答、データ、そしてことによるとエラーを、あなたが提供する完了ハンドラブロックに配達します。<a href="../../../documentation/foundation/url_loading_system/fetching_website_data_into_memory.html#2927984">図 1</a> は、セッションとタスクの間の関係、そしてどのように結果が完了ハンドラに配達されるかを示します。
</span><!--end_jpstr-->
</p><figure id="2927984"><figcaption><strong class="caption-title"><span class="enstr">Figure 1</span><!--end_enstr-->
<span class="jpstr">
図 1
</span><!--end_jpstr-->
</strong> <div class="caption-content formatted-content"><div><p><span class="enstr">Creating a completion handler to receive results from a task</span><!--end_enstr-->
<span class="jpstr">
完了ハンドラを作成して結果をタスクから受け取る
</span><!--end_jpstr-->
</p></div></div></figcaption><img class="centered-block" src="../../../../docs-assets.developer.apple.com/published/c7124fb5d7/bf4501ff-82b2-4dd4-9ec3-243ef0e70d21.png" srcSet="../../../../docs-assets.developer.apple.com/published/c7124fb5d7/bf4501ff-82b2-4dd4-9ec3-243ef0e70d21.png 2x" alt="Figure showing a URL Session creating a URL Session Data Task. The task then sends the original request, retrieved data, or an error to the completion handler." width="657" height="auto"/></figure><p><span class="enstr">To create a data task that uses a completion handler, call the <a class="symbol-name" href="../../../documentation/foundation/urlsession/1411554-datatask.html"><code><span>data<wbr/>Task(with:)</span></code></a> method of <code class="code-voice"><span>URLSession</span></code>. Your completion handler needs to do three things:</span><!--end_enstr-->
<span class="jpstr">
完了ハンドラを使うデータタスクを作成するには、<code class="code-voice"><span>URLSession</span></code>の<a class="symbol-name" href="../../../documentation/foundation/urlsession/1411554-datatask.html"><code><span>data<wbr/>Task(with:)</span></code></a>メソッドを呼び出してください。あなたの完了ハンドラは、３つのことをする必要があります：
</span><!--end_jpstr-->
</p><ol><li><p><span class="enstr">Verify that the <code class="code-voice"><span>error</span></code> parameter is <code class="code-voice"><span>nil</span></code>. If not, a transport error has occurred; handle the error and exit.</span><!--end_enstr-->
<span class="jpstr">
<code class="code-voice"><span>error</span></code>パラメータが<code class="code-voice"><span>nil</span></code>であることを検証してください。そうでないならば、転送エラーが発生しています；そのエラーを処理して退出してください。
</span><!--end_jpstr-->
 </p></li><li><p><span class="enstr">Check the <code class="code-voice"><span>response</span></code> parameter to verify that the status code indicates success and that the MIME type is an expected value. If not, handle the server error and exit.</span><!--end_enstr-->
<span class="jpstr">
<code class="code-voice"><span>response</span></code>パラメータを調べて、状態コードが成功を指し示すことそしてMIMEタイプが予想される値であることを検証してください。そうでないならば、サーバーエラーを処理して退出してください。
</span><!--end_jpstr-->
 </p></li><li><p><span class="enstr">Use the <code class="code-voice"><span>data</span></code> instance as needed.</span><!--end_enstr-->
<span class="jpstr">
<code class="code-voice"><span>data</span></code>インスタンスを必要に応じて使用してください。
</span><!--end_jpstr-->
 </p></li></ol><p><span class="enstr"><a href="../../../documentation/foundation/url_loading_system/fetching_website_data_into_memory.html#2923296">Listing 1</a>  shows a <code class="code-voice"><span>start<wbr/>Load()</span></code> method for fetching a URL’s contents. It starts by using the <code class="code-voice"><span>URLSession</span></code> class’s shared instance to create a data task that delivers its results to a completion handler. After checking for local and server errors, this handler converts the data to a string, and uses it to populate a <code class="code-voice"><span>WKWeb<wbr/>View</span></code> outlet. Of course, your app might have other uses for fetched data, like parsing it into a data model.</span><!--end_enstr-->
<span class="jpstr">
<a href="../../../documentation/foundation/url_loading_system/fetching_website_data_into_memory.html#2923296">コード出力 1</a>  は、あるURLのもつ内容を取ってくるための<code class="code-voice"><span>start<wbr/>Load()</span></code>メソッドを示します。それは<code class="code-voice"><span>URLSession</span></code>クラスのもつ共有インスタンスを使うことでそれの結果を完了ハンドラに配達するあるデータタスクを作成することによって始めます。ローカルおよびサーバーエラーを調べた後、このハンドラはそのデータを文字列に変換します、そしてそれを使って<code class="code-voice"><span>WKWeb<wbr/>View</span></code>アウトレットを満たします。もちろん、あなたのアプリは、取って来たデータに他の使い方をするかもしれません、それをあるデータモデルへと構文解析することのような。
</span><!--end_jpstr-->
</p><figure id="2923296"><figcaption><strong class="caption-title"><span class="enstr">Listing 1</span><!--end_enstr-->
<span class="jpstr">
コード出力 1
</span><!--end_jpstr-->
</strong> <div class="caption-content formatted-content"><div><p><span class="enstr">Creating a completion handler to receive data-loading results</span><!--end_enstr-->
<span class="jpstr">
完了ハンドラを作成してデーダロードの結果を受け取る
</span><!--end_jpstr-->
</p></div></div></figcaption><div class="formatted-content"><div class="code-listing"><pre class="code-source" data-language="swift"><code>func startLoad() {
    let url = URL(string: "https://www.example.com/")!
    let task = URLSession.shared.dataTask(with: url) { data, response, error in
        if let error = error {
            self.handleClientError(error)
            return
        }
        guard let httpResponse = response as? HTTPURLResponse,
            (200...299).contains(httpResponse.statusCode) else {
            self.handleServerError(response)
            return
        }
        if let mimeType = httpResponse.mimeType, mimeType == "text/html",
            let data = data,
            let string = String(data: data, encoding: .utf8) {
            DispatchQueue.main.async {
                self.webView.loadHTMLString(string, baseURL: url)
            }
        }
    }
    task.resume()
}

</code></pre></div></div></figure><p></p><aside class="aside aside-important" aria-label="important"><p class="aside-name"><span class="enstr">Important</span><!--end_enstr-->
<span class="jpstr">
重要
</span><!--end_jpstr-->
</p><p><span class="enstr">The completion handler is called on a different Grand Central Dispatch queue than the one that created the task. Therefore, any work that uses <code class="code-voice"><span>data</span></code> or <code class="code-voice"><span>error</span></code> to update the UI — like updating <code class="code-voice"><span>web<wbr/>View</span></code> — should be explicitly placed on the main queue, as shown here.</span><!--end_enstr-->
<span class="jpstr">
完了ハンドラは、タスクが作成されたものと異なるグランドセントラルディスパッチキュー上で呼び出されます。したがって、<code class="code-voice"><span>data</span></code>または<code class="code-voice"><span>error</span></code>を使ってUIを更新するあらゆる仕事 — <code class="code-voice"><span>web<wbr/>View</span></code>を更新することのような — は、明示的にメインキュー上に置かれるべきです、ここで示されるように。
</span><!--end_jpstr-->
 </p></aside><p></p></div><h3 id="2919376"><span class="enstr">Receive Transfer Details and Results with a Delegate</span><!--end_enstr-->
<span class="jpstr">
転送の詳細と結果を委任先で受け取る
</span><!--end_jpstr-->
</h3><div><p><span class="enstr">For a greater level of access to the task’s activity as it proceeds, when creating the data task, you can set a delegate on the session, rather than providing a completion handler. <a href="../../../documentation/foundation/url_loading_system/fetching_website_data_into_memory.html#2927985">Figure 2</a> shows this arrangement.</span><!--end_enstr-->
<span class="jpstr">
タスクの活動へのそれが進むにつれてのより重要な水準のアクセスに対して、データタスクを作成している時に、あなたは委任先をそのセッション上で設定できます、完了ハンドラを提供するのではなく。<a href="../../../documentation/foundation/url_loading_system/fetching_website_data_into_memory.html#2927985">図 2</a> は、この手はずを示します。
</span><!--end_jpstr-->
</p><figure id="2927985"><figcaption><strong class="caption-title"><span class="enstr">Figure 2</span><!--end_enstr-->
<span class="jpstr">
図 2
</span><!--end_jpstr-->
</strong> <div class="caption-content formatted-content"><div><p><span class="enstr">Implementing a delegate to receive results from a task</span><!--end_enstr-->
<span class="jpstr">
委任先を実装して結果をタスクから受け取る
</span><!--end_jpstr-->
</p></div></div></figcaption><img class="centered-block" src="../../../../docs-assets.developer.apple.com/published/8b22355c7f/730c8e1b-654f-4eb9-9c63-d439a69ac5d2.png" srcSet="../../../../docs-assets.developer.apple.com/published/8b22355c7f/730c8e1b-654f-4eb9-9c63-d439a69ac5d2.png 2x" alt="Figure showing a URLSession creating a URLSessionDataTask. The session calls back to the delegate with progress updates, retrieved data, authentication challenges, etc." width="630" height="auto"/></figure><p><span class="enstr">With this approach, portions of the data are provided to the <a class="symbol-name" href="../../../documentation/foundation/urlsessiondatadelegate/1411528-urlsession.html"><code><span>url<wbr/>Session(_:<wbr/>data<wbr/>Task:<wbr/>did<wbr/>Receive:)</span></code></a> method of <a class="symbol-name" href="../../../documentation/foundation/urlsessiondatadelegate.html"><code><span>URLSession<wbr/>Data<wbr/>Delegate</span></code></a> as they arrive, until the transfer finishes or fails with an error. The delegate also receives other kinds of events as the transfer proceeds.</span><!--end_enstr-->
<span class="jpstr">
この取り組みでは、データの部分それらは<a class="symbol-name" href="../../../documentation/foundation/urlsessiondatadelegate.html"><code><span>URLSession<wbr/>Data<wbr/>Delegate</span></code></a>の<a class="symbol-name" href="../../../documentation/foundation/urlsessiondatadelegate/1411528-urlsession.html"><code><span>url<wbr/>Session(_:<wbr/>data<wbr/>Task:<wbr/>did<wbr/>Receive:)</span></code></a>メソッドにそれらが到着するにつれて提供されます、転送が終了するかエラーで失敗するまで。委任先はまた、他の種類のイベントを転送が進むにつれて受け取ります。
</span><!--end_jpstr-->
</p><p><span class="enstr">You need to create your own <code class="code-voice"><span>URLSession</span></code> instance when using the delegate approach, rather than using the <code class="code-voice"><span>URLSession</span></code> class’s simple <code class="code-voice"><span>shared</span></code> instance. Creating a new session allows you to set your own class as the session’s delegate, as shown in <a href="../../../documentation/foundation/url_loading_system/fetching_website_data_into_memory.html#2926952">Listing 2</a>.</span><!--end_enstr-->
<span class="jpstr">
あなたは、あなた独自の<code class="code-voice"><span>URLSession</span></code>インスタンスを作成する必要があります、<code class="code-voice"><span>URLSession</span></code>クラスのもつ単純な<code class="code-voice"><span>shared</span></code>インスタンスを使っているのではなく、委任先手法を使っている時は。新しいセッションを作成することは、あなたにあなた独自のクラスをそのセッションのもつ委任先として設定させます、<a href="../../../documentation/foundation/url_loading_system/fetching_website_data_into_memory.html#2926952">コード出力 2</a>において示されるように。
</span><!--end_jpstr-->
</p><p><span class="enstr">Declare that your class implements one or more of the delegate protocols (<a class="symbol-name" href="../../../documentation/foundation/urlsessiondelegate.html"><code><span>URLSession<wbr/>Delegate</span></code></a>, <a class="symbol-name" href="../../../documentation/foundation/urlsessiontaskdelegate.html"><code><span>URLSession<wbr/>Task<wbr/>Delegate</span></code></a>, <a class="symbol-name" href="../../../documentation/foundation/urlsessiondatadelegate.html"><code><span>URLSession<wbr/>Data<wbr/>Delegate</span></code></a>, and <a class="symbol-name" href="../../../documentation/foundation/urlsessiondownloaddelegate.html"><code><span>URLSession<wbr/>Download<wbr/>Delegate</span></code></a>). Then create the URL session instance with the initializer <a class="symbol-name" href="../../../documentation/foundation/urlsession/1411597-init.html"><code><span>init(configuration:<wbr/>delegate:<wbr/>delegate<wbr/>Queue:)</span></code></a>. You can customize the configuration instance used with this initializer. For example, it’s a good idea to set <a class="symbol-name" href="../../../documentation/foundation/urlsessionconfiguration/2908812-waitsforconnectivity.html"><code><span>waits<wbr/>For<wbr/>Connectivity</span></code></a> to <code class="code-voice"><span>true</span></code>. That way, the session waits for suitable connectivity, rather than failing immediately if the required connectivity is unavailable.</span><!--end_enstr-->
<span class="jpstr">
あなたのクラスが１つ以上の委任先プロトコルを実装することを宣言してください（<a class="symbol-name" href="../../../documentation/foundation/urlsessiondelegate.html"><code><span>URLSession<wbr/>Delegate</span></code></a>、<a class="symbol-name" href="../../../documentation/foundation/urlsessiontaskdelegate.html"><code><span>URLSession<wbr/>Task<wbr/>Delegate</span></code></a>, <a class="symbol-name" href="../../../documentation/foundation/urlsessiondatadelegate.html"><code><span>URLSession<wbr/>Data<wbr/>Delegate</span></code></a>、そして<a class="symbol-name" href="../../../documentation/foundation/urlsessiondownloaddelegate.html"><code><span>URLSession<wbr/>Download<wbr/>Delegate</span></code></a>）。それからURLセッションインスタンスをイニシャライザ<a class="symbol-name" href="../../../documentation/foundation/urlsession/1411597-init.html"><code><span>init(configuration:<wbr/>delegate:<wbr/>delegate<wbr/>Queue:)</span></code></a>で作成してください。あなたは、構成設定インスタンスをこのイニシャライザでカスタマイズできます。例えば、<a class="symbol-name" href="../../../documentation/foundation/urlsessionconfiguration/2908812-waitsforconnectivity.html"><code><span>waits<wbr/>For<wbr/>Connectivity</span></code></a>を<code class="code-voice"><span>true</span></code>に設定することは良い考えです。そのようにして、セッションは適切な接続性に対して待機します、要求される接続性が利用可能でないならばすぐに失敗するのではなく。
</span><!--end_jpstr-->
</p><figure id="2926952"><figcaption><strong class="caption-title"><span class="enstr">Listing 2</span><!--end_enstr-->
<span class="jpstr">
コード出力 2 
</span><!--end_jpstr-->
</strong> <div class="caption-content formatted-content"><div><p><span class="enstr">Creating a URLSession that uses a delegate</span><!--end_enstr-->
<span class="jpstr">
委任先を使うURLSessionを作成する
</span><!--end_jpstr-->
</p></div></div></figcaption><div class="formatted-content"><div class="code-listing"><pre class="code-source" data-language="swift"><code>private lazy var session: URLSession = {
    let configuration = URLSessionConfiguration.default
    configuration.waitsForConnectivity = true
    return URLSession(configuration: configuration,
                      delegate: self, delegateQueue: nil)
}()
</code></pre></div></div></figure><p> </p><p><span class="enstr"><a href="../../../documentation/foundation/url_loading_system/fetching_website_data_into_memory.html#2919378">Listing 3</a> shows a <code class="code-voice"><span>start<wbr/>Load()</span></code> method that uses this session to start a data task, and uses delegate callbacks to handle received data and errors. This listing implements three delegate callbacks:</span><!--end_enstr-->
<span class="jpstr">
<a href="../../../documentation/foundation/url_loading_system/fetching_website_data_into_memory.html#2919378">コード出力 3</a> は、ある<code class="code-voice"><span>start<wbr/>Load()</span></code>メソッドを示します、それはこのセッションを使ってデータタスクを開始します、そして委任先コールバックを使って受信されたデータとエラーを取り扱います。このコード出力は、３つの委任先コールバックを実装します：
</span><!--end_jpstr-->
</p><ul><li><p><span class="enstr"><a class="symbol-name" href="../../../documentation/foundation/urlsessiondatadelegate/1410027-urlsession.html"><code><span>url<wbr/>Session(_:<wbr/>data<wbr/>Task:<wbr/>did<wbr/>Receive:<wbr/>completion<wbr/>Handler:)</span></code></a> verifies that the response has a succesful HTTP status code, and that the MIME type is <code class="code-voice"><span>text/html</span></code> or <code class="code-voice"><span>text/plain</span></code>. If either of these is not the case, the task is canceled; otherwise, it’s allowed to proceed.</span><!--end_enstr-->
<span class="jpstr">
<a class="symbol-name" href="../../../documentation/foundation/urlsessiondatadelegate/1410027-urlsession.html"><code><span>url<wbr/>Session(_:<wbr/>data<wbr/>Task:<wbr/>did<wbr/>Receive:<wbr/>completion<wbr/>Handler:)</span></code></a>は、応答が成功HTTP状態コードを持つこと、そしてMIME型が<code class="code-voice"><span>text/html</span></code>または<code class="code-voice"><span>text/plain</span></code>であることを検証します。どちらかが事実でないならば、タスクは取り消されます；そうでなければ、それは処理を許可されます。
</span><!--end_jpstr-->
</p></li><li><p><span class="enstr"><a class="symbol-name" href="../../../documentation/foundation/urlsessiondatadelegate/1411528-urlsession.html"><code><span>url<wbr/>Session(_:<wbr/>data<wbr/>Task:<wbr/>did<wbr/>Receive:)</span></code></a> takes each <code class="code-voice"><span>Data</span></code> instance received by the task and appends it to a buffer called <code class="code-voice"><span>received<wbr/>Data</span></code>.</span><!--end_enstr-->
<span class="jpstr">
<a class="symbol-name" href="../../../documentation/foundation/urlsessiondatadelegate/1411528-urlsession.html"><code><span>url<wbr/>Session(_:<wbr/>data<wbr/>Task:<wbr/>did<wbr/>Receive:)</span></code></a>は、タスクによって受け取られる<code class="code-voice"><span>Data</span></code>インスタンスそれぞれを取り、そしてそれを<code class="code-voice"><span>received<wbr/>Data</span></code>と呼ばれるパッファに追加します。
</span><!--end_jpstr-->
</p></li><li><p><span class="enstr"><a class="symbol-name" href="../../../documentation/foundation/urlsessiontaskdelegate/1411610-urlsession.html"><code><span>url<wbr/>Session(_:<wbr/>task:<wbr/>did<wbr/>Complete<wbr/>With<wbr/>Error:)</span></code></a> first looks to see if a transport-level error has occurred. If there is no error, it attempts to convert the <code class="code-voice"><span>received<wbr/>Data</span></code> buffer to a string and set it as the contents of <code class="code-voice"><span>web<wbr/>View</span></code>.</span><!--end_enstr-->
<span class="jpstr">
<a class="symbol-name" href="../../../documentation/foundation/urlsessiontaskdelegate/1411610-urlsession.html"><code><span>url<wbr/>Session(_:<wbr/>task:<wbr/>did<wbr/>Complete<wbr/>With<wbr/>Error:)</span></code></a>は、まず転送レベルエラーが起こったかどうか知るために確かめます。エラーがないならば、それは<code class="code-voice"><span>received<wbr/>Data</span></code>バッファを文字列へと変換してそれを<code class="code-voice"><span>web<wbr/>View</span></code>の内容として設定しようと試みます。
</span><!--end_jpstr-->
</p></li></ul><p></p><figure id="2919378"><figcaption><strong class="caption-title"><span class="enstr">Listing 3</span><!--end_enstr-->
<span class="jpstr">
コード出力 3 
</span><!--end_jpstr-->
</strong> <div class="caption-content formatted-content"><div><p><span class="enstr">Using a delegate with a URL session data task</span><!--end_enstr-->
<span class="jpstr">
委任先をURLセッションデータタスクとともに使う
</span><!--end_jpstr-->
</p></div></div></figcaption><div class="formatted-content"><div class="code-listing"><pre class="code-source" data-language="swift"><code>var receivedData: Data?

func startLoad() {
    loadButton.isEnabled = false
    let url = URL(string: "https://www.example.com/")!
    receivedData = Data()
    let task = session.dataTask(with: url)
    task.resume()
}

// delegate methods

func urlSession(_ session: URLSession, dataTask: URLSessionDataTask, didReceive response: URLResponse,
                completionHandler: @escaping (URLSession.ResponseDisposition) -&gt; Void) {
    guard let response = response as?HTTPURLResponse,
        (200...299).contains(response.statusCode),
        let mimeType = response.mimeType,
        mimeType == "text/html" else {
        completionHandler(.cancel)
        return
    }
    completionHandler(.allow)
}

func urlSession(_ session: URLSession, dataTask: URLSessionDataTask, didReceive data: Data) {
    self.receivedData?.append(data)
}

func urlSession(_ session: URLSession, task: URLSessionTask, didCompleteWithError error: Error?) {
    DispatchQueue.main.async {
        self.loadButton.isEnabled = true
        if let error = error {
            handleClientError(error)
        } else if let receivedData = self.receivedData,
            let string = String(data: receivedData, encoding: .utf8) {
            self.webView.loadHTMLString(string, baseURL: task.currentRequest?.url)
        }
    }
}
</code></pre></div></div></figure><p><span class="enstr">The various delegate protocols offer methods beyond those shown in the above code, for handling authentication challenges, following redirects, and other special cases. <em>Using a URL Session</em>, in the <code class="code-voice"><span>URLSession</span></code> discussion, describes the various callbacks that may occur during a transfer.</span><!--end_enstr-->
<span class="jpstr">
さまざまな委任先プロトコルは、上のコードにおいて示されるそれらを越えるメソッドを提案して、リダイレクト、そして他の特殊事例を取り扱っています。<em>Using a URL Session</em>は、<code class="code-voice"><span>URLSession</span></code>の議論において、転送の間に起こるかもしれないさまざまなコールバックを記述します。
</span><!--end_jpstr-->
</p></div></div></section></div></div><section id="see-also" class="contenttable section alt-light-container row"><div class="alt-light"><div class="section-content"><h2 class="contenttable-title"><span class="enstr">See Also</span><!--end_enstr-->
<span class="jpstr">
参照
</span><!--end_jpstr-->
</h2><section id="2878017" class="contenttable-section"><div class="contenttable-container row"><div class="contenttable-section-title-container column large-3 medium-3 small-12"><h3 class="contenttable-section-title">Essentials</h3></div><div class="contenttable-section-content column large-9 medium-9 small-12"><div class="task-topics"><div class="task-topic"><div class="task-topic-info"><a class="has-adjacent-element symbol-name symbol-name-decorated" href="../../../documentation/foundation/urlsession.html"><code class="display-name"><span class="decorator">class </span><span class="identifier">URLSession</span></code></a><div class="task-topic-abstract task-topic-data abstract formatted-content"><div><p><span class="enstr">An object that coordinates a group of related, network data-transfer tasks.</span><!--end_enstr-->
<span class="jpstr">
一群の関連した、ネットワーク「データ転送」タスクをうまく調整するオブジェクト。
</span><!--end_jpstr-->
</p></div></div></div></div><div class="task-topic"><div class="task-topic-info"><a class="has-adjacent-element symbol-name symbol-name-decorated" href="../../../documentation/foundation/urlsessiontask.html"><code class="display-name"><span class="decorator">class </span><span class="identifier">URLSession<wbr/>Task</span></code></a><div class="task-topic-abstract task-topic-data abstract formatted-content"><div><p><span class="enstr">A task, like downloading a specific resource, performed in a URL session.</span><!--end_enstr-->
<span class="jpstr">
URLセッションにおいて実行される、特定のリソースをダウンロードするような、あるタスク。
</span><!--end_jpstr-->
</p></div></div></div></div></div></div></div></section></div></div></section></main><section id="globalfooter-wrapper"><footer id="globalfooter" role="contentinfo">
        <nav class="footer-breadory">
          <a href="/" class="home breadcrumbs-home"><span aria-hidden="true"></span><span class="breadcrumbs-home-label">Developer</span></a>
          <section class="breadcrumbs">
            <ol class="breadcrumbs-list">
              <li><a href=/documentation>Documentation</a></li>
            </ol>
          </section>
          <div id="directorynav" class="directorynav">
            <div id="dn-cola" class="column">
              <h3><a href="/discover/">Discover</a></h3>
              <ul>
                <li><a href="/macos/">macOS</a></li>
                <li><a href="/ios/">iOS</a></li>
                <li><a href="/watchos/">watchOS</a></li>
                <li><a href="/tvos/">tvOS</a></li>
                <li><a href="/safari/">Safari and Web</a></li>
                <li><a href="/games/">Games</a></li>
                <li><a href="/business/">Business</a></li>
                <li><a href="/education/">Education</a></li>
                <li><a href="/wwdc/">WWDC</a></li>
              </ul>
            </div>
            <div id="dn-colb" class="column">
              <h3><a href="/design/">Design</a></h3>
              <ul>
                <li><a href="/design/human-interface-guidelines/">Human Interface Guidelines</a></li>
                <li><a href="/design/resources/"><span class="enstr">Resources</span><!--end_enstr-->
<span class="jpstr">
リソース
</span><!--end_jpstr-->
</a></li>
                <li><a href="/videos/design/">Videos</a></li>
                <li><a href="/design/awards/">Apple Design Awards</a></li>
                <li><a href="/accessibility/">Accessibility</a></li>
                <li><a href="/internationalization/"><span class="enstr">Internationalization</span><!--end_enstr-->
<span class="jpstr">
国際化
</span><!--end_jpstr-->
</a></li>
                <li><a href="/accessories/">Accessories</a></li>
              </ul>
            </div>
            <div id="dn-colc" class="column">
              <h3><a href="/develop/">Develop</a></h3>
              <ul>
                <li><a href="/xcode/">Xcode</a></li>
                <li><a href="/swift/">Swift</a></li>
                <li><a href="/swift-playgrounds/">Swift Playgrounds</a></li>
                <li><a href="/testflight/">TestFlight</a></li>
                <li><a href="https://developer.apple.com/documentation/">Documentation</a></li>
                <li><a href="/videos/">Videos</a></li>
                <li><a href="/download/">Downloads</a></li>
              </ul>
            </div>
            <div id="dn-cold" class="column">
              <h3><a href="/distribute/">Distribute</a></h3>
              <ul>
                <li><a href="/programs/">Developer Program</a></li>
                <li><a href="/app-store/">App Store</a></li>
                <li><a href="/app-store/review/">App Review</a></li>
                <li><a href="/macos/distribution/">Mac Software</a></li>
                <li><a href="/business/distribute/">Apps for Business</a></li>
                <li><a href="/safari/extensions/">Safari Extensions</a></li>
                <li><a href="/app-store/marketing/guidelines/">Marketing Resources</a></li>
                <li><a href="/softwarelicensing/">Trademark Licensing</a></li>
              </ul>
            </div>
            <div id="dn-cole" class="column">
              <h3><a href="/support/">Support</a></h3>
              <ul>
                <li><a href="https://forums.developer.apple.com">Developer Forums</a></li>
                <li><a href="/bug-reporting/">Bug Reporting</a></li>
                <li><a href="/terms/">License Agreements</a></li>
                <li><a href="/system-status/">System Status</a></li>
                <li><a href="/contact/">Contact Us</a></li>
              </ul>
              <h3><a href="/account/">Account</a></h3>
              <ul>
                <li><a href="/account/ios/certificate/">Certificates, IDs &amp; Profiles</a></li>
                <li><a href="https://appstoreconnect.apple.com/">App Store Connect</a></li>
              </ul>
            </div>
          </div>
        </nav>
        <div class="ac-gf-footer-legal">
          <div class="ac-gf-footer-news"> To receive the latest developer news, visit and subscribe to our <a href="/news/">News and Updates</a>.
          </div>
          <div class="ac-gf-footer-legal-copyright">Copyright © 2019 Apple Inc. All rights reserved.</div>
          <div class="ac-gf-footer-legal-links">
            <a href="https://www.apple.com/legal/internet-services/terms/site.html" class="first">Terms of Use</a>
            <a href="https://www.apple.com/privacy/privacy-policy/">Privacy Policy</a>
            <a href="/bug-reporting/">Report Bugs</a>
            <a href="/contact/submit/?subject=website-feedback">Feedback</a>
          </div>
          <div class="ac-gf-footer-language-links">
            <a href="/cn/" class="first">简体中文</a>
            <a href="/jp/">日本語</a>
            <a href="/kr/">한국어</a>
          </div>
        </div>
      </footer></section></div></div><script id="bootstrap-data" type="application/json">{"id":2919362,"title":{"content":"Fetching Website Data into Memory"},"abstract":"<div><p>Receive data directly into memory by creating a data task from a URL session.<\/p><\/div>","discussion":"<div><p>For small interactions with remote servers, you can use the <a class=\"symbol-name\" href=\"\/documentation\/foundation\/urlsessiondatatask\"><code><span>URLSession<wbr\/>Data<wbr\/>Task<\/span><\/code><\/a> class to receive response data into memory (as opposed to using the <a class=\"symbol-name\" href=\"\/documentation\/foundation\/urlsessiondownloadtask\"><code><span>URLSession<wbr\/>Download<wbr\/>Task<\/span><\/code><\/a> class, which stores the data directly to the file system). A data task is ideal for uses like calling a web service endpoint.<\/p><p>You use a URL session instance to create the task. If your needs are fairly simple, you can use the <a class=\"symbol-name\" href=\"\/documentation\/foundation\/urlsession\/1409000-shared\"><code><span>shared<\/span><\/code><\/a> instance of the <a class=\"symbol-name\" href=\"\/documentation\/foundation\/urlsession\"><code><span>URLSession<\/span><\/code><\/a> class. If you want to interact with the transfer through delegate callbacks, you’ll need to create a session instead of using the shared instance. You use a <a class=\"symbol-name\" href=\"\/documentation\/foundation\/urlsessionconfiguration\"><code><span>URLSession<wbr\/>Configuration<\/span><\/code><\/a> instance when creating a session, also passing in a class that implements <a class=\"symbol-name\" href=\"\/documentation\/foundation\/urlsessiondelegate\"><code><span>URLSession<wbr\/>Delegate<\/span><\/code><\/a> or one of its subprotocols. Sessions can be reused to create multiple tasks, so for each unique configuration you need, create a session and store it as a property.<\/p><aside class=\"aside aside-note\" role=\"note\"><p class=\"aside-name\">Note<\/p><p>Be careful to not create more sessions than you need. For example, if you have several parts of your app that need a similarly configured session, create one session and share it among them. <\/p><\/aside><p>Once you have a session, you create a data task with one of the <code class=\"code-voice\"><span>data<wbr\/>Task()<\/span><\/code> methods. Tasks are created in a suspended state, and can be started by calling <a class=\"symbol-name\" href=\"\/documentation\/foundation\/urlsessiontask\/1411121-resume\"><code><span>resume()<\/span><\/code><\/a>.<\/p><\/div><h3 id=\"2919375\">Receive Results with a Completion Handler<\/h3><div><p>The simplest way to fetch data is to create a data task that uses a completion handler. With this arrangement, the task delivers the server’s response, data, and possibly errors to a completion handler block that you provide. <a href=\"\/documentation\/foundation\/url_loading_system\/fetching_website_data_into_memory#2927984\">Figure 1<\/a> shows the relationship between a session and a task, and how results are delivered to the completion handler.<\/p><figure id=\"2927984\"><figcaption><strong class=\"caption-title\">Figure 1<\/strong> <div class=\"caption-content formatted-content\"><div><p>Creating a completion handler to receive results from a task<\/p><\/div><\/div><\/figcaption><img class=\"centered-block\" src=\"https:\/\/docs-assets.developer.apple.com\/published\/c7124fb5d7\/bf4501ff-82b2-4dd4-9ec3-243ef0e70d21.png\" srcSet=\"https:\/\/docs-assets.developer.apple.com\/published\/c7124fb5d7\/bf4501ff-82b2-4dd4-9ec3-243ef0e70d21.png 2x\" alt=\"Figure showing a URL Session creating a URL Session Data Task. The task then sends the original request, retrieved data, or an error to the completion handler.\" width=\"657\" height=\"auto\"\/><\/figure><p>To create a data task that uses a completion handler, call the <a class=\"symbol-name\" href=\"\/documentation\/foundation\/urlsession\/1411554-datatask\"><code><span>data<wbr\/>Task(with:)<\/span><\/code><\/a> method of <code class=\"code-voice\"><span>URLSession<\/span><\/code>. Your completion handler needs to do three things:<\/p><ol><li><p>Verify that the <code class=\"code-voice\"><span>error<\/span><\/code> parameter is <code class=\"code-voice\"><span>nil<\/span><\/code>. If not, a transport error has occurred; handle the error and exit. <\/p><\/li><li><p>Check the <code class=\"code-voice\"><span>response<\/span><\/code> parameter to verify that the status code indicates success and that the MIME type is an expected value. If not, handle the server error and exit. <\/p><\/li><li><p>Use the <code class=\"code-voice\"><span>data<\/span><\/code> instance as needed. <\/p><\/li><\/ol><p><a href=\"\/documentation\/foundation\/url_loading_system\/fetching_website_data_into_memory#2923296\">Listing 1<\/a>  shows a <code class=\"code-voice\"><span>start<wbr\/>Load()<\/span><\/code> method for fetching a URL’s contents. It starts by using the <code class=\"code-voice\"><span>URLSession<\/span><\/code> class’s shared instance to create a data task that delivers its results to a completion handler. After checking for local and server errors, this handler converts the data to a string, and uses it to populate a <code class=\"code-voice\"><span>WKWeb<wbr\/>View<\/span><\/code> outlet. Of course, your app might have other uses for fetched data, like parsing it into a data model.<\/p><figure id=\"2923296\"><figcaption><strong class=\"caption-title\">Listing 1<\/strong> <div class=\"caption-content formatted-content\"><div><p>Creating a completion handler to receive data-loading results<\/p><\/div><\/div><\/figcaption><div class=\"formatted-content\"><div class=\"code-listing\"><pre class=\"code-source\" data-language=\"swift\"><code>func startLoad() {\n    let url = URL(string: &quot;https:\/\/www.example.com\/&quot;)!\n    let task = URLSession.shared.dataTask(with: url) { data, response, error in\n        if let error = error {\n            self.handleClientError(error)\n            return\n        }\n        guard let httpResponse = response as? HTTPURLResponse,\n            (200...299).contains(httpResponse.statusCode) else {\n            self.handleServerError(response)\n            return\n        }\n        if let mimeType = httpResponse.mimeType, mimeType == &quot;text\/html&quot;,\n            let data = data,\n            let string = String(data: data, encoding: .utf8) {\n            DispatchQueue.main.async {\n                self.webView.loadHTMLString(string, baseURL: url)\n            }\n        }\n    }\n    task.resume()\n}\n\n<\/code><\/pre><\/div><\/div><\/figure><p><\/p><aside class=\"aside aside-important\" aria-label=\"important\"><p class=\"aside-name\">Important<\/p><p>The completion handler is called on a different Grand Central Dispatch queue than the one that created the task. Therefore, any work that uses <code class=\"code-voice\"><span>data<\/span><\/code> or <code class=\"code-voice\"><span>error<\/span><\/code> to update the UI — like updating <code class=\"code-voice\"><span>web<wbr\/>View<\/span><\/code> — should be explicitly placed on the main queue, as shown here. <\/p><\/aside><p><\/p><\/div><h3 id=\"2919376\">Receive Transfer Details and Results with a Delegate<\/h3><div><p>For a greater level of access to the task’s activity as it proceeds, when creating the data task, you can set a delegate on the session, rather than providing a completion handler. <a href=\"\/documentation\/foundation\/url_loading_system\/fetching_website_data_into_memory#2927985\">Figure 2<\/a> shows this arrangement.<\/p><figure id=\"2927985\"><figcaption><strong class=\"caption-title\">Figure 2<\/strong> <div class=\"caption-content formatted-content\"><div><p>Implementing a delegate to receive results from a task<\/p><\/div><\/div><\/figcaption><img class=\"centered-block\" src=\"https:\/\/docs-assets.developer.apple.com\/published\/8b22355c7f\/730c8e1b-654f-4eb9-9c63-d439a69ac5d2.png\" srcSet=\"https:\/\/docs-assets.developer.apple.com\/published\/8b22355c7f\/730c8e1b-654f-4eb9-9c63-d439a69ac5d2.png 2x\" alt=\"Figure showing a URLSession creating a URLSessionDataTask. The session calls back to the delegate with progress updates, retrieved data, authentication challenges, etc.\" width=\"630\" height=\"auto\"\/><\/figure><p>With this approach, portions of the data are provided to the <a class=\"symbol-name\" href=\"\/documentation\/foundation\/urlsessiondatadelegate\/1411528-urlsession\"><code><span>url<wbr\/>Session(_:<wbr\/>data<wbr\/>Task:<wbr\/>did<wbr\/>Receive:)<\/span><\/code><\/a> method of <a class=\"symbol-name\" href=\"\/documentation\/foundation\/urlsessiondatadelegate\"><code><span>URLSession<wbr\/>Data<wbr\/>Delegate<\/span><\/code><\/a> as they arrive, until the transfer finishes or fails with an error. The delegate also receives other kinds of events as the transfer proceeds.<\/p><p>You need to create your own <code class=\"code-voice\"><span>URLSession<\/span><\/code> instance when using the delegate approach, rather than using the <code class=\"code-voice\"><span>URLSession<\/span><\/code> class’s simple <code class=\"code-voice\"><span>shared<\/span><\/code> instance. Creating a new session allows you to set your own class as the session’s delegate, as shown in <a href=\"\/documentation\/foundation\/url_loading_system\/fetching_website_data_into_memory#2926952\">Listing 2<\/a>.<\/p><p>Declare that your class implements one or more of the delegate protocols (<a class=\"symbol-name\" href=\"\/documentation\/foundation\/urlsessiondelegate\"><code><span>URLSession<wbr\/>Delegate<\/span><\/code><\/a>, <a class=\"symbol-name\" href=\"\/documentation\/foundation\/urlsessiontaskdelegate\"><code><span>URLSession<wbr\/>Task<wbr\/>Delegate<\/span><\/code><\/a>, <a class=\"symbol-name\" href=\"\/documentation\/foundation\/urlsessiondatadelegate\"><code><span>URLSession<wbr\/>Data<wbr\/>Delegate<\/span><\/code><\/a>, and <a class=\"symbol-name\" href=\"\/documentation\/foundation\/urlsessiondownloaddelegate\"><code><span>URLSession<wbr\/>Download<wbr\/>Delegate<\/span><\/code><\/a>). Then create the URL session instance with the initializer <a class=\"symbol-name\" href=\"\/documentation\/foundation\/urlsession\/1411597-init\"><code><span>init(configuration:<wbr\/>delegate:<wbr\/>delegate<wbr\/>Queue:)<\/span><\/code><\/a>. You can customize the configuration instance used with this initializer. For example, it’s a good idea to set <a class=\"symbol-name\" href=\"\/documentation\/foundation\/urlsessionconfiguration\/2908812-waitsforconnectivity\"><code><span>waits<wbr\/>For<wbr\/>Connectivity<\/span><\/code><\/a> to <code class=\"code-voice\"><span>true<\/span><\/code>. That way, the session waits for suitable connectivity, rather than failing immediately if the required connectivity is unavailable.<\/p><figure id=\"2926952\"><figcaption><strong class=\"caption-title\">Listing 2<\/strong> <div class=\"caption-content formatted-content\"><div><p>Creating a URLSession that uses a delegate<\/p><\/div><\/div><\/figcaption><div class=\"formatted-content\"><div class=\"code-listing\"><pre class=\"code-source\" data-language=\"swift\"><code>private lazy var session: URLSession = {\n    let configuration = URLSessionConfiguration.default\n    configuration.waitsForConnectivity = true\n    return URLSession(configuration: configuration,\n                      delegate: self, delegateQueue: nil)\n}()\n<\/code><\/pre><\/div><\/div><\/figure><p> <\/p><p><a href=\"\/documentation\/foundation\/url_loading_system\/fetching_website_data_into_memory#2919378\">Listing 3<\/a> shows a <code class=\"code-voice\"><span>start<wbr\/>Load()<\/span><\/code> method that uses this session to start a data task, and uses delegate callbacks to handle received data and errors.  This listing implements three delegate callbacks:<\/p><ul><li><p><a class=\"symbol-name\" href=\"\/documentation\/foundation\/urlsessiondatadelegate\/1410027-urlsession\"><code><span>url<wbr\/>Session(_:<wbr\/>data<wbr\/>Task:<wbr\/>did<wbr\/>Receive:<wbr\/>completion<wbr\/>Handler:)<\/span><\/code><\/a> verifies that the response has a succesful HTTP status code, and that the MIME type is <code class=\"code-voice\"><span>text\/html<\/span><\/code> or <code class=\"code-voice\"><span>text\/plain<\/span><\/code>. If either of these is not the case, the task is canceled; otherwise, it’s allowed to proceed.<\/p><\/li><li><p><a class=\"symbol-name\" href=\"\/documentation\/foundation\/urlsessiondatadelegate\/1411528-urlsession\"><code><span>url<wbr\/>Session(_:<wbr\/>data<wbr\/>Task:<wbr\/>did<wbr\/>Receive:)<\/span><\/code><\/a> takes each <code class=\"code-voice\"><span>Data<\/span><\/code> instance received by the task and appends it to a buffer called <code class=\"code-voice\"><span>received<wbr\/>Data<\/span><\/code>.<\/p><\/li><li><p><a class=\"symbol-name\" href=\"\/documentation\/foundation\/urlsessiontaskdelegate\/1411610-urlsession\"><code><span>url<wbr\/>Session(_:<wbr\/>task:<wbr\/>did<wbr\/>Complete<wbr\/>With<wbr\/>Error:)<\/span><\/code><\/a> first looks to see if a transport-level error has occurred. If there is no error, it attempts to convert the <code class=\"code-voice\"><span>received<wbr\/>Data<\/span><\/code> buffer to a string and set it as the contents of <code class=\"code-voice\"><span>web<wbr\/>View<\/span><\/code>.<\/p><\/li><\/ul><p><\/p><figure id=\"2919378\"><figcaption><strong class=\"caption-title\">Listing 3<\/strong> <div class=\"caption-content formatted-content\"><div><p>Using a delegate with a URL session data task<\/p><\/div><\/div><\/figcaption><div class=\"formatted-content\"><div class=\"code-listing\"><pre class=\"code-source\" data-language=\"swift\"><code>var receivedData: Data?\n\nfunc startLoad() {\n    loadButton.isEnabled = false\n    let url = URL(string: &quot;https:\/\/www.example.com\/&quot;)!\n    receivedData = Data()\n    let task = session.dataTask(with: url)\n    task.resume()\n}\n\n\/\/ delegate methods\n\nfunc urlSession(_ session: URLSession, dataTask: URLSessionDataTask, didReceive response: URLResponse,\n                completionHandler: @escaping (URLSession.ResponseDisposition) -&gt; Void) {\n    guard let response = response as? HTTPURLResponse,\n        (200...299).contains(response.statusCode),\n        let mimeType = response.mimeType,\n        mimeType == &quot;text\/html&quot; else {\n        completionHandler(.cancel)\n        return\n    }\n    completionHandler(.allow)\n}\n\nfunc urlSession(_ session: URLSession, dataTask: URLSessionDataTask, didReceive data: Data) {\n    self.receivedData?.append(data)\n}\n\nfunc urlSession(_ session: URLSession, task: URLSessionTask, didCompleteWithError error: Error?) {\n    DispatchQueue.main.async {\n        self.loadButton.isEnabled = true\n        if let error = error {\n            handleClientError(error)\n        } else if let receivedData = self.receivedData,\n            let string = String(data: receivedData, encoding: .utf8) {\n            self.webView.loadHTMLString(string, baseURL: task.currentRequest?.url)\n        }\n    }\n}\n<\/code><\/pre><\/div><\/div><\/figure><p>The various delegate protocols offer methods beyond those shown in the above code, for handling authentication challenges, following redirects, and other special cases. <em>Using a URL Session<\/em>, in the <code class=\"code-voice\"><span>URLSession<\/span><\/code> discussion, describes the various callbacks that may occur during a transfer.<\/p><\/div>","containingGroup":[{"id":2878017,"role":"task","paths":[],"abstract":"<div><p>Configure and create sessions, then use them to create tasks that interact with URLs.<\/p><\/div>","symbols":[{"id":2919362,"role":"article","paths":["documentation\/foundation\/url_loading_system\/fetching_website_data_into_memory"],"abstract":"<div><p>Receive data directly into memory by creating a data task from a URL session.<\/p><\/div>","title":{"content":"Fetching Website Data into Memory"}},{"id":1411632,"role":"symbol","usr":"c:objc(cs)NSURLSession","name":"NSURLSession","domain":"swift","kind":"cl","availability":[{"platform":"iOS","introduced":"7.0"},{"platform":"macOS","introduced":"10.9"},{"platform":"Mac Catalyst","introduced":"13.0"},{"platform":"tvOS","introduced":"9.0"},{"platform":"watchOS","introduced":"2.0"}],"displayName":"<code class=\"display-name\"><span class=\"decorator\">class <\/span><span class=\"identifier\">URLSession<\/span><\/code>","paths":["documentation\/foundation\/urlsession"],"title":{"content":"URLSession"},"abstract":"<div><p>An object that coordinates a group of related, network data-transfer tasks.<\/p><\/div>","hasChildren":true},{"id":1410455,"role":"symbol","usr":"c:objc(cs)NSURLSessionTask","name":"NSURLSessionTask","domain":"swift","kind":"cl","availability":[{"platform":"iOS","introduced":"7.0"},{"platform":"macOS","introduced":"10.9"},{"platform":"Mac Catalyst","introduced":"13.0"},{"platform":"tvOS","introduced":"9.0"},{"platform":"watchOS","introduced":"2.0"}],"displayName":"<code class=\"display-name\"><span class=\"decorator\">class <\/span><span class=\"identifier\">URLSession<wbr\/>Task<\/span><\/code>","paths":["documentation\/foundation\/urlsessiontask"],"title":{"content":"URLSessionTask"},"abstract":"<div><p>A task, like downloading a specific resource, performed in a URL session.<\/p><\/div>","hasChildren":true}],"title":{"content":"Essentials"}}],"modules":[{"title":{"content":"Foundation"},"paths":["documentation\/foundation"],"importStatement":"<import xml:space=\"preserve\"><keyWord>import<\/keyWord> Foundation<\/import>","availability":[{"platform":"watchOS","introduced":"2.0"},{"platform":"Mac Catalyst","introduced":"13.0"},{"platform":"tvOS","introduced":"9.0"},{"platform":"iOS","introduced":"2.0"},{"platform":"macOS","introduced":"10.0"}]}],"role":"article","language":"swift","roleHeading":"Article","languages":["occ","swift"],"variants":{"occ":{"paths":["documentation\/foundation\/url_loading_system\/fetching_website_data_into_memory"]},"swift":{"paths":["documentation\/foundation\/url_loading_system\/fetching_website_data_into_memory"]}},"pid":424974,"paths":["documentation\/foundation\/url_loading_system\/fetching_website_data_into_memory"],"hierarchy":[[{"id":1613013,"role":"collection","title":{"content":"Foundation"},"paths":["documentation\/foundation"]},{"id":2877756,"role":"collectionGroup","title":{"content":"URL Loading System"},"paths":["documentation\/foundation\/url_loading_system"]}]],"legalNotices":{"copyright":"Copyright &copy; 2019 Apple Inc. All rights reserved.","termsOfUse":"https:\/\/www.apple.com\/legal\/internet-services\/terms\/site.html","privacyPolicy":"https:\/\/www.apple.com\/privacy\/privacy-policy"}}</script></body></html>